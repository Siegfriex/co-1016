!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="68c878d5-7096-4613-b8fa-8a28261059e0",e._sentryDebugIdIdentifier="sentry-dbid-68c878d5-7096-4613-b8fa-8a28261059e0")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1207],{47622:function(e,t,l){l.d(t,{$:function(){return ef}});var n,s,i=l(82173),a=l(85893),o=l(6467),r=l(9540),c=l(82662),d=l(82053),u=l(97167),h=l(26669),m=l(83281),p=l(15850),f=l(18527),x=l(76480),b=l(89604),g=l(7384),j=l(33888);let v=(0,j.$j)((e,t)=>{let{notebook:l}=e,{id:n}=t;return{data:(0,g.DY)(l.model,n).data}},e=>({dispatch:e}))(e=>{let{dispatch:t,onDismiss:l,id:n,data:s,operation:i}=e,g=(0,b.pN)(s,t,"table",!0,n),j={filter:r.Z,columns:c.Z,sort:u.Z,slice:d.Z},v=i.charAt(0).toUpperCase()+i.slice(1);return(0,a.jsxs)(o.Vq,{onDismiss:l,"aria-label":"".concat(v," menu"),children:[(0,a.jsx)(h.xB,{title:v,icon:j[i],onDismiss:l}),(0,a.jsx)("div",{className:"pa3 bt b--silver",children:"filter"===i?(0,a.jsx)(p.c,{id:n,data:s,dispatch:t,schema:g}):"columns"===i?(0,a.jsx)(m.J,{data:s,dispatch:t,id:n,schema:g}):"sort"===i?(0,a.jsx)(x.dE,{id:n,data:s,dispatch:t,schema:g}):(0,a.jsx)(f.ck,{data:s,dispatch:t,id:n})})]})});var y=l(67294),C=l(63650),k=l(68059),w=l(48537),N=l(79384),D=l(14162),S=l(77658),_=l(18701),Z=l(67374),U=l(61802),q=l(46294),T=l(34978),E=l(52332),L=l(8273),R=l(70480),V=l(68098),I=l(88084),z=l(18710);function M(e,t,l){let n={user:e,public:t.filter(e=>"public"===e.type&&e.id!==l),private:t.filter(e=>"private"===e.type&&e.id!==l)},s=function(e){let t=new Set(e.map(e=>e.id));return(e,l)=>+t.has(l.id)-+t.has(e.id)||e.title.localeCompare(l.title)}(t);return n.public.sort(s),n.private.sort(s),n}let A=e=>{let{collection:t,checked:l,onChange:n}=e;return(0,a.jsxs)("span",{className:"flex f6 fw5 dark-gray flex-auto",children:[(0,a.jsx)(w.X,{id:"collection-".concat(t.id),checked:l,onChange:e=>n(t,e.target.checked),spacing:""}),(0,a.jsx)("label",{htmlFor:"collection-".concat(t.id),title:t.title,className:"truncate",children:t.title})]})},B=e=>{let{group:t,type:l,selected:n,onChange:s,filters:i,restricted:o=!1}=e,r="public"===l?t.public:t.private,c=r.filter(e=>{var t;return t=e.title,i.every(e=>t.toLowerCase().includes(e))});return(0,a.jsxs)("div",{className:"mt1",children:[(0,a.jsxs)("div",{className:"f7 fw5 gray",children:[(0,a.jsx)("span",{className:"ttc",children:l})," collections (",i.length?"".concat(c.length," / "):"",r.length,")"]}),o?(0,a.jsx)("div",{className:"f7 gray lh-f7",children:"Only workspace owners can add public or shared notebooks to public collections."}):c.length>0&&(0,a.jsx)("div",{className:"pt1 pb3",style:{display:"grid",gridTemplateColumns:"1fr 1fr",gridGap:"10px"},children:c.map(e=>(0,a.jsx)(A,{collection:e,checked:n.some(t=>t.id===e.id),onChange:s},e.id))})]},l)},$=e=>{let{onCollectionCreated:t,owner:l,currentUser:n}=e,s="private",[i,o]=(0,y.useState)(s),[r,c]=(0,y.useState)("");async function d(e){e.preventDefault();let a=await (0,T.BL)(r,i,l);a&&(t(l,i,a),(0,q.MR)((0,q.y6)({type:"collection:manage:create",data:{trigger:"click",source:"notebookCollectionsModal"},eventVersion:1,collection:a,currentUser:n})),c(""),o(s))}return(0,a.jsxs)("form",{onSubmit:d,className:"flex items-center",autoComplete:"off",children:[(0,a.jsx)(N.Z,{name:"title",placeholder:"New collection",type:"text",className:"overflow-hidden flex-grow-1",value:r,onChange:e=>c(e.target.value)}),(0,a.jsxs)(D.P,{name:"type",onChange:e=>o(e.target.value),value:i,disabled:!r,className:"mh2",children:[(0,a.jsx)("option",{value:"private",children:"team"===l.type?"Team Private":"Private"}),(0,E.XM)(n,l)&&(0,a.jsx)("option",{value:"public",children:"Public"})]}),(0,a.jsx)(k.aX,{text:"Create",type:"submit",disabled:!r})]})},O=e=>{let{collectionListing:t,onDismiss:l,dispatch:n}=e,s=e.currentUser,{owner:i}=t,r=F(t)?t.collections:t.parent_collections,[c,d]=(0,y.useState)(r),[u,m]=(0,y.useState)(null),[p,f]=(0,y.useState)(!1),[x,b]=(0,y.useState)([]),[g,j]=(0,y.useState)(t.description),v=t.description!==g,w=c.filter(e=>!r.some(t=>t.id===e.id)),D=r.filter(e=>!c.some(t=>t.id===e.id)),q=0===w.length&&0===D.length&&!v,T=(0,E.Zs)(s,t),{data:R,mutate:I}=(0,U.h_)(T?"/collections/@".concat(i.login):null),z=!F(t)||(0,L.s9)(t)||(0,L.Gw)(t)?s.teams.find(e=>e.id!==i.id&&(0,E.pb)(e)):void 0,{data:A}=(0,U.h_)(z?"/collections/@".concat(z.login):null);function O(e,t){d(t?c.concat(e):c.filter(t=>t.id!==e.id))}(0,y.useEffect)(()=>{d(r)},[r]),(0,y.useEffect)(()=>{if((!T||R)&&(!z||A)){let e=[],l=G(t)?t.id:void 0;R&&e.push(M(i,R,l)),z&&A&&e.push(M(z,A,l)),m(e.filter(e=>e.public.length+e.private.length>0).sort((e,t)=>{let{user:l}=e,{user:n}=t;return l.id===s.id?-1:n.id===s.id?1:l.login.localeCompare(n.login)}))}},[R,A,z,T,s,i,t]);let P=c.length?c.map(e=>e.title).join(", "):"None",X=g&&g.length||0;return(0,a.jsxs)(o.Vq,{onDismiss:l,"aria-labelledby":"modal-title",children:[(0,a.jsx)(h.xB,{title:"Add to collection",icon:Z.Z,onDismiss:l}),(0,a.jsxs)(h.fe,{children:[(0,a.jsxs)("div",{className:"truncate f6 fw5 gray",children:[(0,a.jsxs)("span",{children:["Selected (",c.length,"): "]}),(0,a.jsx)("b",{title:P,className:"fw6 dark-gray",children:P})]}),(0,a.jsx)(N.Z,{name:"filter",className:"db w-100 mt2 mb3",placeholder:"Filter collections",type:"text",onChange:e=>b(e.target.value.toLowerCase().split(/\s+/).filter(e=>e))}),(0,a.jsx)("div",{className:"mv2 overflow-auto",style:{height:250},children:null===u?(0,a.jsxs)("div",{className:"flex f7 fw6 gray items-center justify-center lh-copy fade-in delay-short h-100",children:[(0,a.jsx)(_.Z,{}),(0,a.jsx)("span",{className:"ml2",children:"Loading"})]}):u.length>0?u.map(e=>(0,a.jsxs)("div",{className:"pb1 mb3",children:[(u.length>1||e.user.id!==s.id)&&(0,a.jsxs)("div",{className:"flex mb2 f6 fw5 near-black items-center",children:[(0,a.jsx)(C.qE,{user:e.user,size:16,className:"mr2"}),(0,a.jsx)("span",{children:(0,V.RX)(e.user)})]}),e.private.length?(0,a.jsx)(B,{type:"private",group:e,filters:x,selected:c,onChange:O},"".concat(e.user.id,":private")):null,e.public.length?(0,a.jsx)(B,{type:"public",group:e,filters:x,selected:c,onChange:O,restricted:F(t)&&!(0,E.M6)(s,e.user,t)},"".concat(e.user.id,":public")):null]},e.user.id)):(0,a.jsx)("div",{className:"flex f7 fw5 gray items-center justify-center lh-copy fade-in h-100",children:"You donâ€™t have any collections."})})]}),(0,a.jsxs)(h.mz,{children:[(0,E.pq)(s,i)&&(0,a.jsx)($,{owner:i,onCollectionCreated:function(e,t,l){l&&(O(l,!0),I())},currentUser:s}),F(t)&&(0,E.qG)(s,t)&&(0,a.jsxs)("div",{className:"mv3",children:[(0,a.jsx)("div",{className:"mv2 fw5 dark-gray",children:"Set notebook description (internal use only)"}),(0,a.jsx)(S.g,{name:"description",className:"db w-100",autoResize:!0,placeholder:"Enter notebook description. Currently only used for editorial purposes, e.g. our blog.",value:g||"",maxLength:300,onChange:e=>j(e.target.value)}),(0,a.jsx)("div",{className:"flex flex-column items-end mt2 gray f7 fw5",children:(0,a.jsx)("div",{children:"(".concat(X,"/").concat(300,")")})})]}),(0,a.jsxs)(k.CQ,{className:"mt2",children:[(0,a.jsx)(k.kq,{text:"Cancel",onClick:l}),(0,a.jsx)(k.KM,{disabled:q,loading:p,onClick:function(){f(!0),G(t)?n({type:"updateCollectionInCollections",addTo:w,removeFrom:D,collectionId:t.id,onDismiss:l}):(n({type:"collections",addTo:w,removeFrom:D,onDismiss:l}),g&&v&&n({type:"descriptionUpdate",description:g,onDismiss:l}))},text:"Confirm"})]})]})]})},P=(0,z.$j)(e=>{let{currentUser:t}=e;return{currentUser:t}},e=>({dispatch:e}))(e=>{let{collectionListing:t,onDismiss:l,...n}=e,{data:s,mutate:i}=(0,U.h_)("type"in t&&("notebook_reader"===t.type||"notebook_owner"===t.type)?"/document/".concat(t.id):null),{data:o,mutate:r}=(0,U.h_)("listing_type"in t&&"collection"===t.listing_type||"ordered"in t&&!("listing_type"in t)?"/collection/@".concat(t.owner.login,"/").concat(t.slug,"?").concat((0,R.P)({page:1})):null),[c,d]=(0,y.useState)();(0,y.useEffect)(()=>{F(t)||G(t)?d(t):s?((0,E.iU)(e.currentUser,s),d((0,I.D)({initialNotebook:s,initialCurrentUser:e.currentUser,initialContext:s.owner}))):o?d(o):d(void 0)},[t,d,s,o,e.currentUser]);let u=(0,y.useCallback)(()=>{i(),r(),l()},[i,r,l]);return c?(0,a.jsx)(O,{collectionListing:c,onDismiss:u,...n}):null});function F(e){return"collections"in e}function G(e){return"parent_collections"in e}var X=l(62643),Y=l(89268),K=l(11163),Q=l(25192),J=l(37999),W=l(21452),H=l(88225),ee=l(47720);let et=(0,ee.ZV)(e=>{let{notebook:t}=e;return{notebook:t}},e=>({dispatch:e}))(e=>{let{notebook:t,dispatch:l,onDismiss:n}=e,[s,i]=(0,y.useState)(""),{thumbnail:r,defaultThumbnail:c}=t,d=(0,y.useRef)(null),[u,m]=(0,y.useState)(!0),p=u&&(s||r!==t.defaultThumbnail)&&s!==r;return(0,a.jsx)(o.Vq,{onDismiss:n,"aria-labelledby":"modal-title",children:(0,a.jsxs)(J.l,{ref:d,className:"relative f6 lh-copy",onSubmit:e=>{e.preventDefault(),l({type:"setNotebookThumbnail",customThumbnail:s}),n()},children:[(0,a.jsx)(h.xB,{title:"Set Thumbnail",icon:H.Z,onDismiss:n}),(0,a.jsx)(h.fe,{children:(0,a.jsx)("div",{className:"flex flex-column",children:(0,a.jsx)(W.E,{thumbnail:r,defaultThumbnail:c,onValueChange:e=>{i(e),d.current&&m(d.current.checkValidity())}})})}),(0,a.jsx)(h.mz,{children:(0,a.jsxs)(k.CQ,{children:[(0,a.jsx)(k.kq,{text:"Cancel",onClick:n}),(0,a.jsx)(k.KM,{text:"Confirm",type:"submit",disabled:!p})]})})]})})});var el=l(94184),en=l.n(el),es=l(32934),ei=l(91132),ea=l(91529),eo=l(1094);let er=/^[0-9a-z_-]+(?:\/[0-9]+)?$/;(n=s||(s={}))[n.Empty=0]="Empty",n[n.Conflict=1]="Conflict",n[n.Invalid=2]="Invalid",n[n.TooLong=3]="TooLong",n[n.Available=4]="Available";let ec=(0,ee.ZV)(e=>{let{notebook:t}=e;return{notebook:t}},e=>({dispatch:e}))(e=>{let{notebook:t,dispatch:l,onDismiss:n}=e,{id:s,owner:i,slug:r}=t,c=(0,ea.Ui)("model"in t?t.model:t),[d,u,m]=(0,ei.G)(r||(0,eo.O)(c),150),[p,f]=(0,y.useState)(4),{data:x}=(0,U.h_)(()=>m&&s&&(4===p||1===p)?"/document/".concat(s,"/slug-exists?slug=").concat(encodeURIComponent(m.replace(/\/$/,""))):null);function b(e){l({type:"setSlug",slug:e})}(0,y.useEffect)(()=>m?m.length>255?f(3):er.exec(m)?(null==x?void 0:x.exists)?f(1):void f(4):f(2):f(0),[m,f,x]);let g=4===p,j=!g&&0!==p;return(0,a.jsx)(o.Vq,{onDismiss:n,"aria-labelledby":"modal-title","data-dialog-wide":!0,children:(0,a.jsxs)(J.l,{className:"relative f6 lh-copy",onSubmit:e=>{e.preventDefault(),b(d),n()},children:[(0,a.jsx)(h.xB,{title:"Set URL",icon:es.Z,onDismiss:n}),(0,a.jsxs)(h.fe,{children:[(0,a.jsxs)("div",{className:en()("flex items-stretch br2 ba",j?"b--dark-pink":"b--black-10 hover-b--black-30"),children:[(0,a.jsxs)("div",{className:"pa2 pr0 pr1 black-70 bg-near-white br b--black-10 br2 br--left",onClick:()=>{var e;null===(e=document.querySelector("#slug"))||void 0===e||e.focus()},children:["observablehq.com/@",i.login,"/"]}),(0,a.jsx)("input",{id:"slug",title:"slug",placeholder:d,value:d,className:"pa2 black br2 flex-auto br--right bn",onChange:e=>u(e.target.value)})]}),j?(0,a.jsx)("div",{className:"pa1 mt1 f7 fw5 dark-pink",children:1===p?"A notebook already exists at that URL.":2===p?"URL can only include lowercase alphanumeric characters, hyphens, underscores, and an optional forward slash suffix (/2).":3===p?"URL must be less than 255 characters long.":null}):null]}),(0,a.jsx)(h.mz,{children:(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)(k.sn,{text:"Reset",destructive:!0,"data-cy":"reset-slug",onClick:e=>{e.preventDefault(),b(null),n()}}),(0,a.jsxs)(k.CQ,{children:[(0,a.jsx)(k.kq,{text:"Cancel",onClick:n}),(0,a.jsx)(k.KM,{text:"Confirm",type:"submit",disabled:!g})]})]})})]})})});var ed=l(15692),eu=l(81027);let eh=(0,z.$j)(e=>{let{notebook:t}=e;return{notebook:t}},e=>({dispatch:e}))(e=>{let{notebook:t,relocate:l,showToast:n,dispatch:s,onDismiss:i}=e;return(0,a.jsx)(h.On,{title:"Move notebook to trash",icon:eu.Z,description:"Are you sure you want to move this notebook to the trash? Notebooks can be removed from the trash for 30 days before they are permanently deleted.",onCancel:i,onConfirm:()=>{i(),s({type:"trashRequested",trashed:!0,relocate:l,showToast:n})},isConfirming:t.isUpdatingTrash})});var em=l(88094);let ep=(0,j.$j)((e,t)=>{let{notebook:l}=e,{id:n}=t;return{data:(0,g.DY)(l.model,n).data}},e=>({dispatch:e}))(e=>{let{dispatch:t,onDismiss:l,id:n,data:s}=e;return(0,a.jsxs)(o.Vq,{onDismiss:l,children:[(0,a.jsx)(h.xB,{title:"Customize",onDismiss:l}),(0,a.jsxs)("div",{className:"flex flex-column pa3 bt b--silver",children:[(0,a.jsx)("button",{className:"ml-auto bg-transparent bn blue fw6 f7 pa0 pointer",onClick:()=>t({type:"setChartConfig",id:n,options:null,source:"customize"}),children:"Clear"}),(0,a.jsx)(em.X,{id:n,options:s.config.options,dispatch:t})]})]})}),ef={...i.V,setSlug:ec,share:ed.V8,trash:eh,fork:X.e1,forkWithComments:e=>{let{onConfirm:t,onDismiss:l}=e;return(0,a.jsx)(h.On,{title:"Continue with fork",icon:Y.Z,description:"Your unsaved comments will be lost if you fork. Are you sure you want to continue?",onCancel:l,onConfirm:()=>{l(),t()}})},collections:P,setNotebookThumbnail:et,tableOperation:v,transfer:X.Zd,chartCustomize:ep,pausedComment:e=>{let{onDismiss:t,latestVersionPath:l}=e,n=(0,K.useRouter)();return(0,a.jsx)(h.On,{title:"Paused notebook",icon:Q.Z,description:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("p",{children:"You are looking at the paused version of this notebook, and commenting is only supported on the latest version."}),(0,a.jsx)("p",{children:"Click to switch to the latest version and continue commenting."})]}),onCancel:t,cancelText:"Back",onConfirm:()=>{t(),n.push(l)},confirmText:"Go to latest"})}}}}]);