!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="eed0a639-f9dc-4729-96b9-ec85c417a65a",e._sentryDebugIdIdentifier="sentry-dbid-eed0a639-f9dc-4729-96b9-ec85c417a65a")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8770],{71995:function(e,t,l){l.d(t,{i:function(){return i}});var a=l(85893),n=l(94184),s=l.n(n);let i=e=>{let{className:t="",...l}=e;return(0,a.jsx)("input",{...l,type:"range",style:{height:6},className:s()("form-default-clear form-custom-slider br-pill",l.disabled?"mid-gray bg-black-10 disabled":"dark-gray bg-light-silver hover-near-black",l.disabled?"disabled not-allowed":"animate-all pointer",t)})}},58104:function(e,t,l){l.d(t,{o:function(){return b}});var a=l(85893),n=l(67294),s=l(63650),i=l(36354),r=l(46582),o=l(85129),c=l(23607),d=l(64620),u=l(61802),m=l(91132);function h(e){return{login:e,invited:!0}}function g(e){return e.split(/[,\s]/).map(e=>e.trim().toLowerCase()).filter(Boolean)}let p=e=>{let{member:t,flagExternal:l,expandVertically:n}=e;return"invited"in t?(0,a.jsxs)("div",{className:"flex truncate items-center",children:[(0,a.jsx)("div",{className:"mr2 br-100 bg-light-silver flex items-center justify-center",style:{height:24,width:24},children:(0,a.jsx)(d.Z,{height:14,className:"mid-gray"})}),(0,a.jsxs)("div",{className:"truncate",children:[t.login," ",(0,a.jsx)("span",{className:"truncate gray",children:"(Invite)"})]})]}):(0,a.jsxs)("div",{className:"flex truncate items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex truncate items-center",children:["type"in t&&"group"===t.type?(0,a.jsx)(c.Z,{size:24,className:"mr2"}):(0,a.jsx)(s.qE,{user:{...t,type:"type"in t?t.type:"individual"},size:24,className:"mr2"}),(0,a.jsx)("div",{className:"truncate",children:t.name?(0,a.jsx)(a.Fragment,{children:n?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"truncate",children:t.name}),"type"in t&&"group"===t.type?(0,a.jsx)("div",{className:"gray",children:"(Group)"}):t.name!==t.login&&t.login&&(0,a.jsxs)("div",{className:"truncate gray",children:["@",t.login]})]}):(0,a.jsxs)(a.Fragment,{children:[t.name,"\xa0","type"in t&&"group"===t.type?(0,a.jsx)("span",{className:"gray",children:"(Group)"}):t.name!==t.login&&t.login&&(0,a.jsxs)("span",{className:"truncate gray",children:["(@",t.login,")"]})]})}):t.login}),"team_role"in t&&("guest_viewer"===t.team_role||"guest_member"===t.team_role)&&(0,a.jsx)("span",{className:"ml2 ph1 ba br2 fw5",children:"Guest"})]}),l&&"is_teammate"in t&&!t.is_teammate&&(0,a.jsx)("div",{className:"gray f7 ml2",children:"External"})]})},b=e=>{let{universe:t,initialSuggestions:l,excluded:s,onSelectUser:c,disabled:d,onEnterDown:b,placeholder:f,value:v,allowEmail:x=!1,emailLimit:j=1,teamId:w,type:y,expandVertically:N,id:k,...C}=e,[_,L,S]=(0,m.G)("");(0,n.useEffect)(()=>{L("")},[v,L]);let{data:R,isLoading:M}=(0,u.h_)(()=>{let e=S.trim();return!t&&e.length>=2&&e.length<=40?"/users-match?".concat(new URLSearchParams({input:e,type:y,...w?{teamId:w}:{}})):null}),[Z,E]=(0,n.useState)(void 0),[U,I]=(0,n.useState)(!1),[D,F]=(0,n.useState)(!1),[V,A]=(0,n.useState)(!1);(0,n.useEffect)(()=>{if(!_.length){E(l||void 0),I(!1);return}let e=[];if(x){let t=g(S),l=!1;t.forEach(e=>{(0,o.J)(e)||(l=!0,(0,o.q)(e)||t.length>1?F(!0):F(!1))}),!l&&t.length<=j?(t.length>1?e.push(h(S.trim())):1===t.length&&e.push(h(t[0])),I(!1),F(!1),A(!1)):t.length>j&&A(!0)}if(t){let l=_.toLocaleLowerCase(),a="@"===_.at(0)&&_.length>1;e.push(...t.map(e=>({...e,is_teammate:!0})).filter(e=>!(null==s?void 0:s.some(t=>t.id===e.id))&&(e.name&&e.name.toLowerCase().indexOf(l)>-1||"".concat(a?"@":"").concat(e.login).toLowerCase().indexOf(l)>-1)).sort((e,t)=>(e.name||e.login).localeCompare(t.name||t.login))),E(e)}else R&&!M&&e.push(...R.filter(e=>!(null==s?void 0:s.some(t=>t.id===e.id)))),E(e)},[R,c,t,s,_,S,x,j,M,l]);let[P,T]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{if(P&&Z&&R&&Z.length>0){let e=Z.find(e=>e.login===_);e?(c(e),I(!1)):x?I(!0):L(""),T(!1)}else P&&Z&&R&&0===R.length&&(T(!1),x?I(!0):L(""))},[Z,P,_,c,L,R,x,t]),(0,a.jsxs)(i.hQ,{openOnFocus:void 0!==Z,onSelect:e=>{Z&&(L(""),c(Z[+e]),I(!1))},...C,children:[v?(0,a.jsxs)("div",{className:"h2 ph2 pv1 br2 form-custom-input flex items-center justify-between w-100",children:[(0,a.jsx)(p,{member:v,flagExternal:!!w,expandVertically:!1}),(0,a.jsx)(r.Z,{className:"gray pointer",onClick:()=>c(null)}),(0,a.jsx)(i.gA,{className:"dn"})]}):(0,a.jsx)(i.gA,{id:k,className:"w-100 border-box form-default-clear","data-cy":"user-select",placeholder:f,disabled:d,autocomplete:!1,value:_,onChange:e=>L(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(T(!0),b&&(b(_),L("")))},onBlur:()=>{if(x){let e=g(S);!(0===e.length||e.some(e=>!(0,o.J)(e)))&&e.length<=j&&c(h(S.trim()))}},style:U&&x?{borderColor:"var( --dark-pink )",borderStyle:"solid",borderWidth:"1px",boxShadow:"none"}:{}}),Z&&(0,a.jsxs)(i.SF,{children:[Z.length>0?(0,a.jsx)(i.Gk,{className:"overflow-auto",style:{maxHeight:"20rem"},children:Z.map((e,t)=>(0,a.jsx)(i.O2,{"data-testid":"user-select-option",className:"pa2",value:String(t),onMouseDown:e=>e.preventDefault(),children:(0,a.jsx)(p,{member:e,flagExternal:!!w,expandVertically:null!=N&&N})},e.login))}):(0,a.jsx)("p",{className:"ma2 pa1 f6 fw5 mid-gray",children:_&&_.length>=2?(0,a.jsx)(a.Fragment,{children:"team"===y?"No workspaces found":V?"You can only invite ".concat(j," users at a time"):D?"Incomplete email address":"No users found"}):(0,a.jsx)(a.Fragment,{children:"Continue typing to search"})}),l&&l.length>0&&l===Z&&(0,a.jsx)("p",{className:"ma2 pa1 f6 fw5 mid-gray",children:"... or type to search"})]})]})}},23607:function(e,t,l){var a=l(85893);t.Z=e=>{let{size:t=28,...l}=e;return(0,a.jsx)("svg",{width:t,height:t,viewBox:"0 0 28 28",stroke:"none",xmlns:"http://www.w3.org/2000/svg",style:{backgroundColor:"var(--light-gray)",borderRadius:"var(--border-radius-2)"},...l,children:(0,a.jsx)("path",{d:"M14.1436 19.2461C16.7754 19.2461 18.457 17.6123 18.457 15.0625V13.832H14.3623V15.1787H16.7275L16.7207 15.3838C16.7002 16.7852 15.6748 17.7217 14.1709 17.7217C12.4141 17.7217 11.3066 16.3203 11.3066 14.0576V14.0439C11.3066 11.8154 12.3936 10.4141 14.1162 10.4141C15.3809 10.4141 16.2832 11.043 16.6045 12.123L16.625 12.1914H18.375L18.3682 12.123C18.0332 10.1953 16.3926 8.88965 14.1162 8.88965C11.3066 8.88965 9.50879 10.9062 9.50879 14.0576V14.0713C9.50879 17.2568 11.2861 19.2461 14.1436 19.2461Z",fill:"#1C1C1C"})})}},21400:function(e,t,l){l.d(t,{Z:function(){return r}});var a=l(85893),n=l(94184),s=l.n(n),i=e=>(0,a.jsx)("svg",{width:"8",height:"16",viewBox:"0 0 8 16",fill:"none",...e,children:(0,a.jsx)("path",{d:"M2.98713 12.6H5.00005V6H2.98713V12.6ZM4 5.16211C4.60352 5.16211 5.10156 4.6875 5.10156 4.08398C5.10156 3.48047 4.60352 3 4 3C3.39648 3 2.89844 3.48047 2.89844 4.08398C2.89844 4.6875 3.39648 5.16211 4 5.16211Z",fill:"currentColor"})}),r=e=>{let{className:t,dark:l=!1,...n}=e;return(0,a.jsx)(i,{className:s()("br-pill",l?"white bg-light-blue":"light-blue bg-observable-faint-blue",t),width:"18",height:"18",...n})}},64620:function(e,t,l){var a=l(85893);t.Z=e=>(0,a.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",...e,children:[(0,a.jsx)("rect",{x:"2",y:"3",width:"12",height:"10",rx:"0.5",stroke:"currentColor",strokeWidth:"1.5"}),(0,a.jsx)("path",{d:"M9.74104 7.4806L14.541 12.4806L13.459 13.5194L8.65896 8.5194L9.74104 7.4806ZM1.45896 12.4806L6.25896 7.4806L7.34104 8.5194L2.54104 13.5194L1.45896 12.4806Z",fill:"currentColor"}),(0,a.jsx)("path",{d:"M8 9L7.46967 9.53033C7.76256 9.82322 8.23744 9.82322 8.53033 9.53033L8 9ZM1.46967 3.53033L7.46967 9.53033L8.53033 8.46967L2.53033 2.46967L1.46967 3.53033ZM8.53033 9.53033L14.5303 3.53033L13.4697 2.46967L7.46967 8.46967L8.53033 9.53033Z",fill:"currentColor"})]})},95399:function(e,t,l){var a=l(85893);t.Z=e=>(0,a.jsxs)("svg",{width:"17",height:"16",viewBox:"0 0 17 16",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinejoin:"round",...e,children:[(0,a.jsx)("path",{d:"M3 10C2.46373 10 1 9.57867 1 8C1 6.42133 2 5.5 3.5 5.5C3.5 3 5.5 1 8 1C11 1 12.5 3.5 12.5 4C15.5 4 16.2061 10 13 10"}),(0,a.jsx)("path",{d:"M11 10L8 7L5 10"}),(0,a.jsx)("path",{d:"M7.99805 14.3882L7.99805 7.38818"})]})},79236:function(e,t,l){l.d(t,{v:function(){return j}});var a,n,s=l(85893),i=l(94184),r=l.n(i),o=l(67294),c=l(68059),d=l(42198),u=l(61802),m=l(91132),h=l(15784),g=l(1094);let p=/^[0-9a-z_-]+(?:\/[0-9]+)?$/,b=/^[0-9a-z-]+$/;function f(e,t){return 1===e?"A notebook or data app already exists at that URL.":2===e?t?"URL can only include lowercase alphanumeric characters and hyphens.":"URL can only include lowercase alphanumeric characters, hyphens, underscores, and an optional forward slash suffix (/2).":3===e?"URL must be less than 255 characters long.":null}(a=n||(n={}))[a.Empty=0]="Empty",a[a.Conflict=1]="Conflict",a[a.Invalid=2]="Invalid",a[a.TooLong=3]="TooLong",a[a.Available=4]="Available";let v=new URL("https://observablehq.com"),x=new URL("https://".concat("observablehq.cloud")||0),j=e=>{let{slug:t,title:l,owner:a,notebookId:n,isPublic:i,onValueChange:j,secret:w,className:y="",disabled:N,forProject:k=!1,disableCopy:C,..._}=e,[L,S,R]=(0,m.G)("",250),[M,Z]=(0,o.useState)(4),[E,U]=(0,o.useState)(k),[I,D]=(0,o.useState)(""),[F,V]=(0,o.useState)(),{data:A}=(0,u.h_)(()=>!N&&L&&R===L&&(4===M||1===M)?"/document/".concat(n,"/slug-exists?slug=").concat(encodeURIComponent(R.replace(/\/$/,""))):null);(0,o.useEffect)(()=>{F&&clearTimeout(F)},[]),(0,o.useEffect)(()=>{U(!!t)},[i,t,S]),(0,o.useEffect)(()=>{E?(D("@".concat(a.login,"/")),t?S(t):l?S((0,g.O)(l)):S("")):(i?D((0,h.UW)({id:n,owner:a,slug:(0,g.O)(l)}).substring(1)):D("d/".concat(n)),S(""))},[t,S,E,l,i]),(0,o.useEffect)(()=>{let e=4;L?L.length>255?e=3:(k?b:p).exec(L)?(null==A?void 0:A.exists)&&(e=1):e=2:e=0,Z(e),O(f(e,k)),P.current&&P.current.setCustomValidity(E&&4!==e?"Please enter a Url":""),j(E?L:null)},[L,Z,A,j,E,k]);let P=(0,o.useRef)(null),T=4!==M&&0!==M,[q,O]=(0,o.useState)(f(M,k));return(0,s.jsxs)(s.Fragment,{children:[!k&&(0,s.jsxs)("div",{className:"flex flex-column",children:[(0,s.jsx)(d.E,{disabled:N,name:"slugMode",label:"Automatic",checked:!E,onChange:()=>U(!1),value:"automatic"}),(0,s.jsx)(d.E,{disabled:N,name:"slugMode",label:"Custom",checked:E,onChange:()=>U(!0),value:"custom"})]}),(0,s.jsxs)("div",{className:"flex lh-default",children:[(0,s.jsxs)("div",{className:r()("ba br2 pa0 flex items-stretch f6 fw4 flex-grow-1 min-w-0",T?"b--dark-pink":"b--black-10 hover-b--black-30",y),children:[(0,s.jsx)("div",{className:r()("bg-near-white b--black-10 br2 mid-gray ma0 pa2 truncate",E?"br--left br":"flex-grow-1"),children:k?"".concat(a.login,".").concat(x.host,"/"):"".concat(v.host,"/").concat(I)}),E&&(0,s.jsxs)("div",{className:"relative flex-grow-1",children:[(0,s.jsx)("input",{type:"text",name:"custom-slug",onInvalid:e=>e.preventDefault(),ref:P,className:"ba0 br2 br--right pa2 bn near-black w-100",placeholder:i?(0,g.O)(l):"",disabled:N||!E,value:L,onInput:e=>S(e.target.value),..._}),w&&(0,s.jsxs)("div",{className:"absolute absolute--fill pen flex",children:[(0,s.jsx)("div",{className:"pv2 pl2 flex-shrink-0 o-0 pre overflow-hidden",children:L}),(0,s.jsx)("div",{className:"moon-gray flex-grow-1 truncate pv2",children:"?secret=".concat(w)})]})]})]}),(0,s.jsx)(c.kq,{className:r()("ml2",k&&"tw-bg-surface-primary"),"data-cy":"copy",onClick:function(){let e=k?new URL("".concat(L).concat(w?"?secret=".concat(w):""),"https://".concat(a.login,".").concat(x.host)):new URL(I+L,v);navigator.clipboard.writeText(e.href),O("Copied URL to clipboard"),V(setTimeout(()=>{O(q)},2e3))},disabled:C,text:"Copy"})]}),q&&(0,s.jsx)("div",{className:"dark-pink f7 fw4",children:q})]})}},21452:function(e,t,l){l.d(t,{E:function(){return v}});var a=l(85893),n=l(94184),s=l.n(n),i=l(67294),r=l(27011),o=l.n(r),c=l(21582),d=l(68059),u=l(42198),m=l(71995),h=l(95399),g=l(32485),p=l(15784);let b=["gif","jpeg","jpg","png"],f=b.map(e=>"image/".concat(e)),v=e=>{let{disabled:t,thumbnail:l,defaultThumbnail:n,onValueChange:r,className:v,...x}=e,[j,w]=(0,i.useState)(!1),[y,N]=(0,i.useState)(),[k,C]=(0,i.useState)();(0,i.useEffect)(()=>{l&&n!==l&&(N(l),w(!0),C(""))},[l,n]);let[_,L]=(0,i.useState)(null),S=(0,i.useRef)(null),[R,M]=(0,i.useState)(1),[Z,E]=(0,i.useState)(),U=(0,i.useRef)(null),I=(0,i.useRef)(null);(0,i.useEffect)(()=>{I.current&&I.current.focus()},[]),(0,i.useEffect)(()=>{j||L(""),S.current&&S.current.setCustomValidity(j&&(_||!y)?"Please upload an image":""),r(j&&y?y:"")},[r,j,y,_]);let D=(0,i.useCallback)(e=>{t||P(e)},[t]),{getRootProps:F,isDragActive:V,isDragAccept:A}=(0,c.uI)({onDrop:D,accept:{"image/*":b.map(e=>".".concat(e))},maxFiles:1,noClick:!0});function P(e){try{let l=function(e){for(let t of e)if(t.type&&t.type.startsWith("image/"))return t}(e);if(l instanceof DataTransferItem){var t;l=null!==(t=l.getAsFile())&&void 0!==t?t:void 0}if(l){let e=URL.createObjectURL(l);C(e),w(!0),M(1),L("")}else e.length&&L("Sorry, that image format is not supported.")}catch(e){console.error(e)}}let T=(0,i.useRef)();function q(){if(L(""),U.current){T.current&&T.current();let e=setTimeout(()=>{if(T.current=void 0,U.current&&U.current.getCroppingRect()){let e=U.current.getImage(),t=document.createElement("canvas");t.width=640,t.height=400;let l=t.getContext("2d");l.fillStyle="#fff",l.fillRect(0,0,640,400),l.drawImage(e,0,0,e.width,e.height,0,0,640,400),N(t.toDataURL("image/jpeg",.7))}},150);T.current=()=>clearTimeout(e)}}return(0,a.jsxs)("div",{className:s()("flex items-top flex-wrap flex-nowrap-l",v),onClick:()=>{I.current&&I.current.focus()},children:[(0,a.jsxs)("div",{className:"mr2",children:[(0,a.jsx)(u.E,{disabled:t,name:"thumbnail",label:"Automatic",checked:!j,onChange:e=>w("on"!==e.target.value)}),(0,a.jsx)(u.E,{className:"f6 fw6 near-black mb3",disabled:t,name:"thumbnail",label:"Custom",description:"Use a .png or .jpg that is at least 640x400 pixels",checked:j,onChange:e=>w("on"===e.target.value)}),(0,a.jsx)("input",{disabled:t,hidden:!0,ref:S,onInvalid:e=>e.preventDefault(),onInput:()=>{},value:j&&y?y:"",...x}),(0,a.jsx)("input",{className:"ma0 pa0 bw0 absolute",disabled:t,type:"text",style:{opacity:0,width:0,height:0},ref:I,onPaste:e=>P(e.clipboardData.files)}),(0,a.jsxs)("div",{className:"flex items-top mb2",children:[(0,a.jsx)("div",{className:"db-l dn ml2 mr3"}),(0,a.jsx)(d.aX,{disabled:t,text:"Upload file",icon:h.Z,onClick:()=>(0,g.Z)({accept:f.join()}).then(e=>{P(e)})})]})]}),(0,a.jsxs)("div",{children:[!(j&&k)&&(0,a.jsx)("div",{...F(),className:s()("flex flex-column ba",_&&!V?"b--dark-pink":A&&!t?"b--dashed b-dark-gray":"b--moon-gray"),style:{width:250,height:156.25,backgroundImage:j&&y?"url(".concat((0,p.Nl)(y),")"):!j&&n?"url(".concat((0,p.Nl)(n),")"):"var(--checkerboard)",backgroundSize:j&&y||!j&&n?"cover":"8%"}}),j&&k&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{...F(),className:s()("flex flex-column ba",_?"b--dark-pink":A&&!t?"b--dashed b--dark-gray":"b--white"),children:(0,a.jsx)(o(),{image:k,ref:U,width:198,height:123.75,scale:R,position:Z,borderRadius:0,onPositionChange:e=>E(e),onImageReady:q,onImageChange:q,onLoadFailure:function(){L("Unable to read that image."),C("")}})}),(0,a.jsxs)("div",{className:"flex items-center mid-gray mt2",children:[(0,a.jsx)("label",{className:"mr2 f6",htmlFor:"scale-range",children:"Zoom"}),(0,a.jsx)(m.i,{className:"flex-grow-1",name:"scale-range",onChange:e=>M(e.target.valueAsNumber),value:R,step:"any",min:1,max:2})]})]}),_?(0,a.jsx)("div",{className:"dark-pink f7 fw4 mb2 mt1",children:_}):null]})]})}},15692:function(e,t,l){l.d(t,{V8:function(){return Y},lf:function(){return H}});var a=l(85893),n=l(6467),s=l(94184),i=l.n(s),r=l(67294),o=l(63650),c=l(68059),d=l(14162),u=l(58104),m=l(80537),h=l(6179),g=l(26669),p=l(56162),b=l(62122),f=l(79384),v=l(11037),x=l(45916),j=l(21596),w=l(23607),y=l(21400),N=l(64620),k=l(36779),C=l(79236),_=l(21452),L=l(77658);let S=e=>{let{description:t="",onValueChange:l}=e,n=(0,r.useRef)(null),[s,i]=(0,r.useState)(t);return(0,r.useEffect)(()=>{l(s)},[l,s]),(0,a.jsxs)("div",{className:"mv3",children:[(0,a.jsx)("div",{className:"mv2 fw5 dark-gray",children:"Set notebook description (internal use only)"}),(0,a.jsx)(L.g,{ref:n,name:"description",className:"db w-100",autoResize:!0,placeholder:"Enter notebook description. Currently only used for editorial purposes, e.g. our blog.",value:s,maxLength:300,onChange:e=>i(e.target.value)}),(0,a.jsx)("div",{className:"flex flex-column items-end mt2 gray f7 fw5",children:(0,a.jsx)("div",{children:"(".concat(s.length,"/").concat(300,")")})})]})};var R=l(9427),M=l(58316),Z=l(61802),E=l(91529),U=l(15784),I=l(52332),D=l(8273),F=l(22638),V=l(68098),A=l(83191),P=l(47720);let T={avatar_url:null,bio:"",home_url:"",id:"0",login:"",name:"",pending:!0,role:null,status:"member",team_role:null,tier:"pro",type:"team"};function q(e){return{avatar_url:e.avatar_url,bio:e.bio,home_url:e.home_url,id:e.id,login:e.login||e.id,name:e.name,pending:!0,role:null,status:"member",team_role:e.role,tier:e.tier,type:"individual"}}function O(e,t){return{avatar_url:e.avatar_url,bio:e.bio,home_url:e.home_url,id:e.id,login:e.login||e.id,name:e.name,pending:!0,role:t,status:"status"in e?e.status:"member",team_role:"team_role"in e?e.team_role:null,tier:e.tier,type:"type"in e?e.type:"individual"}}function z(e,t){return t.find(t=>t.id===e.id)||O(e,null)}let B=e=>{let{member:t,roles:l,changeMemberRole:n}=e;return(0,a.jsx)(d.P,{name:"role_change","data-scope":"user:".concat(t.login),value:t.role||"",onChange:e=>{n(t,e.target.value?e.target.value:null)},disabled:l.length<=1,onMouseDown:e=>{e.stopPropagation()},onMouseUp:e=>{e.stopPropagation()},children:l.map(e=>(0,a.jsx)("option",{value:e||"",children:function(e,t){switch(e){case"editor":return"team"===t.type||"group"===t.type?"Can view or edit":"Can edit";case"viewer":return"Can view";default:return"team"===t.type?"No access":"invited"!==t.status||t.pending?"Remove":"Rescind invitation"}}(e,t)},e))})},H="mr2 flex justify-center items-center dark-green bg-observable-washed-green br2",W=e=>{let{member:t,pendingMembers:l,memberCount:n,changeMemberRole:s,notebook:c,canAssignRoles:d,disclaimer:u,currentUser:m,liveSelected:g}=e,p=(0,r.useMemo)(()=>{let e=[];return d?(["owner","member","guest_member",null].includes(t.team_role)&&e.push("editor"),function(){if("editor"!==t.role)return!1;let e=l.filter(e=>"editor"===e.role);if(1===e.length&&t.id===e[0].id)return!0;let a=(0,V.jR)(c.owner.id,m);if(!a||a.setting_publish_transfer||(0,D.ws)(c))return!1;let n=e.filter(e=>"owner"===e.team_role||e.id===c.owner.id);return!(n.length>1)&&0!==n.length&&t.id===n[0].id}()||(e.push("viewer"),g&&null!==t.role||e.push(null))):(m.id===t.id&&e.push(null),e.push(t.role)),e},[d,c,m,l,t,g]),b=t.icon,f=void 0!==n&&n>0;return(0,a.jsxs)("div",{className:"flex g3 f6 fw5 mb2 justify-between items-center",children:[(0,a.jsxs)("div",{className:"flex items-center min-w-0 g1",children:["member"===t.status&&b?(0,a.jsx)("div",{className:"mr2 flex justify-center items-center dark-green bg-observable-washed-green br-100",style:{width:28,height:28},children:(0,a.jsx)(b,{})}):"group"===t.type?(0,a.jsx)(w.Z,{className:"mr2"}):"team"===t.type&&t.id===c.owner.id?(0,a.jsx)("div",{className:"".concat(H," bg-observable-light-purple"),style:{width:28,height:28},children:(0,a.jsx)(h.Z,{className:"observable-purple bg-observable-light-purple"})}):(0,a.jsx)(o.qE,{user:t,id:t.id,size:28,className:"mr2"}),"invited"===t.status&&(0,a.jsx)("div",{className:"mr2 br-100 bg-light-silver flex items-center justify-center",style:{height:28,width:28},children:(0,a.jsx)(N.Z,{height:16,className:"mid-gray"})}),(0,a.jsxs)("div",{className:i()("truncate",f?"flex flex-column row-gap-0":""),children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"near-black",children:"team"===t.type&&t.id===c.owner.id?"Team":t.name||t.login}),t.id===m.id?(0,a.jsx)("span",{className:"ml1 gray",children:"(You)"}):"invited"===t.status&&t.pending?(0,a.jsx)("span",{className:"truncate gray",children:"\xa0(Invite)"}):"invited"===t.status?(0,a.jsx)("span",{className:"truncate gray",children:"\xa0(Invited)"}):"group"===t.type?(0,a.jsx)("span",{className:"truncate gray",children:"\xa0(Group)"}):t.name&&t.name!==t.login&&"team"!==t.type&&(0,a.jsxs)("span",{className:"truncate gray",children:["\xa0(@",t.login,")"]})]}),f&&(0,a.jsx)("div",{className:"gray",children:"".concat(n," member").concat(1!==n?"s":"")})]}),("guest_viewer"===t.team_role||"guest_member"===t.team_role)&&(0,a.jsx)(R.i,{className:"dark-gray"})]}),(0,a.jsxs)("div",{className:"flex",children:[u&&(0,a.jsx)("div",{className:"flex items-center mr1",children:(0,a.jsx)(M.W,{className:i()(A.Xv,"pa3 pre-line mw5"),label:u.message,children:(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)(u.icon,{})})})}),t.id===c.owner.id&&"individual"===c.owner.type?(0,a.jsx)("div",{className:"gray pv2 bt bb b--transparent lh-default",children:"Owner"}):(0,a.jsx)(B,{member:t,changeMemberRole:s,roles:p})]})]})},G=e=>{let{notebook:t,changePublishLevel:l,publishLevel:n}=e;return(0,a.jsxs)("div",{className:"flex f6 fw5 mb2 justify-between items-center",children:[(0,a.jsxs)("div",{className:"flex items-center min-w-0 g1",children:[(0,a.jsx)("div",{className:H,style:{width:28,height:28},children:(0,a.jsx)(j.Z,{})}),(0,a.jsx)("div",{children:(0,a.jsx)("span",{className:"near-black",children:"Public"})})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[("public"===n||"shared"===n)&&(0,a.jsx)("div",{className:"flex items-center mr1",children:(0,a.jsx)(M.W,{className:i()(A.Xv,"pa3 pre-line mw5"),label:(0,a.jsxs)(a.Fragment,{children:["A published or unlisted version of this notebook is visible to the public, but new edits are not.",(0,a.jsx)("p",{children:"Change this setting to make this notebook fully public or private."})]}),children:(0,a.jsx)("div",{children:(0,a.jsx)(x.Z,{className:"w1 h1 mh2 gold bg-lightest-yellow flex-no-shrink br-pill"})})})}),(0,a.jsxs)(d.P,{name:"role_change","data-scope":"public",value:n,onChange:e=>l(e.target.value),disabled:!(0,I.zB)(t),onMouseDown:e=>{e.stopPropagation()},onMouseUp:e=>{e.stopPropagation()},children:[(0,a.jsx)("option",{value:"live",children:"Can view"}),((0,D.nv)(t)||(0,I._l)(t))&&(0,a.jsx)("option",{value:"live_unlisted",children:"Can view (unlisted)"}),(0,D.cg)(t)&&(0,a.jsx)("option",{value:"shared",children:"Can view unlisted published version"}),(0,D.s9)(t)&&(0,a.jsx)("option",{value:"public",children:"Can view published version"}),((0,D.ws)(t)||(0,I._l)(t))&&(0,a.jsx)("option",{value:"private",children:"No access"})]})]})]})},Y=(0,P.ZV)(e=>{let{notebook:t,currentUser:l}=e;return{notebook:t,currentUser:l}},e=>({dispatch:e}))(e=>{let{notebook:t,currentUser:l}=e,n="team"===t.owner.type,{data:s}=(0,Z.h_)("/document/".concat(t.id,"/members")),i=(0,r.useMemo)(()=>null==s?void 0:s.map(e=>({...e,bio:"",home_url:"",pending:!1})),[s]),{data:o}=(0,Z.h_)(n?"/team/".concat(t.owner.id,"/members"):null),c=(0,r.useMemo)(()=>null==o?void 0:o.map(q),[o]),{data:d}=(0,Z.h_)(n?"/team/".concat(t.owner.id,"/groups"):null),{data:u}=(0,Z.h_)("/document/".concat(t.id,"/importers?page=1"));return i&&c&&d&&u?(0,a.jsx)(X,{...e,currentUser:l,documentMembers:i,teamMembers:c,groups:d,importers:u}):null}),X=e=>{var t;let{notebook:l,onDismiss:s,dispatch:i,documentMembers:o,teamMembers:h,groups:x,importers:w}=e,N=e.currentUser,L="team"===l.owner.type&&N.teams.some(e=>e.id===l.owner.id),[R,M]=(0,r.useState)("editor"),[Z,A]=(0,r.useState)(null),[P,q]=(0,r.useState)(null),[B,H]=(0,r.useState)(null),[Y,X]=(0,r.useState)(""),{defaultThumbnail:K,publishLevel:Q,thumbnail:$}=l,[J,ee]=(0,r.useState)(!0),et=J&&(Y||$!==l.defaultThumbnail)&&Y!==$&&(0,I.fW)(l),el=J&&P!==l.slug&&(0,I.mO)(l),ea=J&&null!==B&&"description"in l&&B!==l.description,en=(0,r.useRef)(null),es=Z&&("invited"in Z?{avatar_url:null,bio:"",home_url:"",id:Z.login,name:"",login:Z.login,pending:!0,role:null,status:"invited",team_role:null,tier:"pro",type:"individual"}:O(Z,null)),[ei,er]=(0,r.useState)([]),[eo,ec]=(0,r.useState)([]),[ed,eu]=(0,r.useState)(""),em=(0,E.Ui)("title"in l?l:l.model),[eh,eg]=(0,r.useState)(Q),ep="live"===eh||"live_unlisted"===eh;(0,r.useEffect)(()=>{er(o),ec(o)},[o]);let eb=ei.filter(e=>"individual"===e.type&&!eo.find(t=>t.id===e.id)).length,ef=z(N,eo),ev=z(N,ei),ex=L?z(l.owner,eo):T,ej=L?z(l.owner,ei):T,ew=L?eo.filter(e=>"group"===e.type&&x.find(t=>t.id===e.id&&t.ids.includes(N.id))):null,ey=L?ei.filter(e=>"group"===e.type&&x.find(t=>t.id===e.id&&t.ids.includes(N.id))):null,eN=z(l.owner,eo),ek=ei.filter(e=>e.id!==l.owner.id&&e.id!==N.id),eC="model"in l&&(0,F.Z)(l.model.nodes),e_=(0,D.uT)(N,l.owner)&&eC&&eC.fileAttachments.size>0,eL=eC&&(ep||!L)&&(eC.databaseClients.size>0||eC.secrets.size>0||eC.notificationClients.size>0||e_),eS=eo.length===ei.length&&eo.every(e=>ei.some(t=>e.id===t.id&&t.role===e.role));function eR(e){return"team"!==e.type||ei.some(e=>("individual"===e.type||"group"===e.type)&&"editor"===e.role)?"editor"===ej.role&&"viewer"===e.role&&"viewer"!==e.team_role&&"guest_viewer"!==e.team_role&&"guest_member"!==e.team_role?{icon:m.Z,message:"individual"===e.type?"This user can still edit the notebook because they’re an editor in the workspace it’s shared with.":"Users in this group will still be able to edit the notebook if they’re an editor in the workspace it’s shared with."}:"editor"===e.role&&("viewer"===e.team_role||"guest_viewer"===e.team_role)?{icon:m.Z,message:"This user will be unable to edit the notebook because they are no longer an editor in the workspace."}:void 0:{icon:y.Z,message:"Notebooks must have at least one editor."}}function eM(e,t){let l=ei.findIndex(t=>t.id===e.id),a=O(e,t);if(l>-1){if(null!==t){let e=Array.from(ei);e[l]=a,er(e)}else er(ei.filter(t=>t.id!==e.id))}else er([...ei,a])}let eZ=["guest_member","guest_viewer"].includes(null!==(t=ef.team_role)&&void 0!==t?t:""),eE="editor"===ef.role||"editor"===ex.role&&!eZ||ew&&ew.length>0&&ew.some(e=>"editor"===e.role),eU="editor"===ev.role||"editor"===ej.role&&!eZ||ey&&ey.length>0&&ey.some(e=>"editor"===e.role),eI="viewer"===ev.role||"viewer"===ej.role&&!eZ||ey&&ey.length>0&&ey.some(e=>"viewer"===e.role),eD=eE&&!eU&&ei!==eo,eF=!eU&&!eI&&ei!==eo,eV=et||el||ea||!eS||eh!==Q;function eA(e){e.preventDefault(),et&&i({type:"setNotebookThumbnail",customThumbnail:Y}),el&&i({type:"setSlug",slug:P||null}),ea&&i({type:"descriptionUpdate",description:B,onDismiss:s}),eS||i({type:"share",currentMembers:eo,newMembers:ei,newRoles:eF?[]:eD?["viewer"]:l.roles.filter(e=>!(ep&&"readonly"===e)),message:ed}),eh!==Q&&(ep?i({type:"publishLiveRequested",unlisted:"live_unlisted"===eh}):i({type:"unpublishRequested"})),s()}let eP=(0,I.sZ)(N,l),eT=eP&&(0,I.VH)(l.owner,h),eq=!L&&ei.length>=5;return(0,a.jsx)(n.Vq,{onDismiss:s,"aria-labelledby":"modal-title",children:(0,a.jsxs)("form",{noValidate:!0,name:"publishForm",ref:en,onSubmit:eA,children:[(0,a.jsx)(g.xB,{title:"Share",icon:j.Z,onDismiss:s}),!!w.total&&"private"!==l.publishLevel&&"private"===eh&&(0,a.jsxs)("aside",{className:"pa3 flex bg-observable-dark-gold white",children:[(0,a.jsx)("div",{children:(0,a.jsx)(v.Z,{className:"mr2",width:16})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"mb2",children:[(0,a.jsx)(k.Z,{href:"".concat((0,U.Bi)(l),"/importers"),className:"hover-dark-blue",id:"importers-link",style:{textDecoration:"underline"},children:"".concat((0,D.YY)(w.total,"notebook"))})," ","".concat((0,D.xC)(w.total,"imports","import")," cells from this notebook.")]}),(0,a.jsx)("span",{className:"fw6",children:"Making it private will cause ".concat((0,D.xC)(w.total,"this","these")," ").concat((0,D.xC)(w.total,"import")," to fail.")})," ",(0,a.jsxs)("span",{children:["If you want to work on substantial edits to this notebook, consider"," ",(0,a.jsx)(k.Z,{href:"/@observablehq/fork-suggest-merge?collection=@observablehq/editing-publishing-collaborating",className:"hover-dark-blue",style:{textDecoration:"underline"},children:"forking and merging"})," ","or using"," ",(0,a.jsx)(k.Z,{href:"/@observablehq/pause-live-edits-in-public-notebooks?collection=@observablehq/editing-publishing-collaborating",className:"hover-dark-blue",style:{textDecoration:"underline"},children:"pause live edits"})," ","from the notebook menu."]})]})]}),(0,a.jsxs)(g.fe,{children:[(0,I.mO)(l)&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(g.pe,{className:"mt0",title:"Notebook URL"}),(0,a.jsx)(C.v,{owner:l.owner,notebookId:l.id,title:em,slug:l.slug,isPublic:"public"===l.publishLevel&&!ep,onValueChange:e=>{q(e),en.current&&ee(en.current.checkValidity())}})]}),(0,a.jsx)("div",{className:"mb3",children:(0,a.jsx)(g.pe,{className:(0,I.mO)(l)?"mt4":"mt0",title:"Access"})}),(0,a.jsxs)("div",{className:"mb2",children:[(0,a.jsx)(G,{publishLevel:eh,notebook:l,changePublishLevel:e=>{eg(e),("live"===e||"live_unlisted"===e)&&L&&null===ej.role&&eM(ej,"viewer")}}),L&&(0,a.jsx)(W,{member:ej,pendingMembers:ei,liveSelected:ep,notebook:l,canAssignRoles:eP,memberCount:h.filter(e=>"guest_viewer"!==e.team_role&&"guest_member"!==e.team_role).length,changeMemberRole:eM,currentUser:N,disclaimer:eR(ej)}),!L&&(0,a.jsx)(W,{member:eN,pendingMembers:ei,notebook:l,canAssignRoles:eP,changeMemberRole:eM,currentUser:N}),(0,a.jsx)("div",{className:"w-100 overflow-auto",style:{maxHeight:250},children:ev.role||ek.length?(0,a.jsxs)(a.Fragment,{children:[ev.role&&ev.id!==l.owner.id&&(0,a.jsx)(W,{member:ev,pendingMembers:ei,notebook:l,canAssignRoles:eP,changeMemberRole:eM,disclaimer:eR(ev),currentUser:N}),ek.map(e=>{var t;return(0,a.jsx)(W,{member:e,memberCount:"group"===e.type?null===(t=x.find(t=>t.id===e.id))||void 0===t?void 0:t.ids.length:void 0,pendingMembers:ei,notebook:l,canAssignRoles:eP,changeMemberRole:eM,disclaimer:eR(e),currentUser:N},e.id)})]}):L?(0,a.jsx)("div",{className:"f7 fw5 gray",style:{padding:"15px 0"},children:"No team members have been granted individual access to this notebook."}):l.owner.id===N.id?(0,a.jsx)("div",{className:"f7 fw5 gray",style:{padding:"15px 0"},children:"Only you can make changes to this notebook."}):(0,a.jsx)("div",{className:"f7 fw5 gray",style:{padding:"15px 0"},children:"You will no longer have access to this notebook."})})]}),eT&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)(u.o,{value:Z,type:"individual",className:"flex items-center flex-grow-1 min-w-0",universe:L?[...h,...x.map(e=>({avatar_url:null,bio:"",home_url:"",id:e.id,login:e.id,name:e.name,pending:!0,role:null,status:"member",team_role:null,tier:"pro",type:"group"}))]:void 0,excluded:ei,placeholder:L&&(0,V.ko)(l.owner.tier)?"Search for a teammate or group":L?"Search for a teammate":"User to share with, or email to invite",disabled:eq,allowEmail:!L,onSelectUser:e=>{let t=e&&!("invited"in e)&&h.some(t=>t.id===e.id&&("viewer"===t.team_role||"guest_viewer"===t.team_role));A(e),t?M("viewer"):M("editor")}}),(0,a.jsxs)(d.P,{value:R,onChange:e=>M(e.target.value),disabled:eq||!es,className:"mh2 f6 fw5",onMouseDown:e=>{e.stopPropagation()},onMouseUp:e=>{e.stopPropagation()},children:[(!es||"viewer"!==es.team_role&&"guest_viewer"!==es.team_role&&"group"!==es.type)&&(0,a.jsx)("option",{value:"editor",children:"Can edit"}),(null==es?void 0:es.type)==="group"&&(0,a.jsx)("option",{value:"editor",children:"Can view or edit"}),(0,a.jsx)("option",{value:"viewer",children:"Can view"})]}),(0,a.jsx)(c.aX,{text:"Add",onClick:function(){null!==es&&(eM(es,R),A(null))},disabled:!es,"data-cy":"add-user"})]}),eq&&(0,a.jsx)("div",{className:"mv1 pl2 f7 mid-gray",style:{marginLeft:1},children:"Personal notebooks can be shared with up to four people"}),eb>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(g.pe,{className:"mt3",title:"Invitation message"}),(0,a.jsx)("div",{className:"flex flex-row items-center self-start w-100",children:(0,a.jsx)(f.Z,{className:"w-100",type:"text",placeholder:"Optional message to ".concat(eb," new member").concat(1===eb?"":"s"),value:ed,onChange:e=>eu(e.target.value),onKeyDown:e=>{"Enter"===e.key&&eA(e)},maxLength:255})})]})]}),"starter_2024"===l.owner.tier&&(0,a.jsx)(p.QH,{className:"w-100 mt2",message:eT?p.nn:p.oe}),(0,I.fW)(l)&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(g.pe,{title:"Thumbnail"}),(0,a.jsx)(_.E,{thumbnail:$,defaultThumbnail:K,onValueChange:e=>{X(e),en.current&&ee(en.current.checkValidity())}})]}),(0,I.qG)(N,l)&&"description"in l&&(0,a.jsx)(S,{description:l.description,onValueChange:H})]}),(0,a.jsxs)(g.mz,{children:[eF||eD?(0,a.jsx)(b.b,{type:"warning",title:"You'll no longer be able to ".concat(eF?"access":"edit"," this notebook"),description:"Please make changes to the roles above if you wish to retain your current access.",className:"mb3"}):null,eL?(0,a.jsx)(b.b,{type:"warning",title:"Database clients, notification clients,".concat(e_?", file attachments":""," and secrets will stop working when you share ").concat(L?"publicly":""),description:"These features can be used only in private notebooks.",className:"mb3"}):null,(0,a.jsxs)(c.CQ,{children:[(0,a.jsx)(c.kq,{onClick:s,text:"Cancel"}),(0,a.jsx)(c.KM,{"data-cy":"confirm",type:"submit",disabled:!eV,text:"Save"})]})]})]})})}}}]);