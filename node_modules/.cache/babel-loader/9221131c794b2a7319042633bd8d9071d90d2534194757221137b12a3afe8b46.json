{"ast":null,"code":"// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../resource.mjs\";\nimport * as Core from \"../core.mjs\";\nexport class Embeddings extends APIResource {\n  /**\n   * Creates an embedding vector representing the input text.\n   *\n   * @example\n   * ```ts\n   * const createEmbeddingResponse =\n   *   await client.embeddings.create({\n   *     input: 'The quick brown fox jumped over the lazy dog',\n   *     model: 'text-embedding-3-small',\n   *   });\n   * ```\n   */\n  create(body, options) {\n    const hasUserProvidedEncodingFormat = !!body.encoding_format;\n    // No encoding_format specified, defaulting to base64 for performance reasons\n    // See https://github.com/openai/openai-node/pull/1312\n    let encoding_format = hasUserProvidedEncodingFormat ? body.encoding_format : 'base64';\n    if (hasUserProvidedEncodingFormat) {\n      Core.debug('Request', 'User defined encoding_format:', body.encoding_format);\n    }\n    const response = this._client.post('/embeddings', {\n      body: {\n        ...body,\n        encoding_format: encoding_format\n      },\n      ...options\n    });\n    // if the user specified an encoding_format, return the response as-is\n    if (hasUserProvidedEncodingFormat) {\n      return response;\n    }\n    // in this stage, we are sure the user did not specify an encoding_format\n    // and we defaulted to base64 for performance reasons\n    // we are sure then that the response is base64 encoded, let's decode it\n    // the returned result will be a float32 array since this is OpenAI API's default encoding\n    Core.debug('response', 'Decoding base64 embeddings to float32 array');\n    return response._thenUnwrap(response => {\n      if (response && response.data) {\n        response.data.forEach(embeddingBase64Obj => {\n          const embeddingBase64Str = embeddingBase64Obj.embedding;\n          embeddingBase64Obj.embedding = Core.toFloat32Array(embeddingBase64Str);\n        });\n      }\n      return response;\n    });\n  }\n}","map":{"version":3,"names":["APIResource","Core","Embeddings","create","body","options","hasUserProvidedEncodingFormat","encoding_format","debug","response","_client","post","_thenUnwrap","data","forEach","embeddingBase64Obj","embeddingBase64Str","embedding","toFloat32Array"],"sources":["../src/resources/embeddings.ts"],"sourcesContent":[null],"mappings":"AAAA;SAESA,WAAW,QAAE;OACf,KAAKC,IAAI;AAEhB,OAAM,MAAOC,UAAW,SAAQF,WAAW;EACzC;;;;;;;;;;;;EAYAG,MAAMA,CACJC,IAA2B,EAC3BC,OAAoD;IAEpD,MAAMC,6BAA6B,GAAG,CAAC,CAACF,IAAI,CAACG,eAAe;IAC5D;IACA;IACA,IAAIA,eAAe,GACjBD,6BAA6B,GAAGF,IAAI,CAACG,eAAe,GAAG,QAAQ;IAEjE,IAAID,6BAA6B,EAAE;MACjCL,IAAI,CAACO,KAAK,CAAC,SAAS,EAAE,+BAA+B,EAAEJ,IAAI,CAACG,eAAe,CAAC;;IAG9E,MAAME,QAAQ,GAA6C,IAAI,CAACC,OAAO,CAACC,IAAI,CAAC,aAAa,EAAE;MAC1FP,IAAI,EAAE;QACJ,GAAGA,IAAI;QACPG,eAAe,EAAEA;OAClB;MACD,GAAGF;KACJ,CAAC;IAEF;IACA,IAAIC,6BAA6B,EAAE;MACjC,OAAOG,QAAQ;;IAGjB;IACA;IACA;IACA;IACAR,IAAI,CAACO,KAAK,CAAC,UAAU,EAAE,6CAA6C,CAAC;IAErE,OAAQC,QAAqD,CAACG,WAAW,CAAEH,QAAQ,IAAI;MACrF,IAAIA,QAAQ,IAAIA,QAAQ,CAACI,IAAI,EAAE;QAC7BJ,QAAQ,CAACI,IAAI,CAACC,OAAO,CAAEC,kBAAkB,IAAI;UAC3C,MAAMC,kBAAkB,GAAGD,kBAAkB,CAACE,SAA8B;UAC5EF,kBAAkB,CAACE,SAAS,GAAGhB,IAAI,CAACiB,cAAc,CAACF,kBAAkB,CAAC;QACxE,CAAC,CAAC;;MAGJ,OAAOP,QAAQ;IACjB,CAAC,CAAC;EACJ","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}