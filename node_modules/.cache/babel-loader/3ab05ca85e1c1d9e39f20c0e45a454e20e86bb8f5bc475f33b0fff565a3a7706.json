{"ast":null,"code":"/**\r\n * CuratorOdyssey Phase 2 - 시계열 데이터 처리 엔진\r\n * Dr. Sarah Kim's Advanced Temporal Analytics System\r\n * \r\n * 데뷔년 기준 상대 시간축, 누적 스택 계산, 성장 패턴 분석\r\n */\n\nimport * as d3 from 'd3';\n\n// 1. 데뷔년 기준 상대 시간축 변환\nexport const normalizeTimeAxis = (timeseriesData, debutYear) => {\n  if (!timeseriesData || !timeseriesData.bins) return null;\n  return {\n    ...timeseriesData,\n    bins: timeseriesData.bins.map(point => ({\n      ...point,\n      t: point.year ? point.year - debutYear : point.t,\n      // 절대년도 → 상대시간 변환\n      relativeYear: point.year ? point.year - debutYear : point.t\n    })).sort((a, b) => a.t - b.t) // 시간순 정렬 보장\n  };\n};\n\n// 2. 4축 누적 스택 데이터 계산 (D3 Stack Layout 전처리)\nexport const calculateStackedData = timeseriesData => {\n  if (!timeseriesData || !timeseriesData.bins) return null;\n\n  // 4축 데이터 정규화\n  const processedBins = timeseriesData.bins.map(point => ({\n    t: point.t,\n    제도: point.institution || point.inst || 0,\n    학술: point.academic || point.schl || 0,\n    담론: point.discourse || point.disc || 0,\n    네트워크: point.network || point.net || 0\n  }));\n\n  // 누적 스택 계산을 위한 D3 Stack Layout 적용\n  const stack = d3.stack().keys(['네트워크', '담론', '학술', '제도']) // 안정성 순서 (하단부터)\n  .order(d3.stackOrderNone).offset(d3.stackOffsetNone);\n  const stackedData = stack(processedBins);\n  return {\n    raw: processedBins,\n    stacked: stackedData,\n    maxValue: d3.max(stackedData[stackedData.length - 1], d => d[1])\n  };\n};\n\n// 3. 성장 패턴 분석 (변곡점 감지, 성장률 계산)\nexport const analyzeGrowthPatterns = timeseriesData => {\n  if (!timeseriesData || !timeseriesData.bins || timeseriesData.bins.length < 3) {\n    return {\n      patterns: [],\n      inflectionPoints: [],\n      growthRates: {}\n    };\n  }\n  const bins = timeseriesData.bins;\n  const totalValues = bins.map(d => (d.institution || 0) + (d.academic || 0) + (d.discourse || 0) + (d.network || 0));\n\n  // 성장률 계산 (구간별)\n  const growthRates = [];\n  for (let i = 1; i < bins.length; i++) {\n    const prev = totalValues[i - 1];\n    const curr = totalValues[i];\n    const timeDiff = bins[i].t - bins[i - 1].t;\n    if (prev > 0 && timeDiff > 0) {\n      growthRates.push({\n        period: [bins[i - 1].t, bins[i].t],\n        rate: (curr - prev) / prev / timeDiff,\n        // 연평균 성장률\n        absoluteGrowth: curr - prev\n      });\n    }\n  }\n\n  // 변곡점 감지 (2차 미분 기반)\n  const inflectionPoints = [];\n  if (growthRates.length >= 2) {\n    for (let i = 1; i < growthRates.length; i++) {\n      const prevRate = growthRates[i - 1].rate;\n      const currRate = growthRates[i].rate;\n      const acceleration = currRate - prevRate;\n\n      // 가속도 변화가 임계값을 초과하면 변곡점으로 인식\n      if (Math.abs(acceleration) > 0.1) {\n        inflectionPoints.push({\n          t: growthRates[i].period[0],\n          type: acceleration > 0 ? '가속' : '감속',\n          magnitude: Math.abs(acceleration),\n          value: totalValues[i]\n        });\n      }\n    }\n  }\n\n  // 성장 패턴 분류\n  const averageGrowthRate = d3.mean(growthRates, d => d.rate) || 0;\n  const growthVolatility = d3.deviation(growthRates, d => d.rate) || 0;\n  let primaryPattern = '안정성장';\n  if (averageGrowthRate > 0.3) primaryPattern = '급속성장';else if (averageGrowthRate < 0.05) primaryPattern = '정체';else if (growthVolatility > 0.2) primaryPattern = '변동성장';\n\n  // 축별 기여도 분석\n  const axisContributions = {\n    제도: d3.mean(bins, d => d.institution || 0),\n    학술: d3.mean(bins, d => d.academic || 0),\n    담론: d3.mean(bins, d => d.discourse || 0),\n    네트워크: d3.mean(bins, d => d.network || 0)\n  };\n  const dominantAxis = Object.entries(axisContributions).sort(([, a], [, b]) => b - a)[0][0];\n  return {\n    patterns: [primaryPattern],\n    inflectionPoints,\n    growthRates,\n    averageGrowthRate,\n    growthVolatility,\n    dominantAxis,\n    axisContributions\n  };\n};\n\n// 4. 이벤트 영향도 분석 (전후 비교, 지연 효과)\nexport const analyzeEventImpact = (timeseriesData, events) => {\n  if (!timeseriesData || !events || events.length === 0) return {};\n  const bins = timeseriesData.bins;\n  const impactAnalysis = {};\n  events.forEach(event => {\n    const eventTime = event.t;\n\n    // 이벤트 전후 데이터 추출 (기본 2년 윈도우)\n    const preWindow = 2;\n    const postWindow = 3;\n    const prePeriod = bins.filter(d => d.t >= eventTime - preWindow && d.t < eventTime);\n    const postPeriod = bins.filter(d => d.t > eventTime && d.t <= eventTime + postWindow);\n    if (prePeriod.length === 0 || postPeriod.length === 0) {\n      impactAnalysis[event.id] = {\n        growth_acceleration: 0,\n        confidence: 'low',\n        reason: 'insufficient_data'\n      };\n      return;\n    }\n\n    // 이벤트 전후 성장률 계산\n    const preAvg = d3.mean(prePeriod, d => (d.institution || 0) + (d.academic || 0) + (d.discourse || 0) + (d.network || 0));\n    const postAvg = d3.mean(postPeriod, d => (d.institution || 0) + (d.academic || 0) + (d.discourse || 0) + (d.network || 0));\n    const growthAcceleration = preAvg > 0 ? (postAvg - preAvg) / preAvg : 0;\n\n    // 축별 영향 분석\n    const axisImpacts = {};\n    ['institution', 'academic', 'discourse', 'network'].forEach(axis => {\n      const preAxisAvg = d3.mean(prePeriod, d => d[axis] || 0);\n      const postAxisAvg = d3.mean(postPeriod, d => d[axis] || 0);\n      axisImpacts[axis] = preAxisAvg > 0 ? (postAxisAvg - preAxisAvg) / preAxisAvg : 0;\n    });\n    const primaryAxis = Object.entries(axisImpacts).sort(([, a], [, b]) => Math.abs(b) - Math.abs(a))[0][0];\n\n    // 상관계수 계산 (이벤트와 성장의 연관성)\n    const correlationWindow = bins.filter(d => d.t >= eventTime - 1 && d.t <= eventTime + 2);\n    let correlationCoefficient = 0;\n    if (correlationWindow.length > 2) {\n      const distances = correlationWindow.map(d => Math.abs(d.t - eventTime));\n      const values = correlationWindow.map(d => (d.institution || 0) + (d.academic || 0) + (d.discourse || 0) + (d.network || 0));\n\n      // 피어슨 상관계수 근사\n      correlationCoefficient = -d3.mean(distances.map((dist, i) => dist * values[i])) || 0;\n    }\n    impactAnalysis[event.id] = {\n      growth_acceleration: growthAcceleration,\n      primary_axis: {\n        institution: '제도',\n        academic: '학술',\n        discourse: '담론',\n        network: '네트워크'\n      }[primaryAxis] || '전체',\n      axis_impacts: {\n        제도: axisImpacts.institution || 0,\n        학술: axisImpacts.academic || 0,\n        담론: axisImpacts.discourse || 0,\n        네트워크: axisImpacts.network || 0\n      },\n      duration_months: postWindow * 12,\n      correlation_coefficient: correlationCoefficient,\n      confidence: Math.abs(growthAcceleration) > 0.1 ? 'high' : 'medium'\n    };\n  });\n  return impactAnalysis;\n};\n\n// 5. 데이터 보간 및 스무딩 (결측치 처리)\nexport const interpolateTimeseries = (timeseriesData, targetResolution = 1) => {\n  if (!timeseriesData || !timeseriesData.bins) return timeseriesData;\n  const bins = [...timeseriesData.bins].sort((a, b) => a.t - b.t);\n  const minTime = Math.min(...bins.map(d => d.t));\n  const maxTime = Math.max(...bins.map(d => d.t));\n\n  // 목표 해상도로 시간 격자 생성\n  const timeGrid = [];\n  for (let t = minTime; t <= maxTime; t += targetResolution) {\n    timeGrid.push(t);\n  }\n\n  // 축별 보간 함수 생성\n  const axes = ['institution', 'academic', 'discourse', 'network'];\n  const interpolators = {};\n  axes.forEach(axis => {\n    const validPoints = bins.filter(d => d[axis] !== undefined && d[axis] !== null).map(d => [d.t, d[axis]]);\n    if (validPoints.length >= 2) {\n      interpolators[axis] = d3.scaleLinear().domain(validPoints.map(d => d[0])).range(validPoints.map(d => d[1]));\n    }\n  });\n\n  // 보간된 데이터 생성\n  const interpolatedBins = timeGrid.map(t => {\n    const interpolated = {\n      t\n    };\n    axes.forEach(axis => {\n      if (interpolators[axis]) {\n        interpolated[axis] = interpolators[axis](t);\n      } else {\n        interpolated[axis] = 0;\n      }\n    });\n    return interpolated;\n  });\n  return {\n    ...timeseriesData,\n    bins: interpolatedBins,\n    interpolated: true,\n    originalPoints: bins.length,\n    interpolatedPoints: interpolatedBins.length\n  };\n};\n\n// 6. 성장 예측 힌트 생성 (3-5년 전망)\nexport const generateGrowthForecast = (timeseriesData, growthAnalysis) => {\n  if (!timeseriesData || !growthAnalysis) return null;\n  const {\n    growthRates,\n    dominantAxis,\n    averageGrowthRate\n  } = growthAnalysis;\n  const lastPoint = timeseriesData.bins[timeseriesData.bins.length - 1];\n  if (!lastPoint) return null;\n\n  // 최근 3년 성장 트렌드 분석\n  const recentGrowth = growthRates.slice(-3);\n  const trendSlope = recentGrowth.length > 1 ? (recentGrowth[recentGrowth.length - 1].rate - recentGrowth[0].rate) / recentGrowth.length : 0;\n\n  // 예측 시나리오 생성\n  const forecasts = [];\n  const currentTotal = (lastPoint.institution || 0) + (lastPoint.academic || 0) + (lastPoint.discourse || 0) + (lastPoint.network || 0);\n\n  // 보수적 시나리오 (현재 성장률 유지)\n  forecasts.push({\n    scenario: 'conservative',\n    description: '현재 성장률 유지',\n    projectedValue: currentTotal * (1 + averageGrowthRate * 3),\n    confidence: 0.7,\n    keyFactors: [dominantAxis + ' 축 지속 성장']\n  });\n\n  // 낙관적 시나리오 (성장 가속화)\n  if (trendSlope > 0) {\n    forecasts.push({\n      scenario: 'optimistic',\n      description: '성장 가속화 지속',\n      projectedValue: currentTotal * (1 + (averageGrowthRate + trendSlope) * 3),\n      confidence: 0.5,\n      keyFactors: ['새로운 기회 창출', dominantAxis + ' 축 확장']\n    });\n  }\n\n  // 정체 시나리오\n  forecasts.push({\n    scenario: 'stagnant',\n    description: '성장 둔화',\n    projectedValue: currentTotal * (1 + averageGrowthRate * 0.5 * 3),\n    confidence: 0.6,\n    keyFactors: ['시장 포화', '경쟁 심화']\n  });\n  return {\n    timeHorizon: '3년',\n    currentValue: currentTotal,\n    forecasts,\n    recommendedFocus: dominantAxis,\n    riskFactors: trendSlope < -0.1 ? ['성장 둔화 신호'] : ['외부 환경 변화']\n  };\n};\n\n// 7. 통합 데이터 처리 파이프라인 \nexport const processTimeseriesData = (rawData, events = [], debutYear) => {\n  try {\n    var _rawData$bins, _interpolatedData$bin;\n    // 1단계: 시간축 정규화\n    const normalizedData = normalizeTimeAxis(rawData, debutYear);\n    if (!normalizedData) throw new Error('시간축 정규화 실패');\n\n    // 2단계: 데이터 보간\n    const interpolatedData = interpolateTimeseries(normalizedData, 0.5);\n\n    // 3단계: 스택 데이터 계산\n    const stackedData = calculateStackedData(interpolatedData);\n\n    // 4단계: 성장 패턴 분석\n    const growthAnalysis = analyzeGrowthPatterns(interpolatedData);\n\n    // 5단계: 이벤트 영향 분석\n    const eventImpactAnalysis = analyzeEventImpact(interpolatedData, events);\n\n    // 6단계: 미래 예측\n    const growthForecast = generateGrowthForecast(interpolatedData, growthAnalysis);\n    return {\n      processed: true,\n      timestamp: new Date().toISOString(),\n      data: {\n        timeseries: interpolatedData,\n        stacked: stackedData,\n        analysis: growthAnalysis,\n        eventImpacts: eventImpactAnalysis,\n        forecast: growthForecast\n      },\n      metadata: {\n        originalPoints: (rawData === null || rawData === void 0 ? void 0 : (_rawData$bins = rawData.bins) === null || _rawData$bins === void 0 ? void 0 : _rawData$bins.length) || 0,\n        processedPoints: (interpolatedData === null || interpolatedData === void 0 ? void 0 : (_interpolatedData$bin = interpolatedData.bins) === null || _interpolatedData$bin === void 0 ? void 0 : _interpolatedData$bin.length) || 0,\n        eventsAnalyzed: (events === null || events === void 0 ? void 0 : events.length) || 0,\n        processingTime: Date.now()\n      }\n    };\n  } catch (error) {\n    console.error('Timeseries processing error:', error);\n    return {\n      processed: false,\n      error: error.message,\n      timestamp: new Date().toISOString()\n    };\n  }\n};\nexport default {\n  normalizeTimeAxis,\n  calculateStackedData,\n  analyzeGrowthPatterns,\n  analyzeEventImpact,\n  interpolateTimeseries,\n  generateGrowthForecast,\n  processTimeseriesData\n};","map":{"version":3,"names":["d3","normalizeTimeAxis","timeseriesData","debutYear","bins","map","point","t","year","relativeYear","sort","a","b","calculateStackedData","processedBins","제도","institution","inst","학술","academic","schl","담론","discourse","disc","네트워크","network","net","stack","keys","order","stackOrderNone","offset","stackOffsetNone","stackedData","raw","stacked","maxValue","max","length","d","analyzeGrowthPatterns","patterns","inflectionPoints","growthRates","totalValues","i","prev","curr","timeDiff","push","period","rate","absoluteGrowth","prevRate","currRate","acceleration","Math","abs","type","magnitude","value","averageGrowthRate","mean","growthVolatility","deviation","primaryPattern","axisContributions","dominantAxis","Object","entries","analyzeEventImpact","events","impactAnalysis","forEach","event","eventTime","preWindow","postWindow","prePeriod","filter","postPeriod","id","growth_acceleration","confidence","reason","preAvg","postAvg","growthAcceleration","axisImpacts","axis","preAxisAvg","postAxisAvg","primaryAxis","correlationWindow","correlationCoefficient","distances","values","dist","primary_axis","axis_impacts","duration_months","correlation_coefficient","interpolateTimeseries","targetResolution","minTime","min","maxTime","timeGrid","axes","interpolators","validPoints","undefined","scaleLinear","domain","range","interpolatedBins","interpolated","originalPoints","interpolatedPoints","generateGrowthForecast","growthAnalysis","lastPoint","recentGrowth","slice","trendSlope","forecasts","currentTotal","scenario","description","projectedValue","keyFactors","timeHorizon","currentValue","recommendedFocus","riskFactors","processTimeseriesData","rawData","_rawData$bins","_interpolatedData$bin","normalizedData","Error","interpolatedData","eventImpactAnalysis","growthForecast","processed","timestamp","Date","toISOString","data","timeseries","analysis","eventImpacts","forecast","metadata","processedPoints","eventsAnalyzed","processingTime","now","error","console","message"],"sources":["C:/CuratorOdyssey/src/utils/timeseriesProcessor.js"],"sourcesContent":["/**\r\n * CuratorOdyssey Phase 2 - 시계열 데이터 처리 엔진\r\n * Dr. Sarah Kim's Advanced Temporal Analytics System\r\n * \r\n * 데뷔년 기준 상대 시간축, 누적 스택 계산, 성장 패턴 분석\r\n */\r\n\r\nimport * as d3 from 'd3';\r\n\r\n// 1. 데뷔년 기준 상대 시간축 변환\r\nexport const normalizeTimeAxis = (timeseriesData, debutYear) => {\r\n  if (!timeseriesData || !timeseriesData.bins) return null;\r\n\r\n  return {\r\n    ...timeseriesData,\r\n    bins: timeseriesData.bins.map(point => ({\r\n      ...point,\r\n      t: point.year ? point.year - debutYear : point.t, // 절대년도 → 상대시간 변환\r\n      relativeYear: point.year ? point.year - debutYear : point.t\r\n    })).sort((a, b) => a.t - b.t) // 시간순 정렬 보장\r\n  };\r\n};\r\n\r\n// 2. 4축 누적 스택 데이터 계산 (D3 Stack Layout 전처리)\r\nexport const calculateStackedData = (timeseriesData) => {\r\n  if (!timeseriesData || !timeseriesData.bins) return null;\r\n\r\n  // 4축 데이터 정규화\r\n  const processedBins = timeseriesData.bins.map(point => ({\r\n    t: point.t,\r\n    제도: point.institution || point.inst || 0,\r\n    학술: point.academic || point.schl || 0,\r\n    담론: point.discourse || point.disc || 0,\r\n    네트워크: point.network || point.net || 0\r\n  }));\r\n\r\n  // 누적 스택 계산을 위한 D3 Stack Layout 적용\r\n  const stack = d3.stack()\r\n    .keys(['네트워크', '담론', '학술', '제도']) // 안정성 순서 (하단부터)\r\n    .order(d3.stackOrderNone)\r\n    .offset(d3.stackOffsetNone);\r\n\r\n  const stackedData = stack(processedBins);\r\n\r\n  return {\r\n    raw: processedBins,\r\n    stacked: stackedData,\r\n    maxValue: d3.max(stackedData[stackedData.length - 1], d => d[1])\r\n  };\r\n};\r\n\r\n// 3. 성장 패턴 분석 (변곡점 감지, 성장률 계산)\r\nexport const analyzeGrowthPatterns = (timeseriesData) => {\r\n  if (!timeseriesData || !timeseriesData.bins || timeseriesData.bins.length < 3) {\r\n    return { patterns: [], inflectionPoints: [], growthRates: {} };\r\n  }\r\n\r\n  const bins = timeseriesData.bins;\r\n  const totalValues = bins.map(d => \r\n    (d.institution || 0) + (d.academic || 0) + (d.discourse || 0) + (d.network || 0)\r\n  );\r\n\r\n  // 성장률 계산 (구간별)\r\n  const growthRates = [];\r\n  for (let i = 1; i < bins.length; i++) {\r\n    const prev = totalValues[i - 1];\r\n    const curr = totalValues[i];\r\n    const timeDiff = bins[i].t - bins[i - 1].t;\r\n    \r\n    if (prev > 0 && timeDiff > 0) {\r\n      growthRates.push({\r\n        period: [bins[i - 1].t, bins[i].t],\r\n        rate: ((curr - prev) / prev) / timeDiff, // 연평균 성장률\r\n        absoluteGrowth: curr - prev\r\n      });\r\n    }\r\n  }\r\n\r\n  // 변곡점 감지 (2차 미분 기반)\r\n  const inflectionPoints = [];\r\n  if (growthRates.length >= 2) {\r\n    for (let i = 1; i < growthRates.length; i++) {\r\n      const prevRate = growthRates[i - 1].rate;\r\n      const currRate = growthRates[i].rate;\r\n      const acceleration = currRate - prevRate;\r\n      \r\n      // 가속도 변화가 임계값을 초과하면 변곡점으로 인식\r\n      if (Math.abs(acceleration) > 0.1) {\r\n        inflectionPoints.push({\r\n          t: growthRates[i].period[0],\r\n          type: acceleration > 0 ? '가속' : '감속',\r\n          magnitude: Math.abs(acceleration),\r\n          value: totalValues[i]\r\n        });\r\n      }\r\n    }\r\n  }\r\n\r\n  // 성장 패턴 분류\r\n  const averageGrowthRate = d3.mean(growthRates, d => d.rate) || 0;\r\n  const growthVolatility = d3.deviation(growthRates, d => d.rate) || 0;\r\n\r\n  let primaryPattern = '안정성장';\r\n  if (averageGrowthRate > 0.3) primaryPattern = '급속성장';\r\n  else if (averageGrowthRate < 0.05) primaryPattern = '정체';\r\n  else if (growthVolatility > 0.2) primaryPattern = '변동성장';\r\n\r\n  // 축별 기여도 분석\r\n  const axisContributions = {\r\n    제도: d3.mean(bins, d => d.institution || 0),\r\n    학술: d3.mean(bins, d => d.academic || 0),\r\n    담론: d3.mean(bins, d => d.discourse || 0),\r\n    네트워크: d3.mean(bins, d => d.network || 0)\r\n  };\r\n\r\n  const dominantAxis = Object.entries(axisContributions)\r\n    .sort(([,a], [,b]) => b - a)[0][0];\r\n\r\n  return {\r\n    patterns: [primaryPattern],\r\n    inflectionPoints,\r\n    growthRates,\r\n    averageGrowthRate,\r\n    growthVolatility,\r\n    dominantAxis,\r\n    axisContributions\r\n  };\r\n};\r\n\r\n// 4. 이벤트 영향도 분석 (전후 비교, 지연 효과)\r\nexport const analyzeEventImpact = (timeseriesData, events) => {\r\n  if (!timeseriesData || !events || events.length === 0) return {};\r\n\r\n  const bins = timeseriesData.bins;\r\n  const impactAnalysis = {};\r\n\r\n  events.forEach(event => {\r\n    const eventTime = event.t;\r\n    \r\n    // 이벤트 전후 데이터 추출 (기본 2년 윈도우)\r\n    const preWindow = 2;\r\n    const postWindow = 3;\r\n    \r\n    const prePeriod = bins.filter(d => \r\n      d.t >= (eventTime - preWindow) && d.t < eventTime\r\n    );\r\n    const postPeriod = bins.filter(d => \r\n      d.t > eventTime && d.t <= (eventTime + postWindow)\r\n    );\r\n\r\n    if (prePeriod.length === 0 || postPeriod.length === 0) {\r\n      impactAnalysis[event.id] = { \r\n        growth_acceleration: 0, \r\n        confidence: 'low',\r\n        reason: 'insufficient_data' \r\n      };\r\n      return;\r\n    }\r\n\r\n    // 이벤트 전후 성장률 계산\r\n    const preAvg = d3.mean(prePeriod, d => \r\n      (d.institution || 0) + (d.academic || 0) + (d.discourse || 0) + (d.network || 0)\r\n    );\r\n    const postAvg = d3.mean(postPeriod, d => \r\n      (d.institution || 0) + (d.academic || 0) + (d.discourse || 0) + (d.network || 0)\r\n    );\r\n\r\n    const growthAcceleration = preAvg > 0 ? (postAvg - preAvg) / preAvg : 0;\r\n\r\n    // 축별 영향 분석\r\n    const axisImpacts = {};\r\n    ['institution', 'academic', 'discourse', 'network'].forEach(axis => {\r\n      const preAxisAvg = d3.mean(prePeriod, d => d[axis] || 0);\r\n      const postAxisAvg = d3.mean(postPeriod, d => d[axis] || 0);\r\n      axisImpacts[axis] = preAxisAvg > 0 ? (postAxisAvg - preAxisAvg) / preAxisAvg : 0;\r\n    });\r\n\r\n    const primaryAxis = Object.entries(axisImpacts)\r\n      .sort(([,a], [,b]) => Math.abs(b) - Math.abs(a))[0][0];\r\n\r\n    // 상관계수 계산 (이벤트와 성장의 연관성)\r\n    const correlationWindow = bins.filter(d => \r\n      d.t >= (eventTime - 1) && d.t <= (eventTime + 2)\r\n    );\r\n    \r\n    let correlationCoefficient = 0;\r\n    if (correlationWindow.length > 2) {\r\n      const distances = correlationWindow.map(d => Math.abs(d.t - eventTime));\r\n      const values = correlationWindow.map(d => \r\n        (d.institution || 0) + (d.academic || 0) + (d.discourse || 0) + (d.network || 0)\r\n      );\r\n      \r\n      // 피어슨 상관계수 근사\r\n      correlationCoefficient = -d3.mean(distances.map((dist, i) => dist * values[i])) || 0;\r\n    }\r\n\r\n    impactAnalysis[event.id] = {\r\n      growth_acceleration: growthAcceleration,\r\n      primary_axis: {\r\n        institution: '제도',\r\n        academic: '학술', \r\n        discourse: '담론',\r\n        network: '네트워크'\r\n      }[primaryAxis] || '전체',\r\n      axis_impacts: {\r\n        제도: axisImpacts.institution || 0,\r\n        학술: axisImpacts.academic || 0,\r\n        담론: axisImpacts.discourse || 0,\r\n        네트워크: axisImpacts.network || 0\r\n      },\r\n      duration_months: postWindow * 12,\r\n      correlation_coefficient: correlationCoefficient,\r\n      confidence: Math.abs(growthAcceleration) > 0.1 ? 'high' : 'medium'\r\n    };\r\n  });\r\n\r\n  return impactAnalysis;\r\n};\r\n\r\n// 5. 데이터 보간 및 스무딩 (결측치 처리)\r\nexport const interpolateTimeseries = (timeseriesData, targetResolution = 1) => {\r\n  if (!timeseriesData || !timeseriesData.bins) return timeseriesData;\r\n\r\n  const bins = [...timeseriesData.bins].sort((a, b) => a.t - b.t);\r\n  const minTime = Math.min(...bins.map(d => d.t));\r\n  const maxTime = Math.max(...bins.map(d => d.t));\r\n  \r\n  // 목표 해상도로 시간 격자 생성\r\n  const timeGrid = [];\r\n  for (let t = minTime; t <= maxTime; t += targetResolution) {\r\n    timeGrid.push(t);\r\n  }\r\n\r\n  // 축별 보간 함수 생성\r\n  const axes = ['institution', 'academic', 'discourse', 'network'];\r\n  const interpolators = {};\r\n  \r\n  axes.forEach(axis => {\r\n    const validPoints = bins\r\n      .filter(d => d[axis] !== undefined && d[axis] !== null)\r\n      .map(d => [d.t, d[axis]]);\r\n    \r\n    if (validPoints.length >= 2) {\r\n      interpolators[axis] = d3.scaleLinear()\r\n        .domain(validPoints.map(d => d[0]))\r\n        .range(validPoints.map(d => d[1]));\r\n    }\r\n  });\r\n\r\n  // 보간된 데이터 생성\r\n  const interpolatedBins = timeGrid.map(t => {\r\n    const interpolated = { t };\r\n    \r\n    axes.forEach(axis => {\r\n      if (interpolators[axis]) {\r\n        interpolated[axis] = interpolators[axis](t);\r\n      } else {\r\n        interpolated[axis] = 0;\r\n      }\r\n    });\r\n    \r\n    return interpolated;\r\n  });\r\n\r\n  return {\r\n    ...timeseriesData,\r\n    bins: interpolatedBins,\r\n    interpolated: true,\r\n    originalPoints: bins.length,\r\n    interpolatedPoints: interpolatedBins.length\r\n  };\r\n};\r\n\r\n// 6. 성장 예측 힌트 생성 (3-5년 전망)\r\nexport const generateGrowthForecast = (timeseriesData, growthAnalysis) => {\r\n  if (!timeseriesData || !growthAnalysis) return null;\r\n\r\n  const { growthRates, dominantAxis, averageGrowthRate } = growthAnalysis;\r\n  const lastPoint = timeseriesData.bins[timeseriesData.bins.length - 1];\r\n  \r\n  if (!lastPoint) return null;\r\n\r\n  // 최근 3년 성장 트렌드 분석\r\n  const recentGrowth = growthRates.slice(-3);\r\n  const trendSlope = recentGrowth.length > 1 ? \r\n    (recentGrowth[recentGrowth.length - 1].rate - recentGrowth[0].rate) / recentGrowth.length : 0;\r\n\r\n  // 예측 시나리오 생성\r\n  const forecasts = [];\r\n  const currentTotal = (lastPoint.institution || 0) + (lastPoint.academic || 0) + \r\n                     (lastPoint.discourse || 0) + (lastPoint.network || 0);\r\n\r\n  // 보수적 시나리오 (현재 성장률 유지)\r\n  forecasts.push({\r\n    scenario: 'conservative',\r\n    description: '현재 성장률 유지',\r\n    projectedValue: currentTotal * (1 + averageGrowthRate * 3),\r\n    confidence: 0.7,\r\n    keyFactors: [dominantAxis + ' 축 지속 성장']\r\n  });\r\n\r\n  // 낙관적 시나리오 (성장 가속화)\r\n  if (trendSlope > 0) {\r\n    forecasts.push({\r\n      scenario: 'optimistic',\r\n      description: '성장 가속화 지속',\r\n      projectedValue: currentTotal * (1 + (averageGrowthRate + trendSlope) * 3),\r\n      confidence: 0.5,\r\n      keyFactors: ['새로운 기회 창출', dominantAxis + ' 축 확장']\r\n    });\r\n  }\r\n\r\n  // 정체 시나리오\r\n  forecasts.push({\r\n    scenario: 'stagnant', \r\n    description: '성장 둔화',\r\n    projectedValue: currentTotal * (1 + averageGrowthRate * 0.5 * 3),\r\n    confidence: 0.6,\r\n    keyFactors: ['시장 포화', '경쟁 심화']\r\n  });\r\n\r\n  return {\r\n    timeHorizon: '3년',\r\n    currentValue: currentTotal,\r\n    forecasts,\r\n    recommendedFocus: dominantAxis,\r\n    riskFactors: trendSlope < -0.1 ? ['성장 둔화 신호'] : ['외부 환경 변화']\r\n  };\r\n};\r\n\r\n// 7. 통합 데이터 처리 파이프라인 \r\nexport const processTimeseriesData = (rawData, events = [], debutYear) => {\r\n  try {\r\n    // 1단계: 시간축 정규화\r\n    const normalizedData = normalizeTimeAxis(rawData, debutYear);\r\n    if (!normalizedData) throw new Error('시간축 정규화 실패');\r\n\r\n    // 2단계: 데이터 보간\r\n    const interpolatedData = interpolateTimeseries(normalizedData, 0.5);\r\n\r\n    // 3단계: 스택 데이터 계산\r\n    const stackedData = calculateStackedData(interpolatedData);\r\n\r\n    // 4단계: 성장 패턴 분석\r\n    const growthAnalysis = analyzeGrowthPatterns(interpolatedData);\r\n\r\n    // 5단계: 이벤트 영향 분석\r\n    const eventImpactAnalysis = analyzeEventImpact(interpolatedData, events);\r\n\r\n    // 6단계: 미래 예측\r\n    const growthForecast = generateGrowthForecast(interpolatedData, growthAnalysis);\r\n\r\n    return {\r\n      processed: true,\r\n      timestamp: new Date().toISOString(),\r\n      data: {\r\n        timeseries: interpolatedData,\r\n        stacked: stackedData,\r\n        analysis: growthAnalysis,\r\n        eventImpacts: eventImpactAnalysis,\r\n        forecast: growthForecast\r\n      },\r\n      metadata: {\r\n        originalPoints: rawData?.bins?.length || 0,\r\n        processedPoints: interpolatedData?.bins?.length || 0,\r\n        eventsAnalyzed: events?.length || 0,\r\n        processingTime: Date.now()\r\n      }\r\n    };\r\n\r\n  } catch (error) {\r\n    console.error('Timeseries processing error:', error);\r\n    return {\r\n      processed: false,\r\n      error: error.message,\r\n      timestamp: new Date().toISOString()\r\n    };\r\n  }\r\n};\r\n\r\nexport default {\r\n  normalizeTimeAxis,\r\n  calculateStackedData, \r\n  analyzeGrowthPatterns,\r\n  analyzeEventImpact,\r\n  interpolateTimeseries,\r\n  generateGrowthForecast,\r\n  processTimeseriesData\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}