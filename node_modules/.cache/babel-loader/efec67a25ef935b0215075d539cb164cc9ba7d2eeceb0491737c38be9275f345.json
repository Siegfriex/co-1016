{"ast":null,"code":"// CuratorOdyssey AI Analysis Service\n// OpenAI GPT-4 + Anthropic Claude Î∞±ÏóÖ ÏãúÏä§ÌÖú\n\nimport OpenAI from 'openai';\nclass AIService {\n  constructor() {\n    // OpenAI Ï¥àÍ∏∞Ìôî (Î©îÏù∏ AI ÏóîÏßÑ)\n    this.openai = null;\n    this.anthropicKey = process.env.REACT_APP_ANTHROPIC_API_KEY;\n    this.vertexConfig = {\n      projectId: process.env.REACT_APP_VERTEX_AI_PROJECT_ID,\n      location: process.env.REACT_APP_VERTEX_AI_LOCATION\n    };\n\n    // ÏÑ§Ï†ïÍ∞í\n    this.maxRetries = parseInt(process.env.REACT_APP_AI_MAX_RETRIES) || 3;\n    this.timeout = parseInt(process.env.REACT_APP_AI_TIMEOUT) || 30000;\n    this.initializeOpenAI();\n  }\n  initializeOpenAI() {\n    const apiKey = process.env.REACT_APP_OPENAI_API_KEY;\n    if (apiKey && apiKey !== 'your_openai_api_key_here') {\n      this.openai = new OpenAI({\n        apiKey: apiKey,\n        dangerouslyAllowBrowser: true // ‚ö†Ô∏è ÌîÑÎ°úÎçïÏÖòÏóêÏÑúÎäî Î∞±ÏóîÎìúÎ°ú Ïù¥Ï†Ñ ÌïÑÏöî\n      });\n    }\n  }\n\n  /**\r\n   * Phase 1 ÏïÑÌã∞Ïä§Ìä∏ Îç∞Ïù¥ÌÑ∞ Î∂ÑÏÑù (ÌïµÏã¨ Î©îÏÑúÎìú)\r\n   * @param {Object} artistData - ÏïÑÌã∞Ïä§Ìä∏ Î†àÏù¥Îçî/ÏÑ†Î≤ÑÏä§Ìä∏ Îç∞Ïù¥ÌÑ∞\r\n   * @returns {Promise<Object>} AI Î∂ÑÏÑù Í≤∞Í≥º\r\n   */\n  async generatePhase1Insights(artistData) {\n    try {\n      console.log('ü§ñ AI Phase 1 Î∂ÑÏÑù ÏãúÏûë:', artistData.name);\n      if (!this.openai) {\n        return this.generateFallbackInsights(artistData);\n      }\n      const prompt = this.buildPhase1Prompt(artistData);\n      const completion = await this.callOpenAI(prompt);\n      return {\n        success: true,\n        insights: completion,\n        model: 'gpt-4',\n        timestamp: new Date().toISOString(),\n        analysisType: 'phase1',\n        artist: artistData.name\n      };\n    } catch (error) {\n      console.error('AI Î∂ÑÏÑù Ïò§Î•ò:', error);\n\n      // Anthropic Î∞±ÏóÖ ÏãúÎèÑ\n      try {\n        if (this.anthropicKey) {\n          const claudeResult = await this.callAnthropic(this.buildPhase1Prompt(artistData));\n          return {\n            success: true,\n            insights: claudeResult,\n            model: 'claude-3',\n            timestamp: new Date().toISOString(),\n            analysisType: 'phase1',\n            artist: artistData.name,\n            fallbackUsed: true\n          };\n        }\n      } catch (claudeError) {\n        console.error('Claude Î∞±ÏóÖÎèÑ Ïã§Ìå®:', claudeError);\n      }\n\n      // ÏµúÏ¢Ö Ìè¥Î∞±\n      return this.generateFallbackInsights(artistData);\n    }\n  }\n\n  /**\r\n   * OpenAI API Ìò∏Ï∂ú\r\n   */\n  async callOpenAI(prompt, retries = 0) {\n    try {\n      const response = await Promise.race([this.openai.chat.completions.create({\n        model: process.env.REACT_APP_OPENAI_MODEL || 'gpt-4',\n        messages: [{\n          role: 'system',\n          content: 'CuratorOdysseyÏùò Ï†ÑÎ¨∏ ÏïÑÌä∏ÎßàÏºì Î∂ÑÏÑùÍ∞ÄÎ°úÏÑú, Îç∞Ïù¥ÌÑ∞ Í∏∞Î∞òÏùò Í∞ùÍ¥ÄÏ†ÅÏù¥Í≥† ÌÜµÏ∞∞Î†• ÏûàÎäî Î∂ÑÏÑùÏùÑ Ï†úÍ≥µÌï©ÎãàÎã§.'\n        }, {\n          role: 'user',\n          content: prompt\n        }],\n        max_tokens: 1000,\n        temperature: 0.7\n      }), new Promise((_, reject) => setTimeout(() => reject(new Error('AI ÏùëÎãµ ÏãúÍ∞Ñ Ï¥àÍ≥º')), this.timeout))]);\n      return response.choices[0].message.content;\n    } catch (error) {\n      if (retries < this.maxRetries) {\n        console.log(`AI Ïû¨ÏãúÎèÑ ${retries + 1}/${this.maxRetries}`);\n        await new Promise(resolve => setTimeout(resolve, 1000 * (retries + 1)));\n        return this.callOpenAI(prompt, retries + 1);\n      }\n      throw error;\n    }\n  }\n\n  /**\r\n   * Anthropic Claude API Ìò∏Ï∂ú (Î∞±ÏóÖÏö©)\r\n   */\n  async callAnthropic(prompt) {\n    // Ïã§Ï†ú Íµ¨ÌòÑÏùÄ Anthropic SDK ÏÇ¨Ïö©\n    // ÌòÑÏû¨Îäî Íµ¨Ï°∞Îßå Ï†ïÏùò\n    throw new Error('Anthropic Ïó∞ÎèôÏùÄ Ìñ•ÌõÑ Íµ¨ÌòÑ ÏòàÏ†ï');\n  }\n\n  /**\r\n   * Vertex AI Ìò∏Ï∂ú (Î∞±ÏóîÎìú Cloud Function Ïó∞Îèô)\r\n   */\n  async callVertexAI(prompt, options = {}) {\n    try {\n      var _result$usage;\n      console.log('üîÆ Vertex AI Î∞±ÏóîÎìú Ìò∏Ï∂ú ÏãúÏûë');\n      const response = await fetch('/api/ai/vertex-generate', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${process.env.REACT_APP_VERTEX_AI_TOKEN || ''}`\n        },\n        body: JSON.stringify({\n          prompt,\n          model: options.model || 'gemini-1.5-pro',\n          reportType: options.reportType || 'comprehensive',\n          temperature: options.temperature || 0.7,\n          maxTokens: options.maxTokens || 2000\n        })\n      });\n      if (!response.ok) {\n        throw new Error(`Vertex API Error: ${response.status}`);\n      }\n      const result = await response.json();\n      return {\n        success: true,\n        content: result.content,\n        model: 'vertex-ai-gemini',\n        tokens_used: ((_result$usage = result.usage) === null || _result$usage === void 0 ? void 0 : _result$usage.total_tokens) || 0,\n        timestamp: new Date().toISOString()\n      };\n    } catch (error) {\n      console.error('Vertex AI Ìò∏Ï∂ú Ïã§Ìå®:', error);\n\n      // OpenAIÎ°ú Ìè¥Î∞±\n      if (this.openai) {\n        console.log('üîÑ OpenAIÎ°ú Ìè¥Î∞± ÏãúÎèÑ');\n        return await this.callOpenAI(prompt);\n      }\n      throw error;\n    }\n  }\n\n  /**\r\n   * Phase 1 ÌîÑÎ°¨ÌîÑÌä∏ ÏÉùÏÑ±\r\n   */\n  buildPhase1Prompt(artistData) {\n    return `CuratorOdyssey Phase 1 Î∂ÑÏÑùÍ∞ÄÎ°úÏÑú, Îã§Ïùå ÏûëÍ∞ÄÏùò Îç∞Ïù¥ÌÑ∞Î•º Ï¢ÖÌï© Î∂ÑÏÑùÌï¥Ï£ºÏÑ∏Ïöî:\n\n**ÏûëÍ∞Ä**: ${artistData.name}\n\n**5Ï∂ï Î†àÏù¥Îçî Ï†êÏàò** (0-100):\n- Í∏∞Í¥ÄÏ†ÑÏãú(I): ${artistData.radar5.I}Ï†ê\n- ÌéòÏñ¥(F): ${artistData.radar5.F}Ï†ê  \n- ÏãúÏÉÅ(A): ${artistData.radar5.A}Ï†ê\n- ÎØ∏ÎîîÏñ¥(M): ${artistData.radar5.M}Ï†ê\n- ÍµêÏú°(Sedu): ${artistData.radar5.Sedu}Ï†ê\n\n**4Ï∂ï ÏÑ†Î≤ÑÏä§Ìä∏ Í∑ºÍ±∞ Îç∞Ïù¥ÌÑ∞**:\n- Ï†úÎèÑ: ${artistData.sunburst_l1.Ï†úÎèÑ}Ï†ê\n- ÌïôÏà†: ${artistData.sunburst_l1.ÌïôÏà†}Ï†ê\n- Îã¥Î°†: ${artistData.sunburst_l1.Îã¥Î°†}Ï†ê\n- ÎÑ§Ìä∏ÏõåÌÅ¨: ${artistData.sunburst_l1.ÎÑ§Ìä∏ÏõåÌÅ¨}Ï†ê\n\n**Î∂ÑÏÑù ÏöîÏ≤≠**:\n1. **Í∞ÄÏπò Íµ¨ÏÑ±Ïùò ÌäπÏßï**: 5Ï∂ï Ï†êÏàò Ìå®ÌÑ¥ÏóêÏÑú ÎÇòÌÉÄÎÇòÎäî ÏûëÍ∞ÄÏùò Í∞ïÏ†êÍ≥º ÌäπÏÑ±\n2. **Í∑†ÌòïÎèÑ Î∂ÑÏÑù**: Ï∂ïÍ∞Ñ Ìé∏Ï∞®ÏôÄ Ìè¨Ìä∏Ìè¥Î¶¨Ïò§ Îã§Í∞ÅÌôî ÏàòÏ§Ä\n3. **ÏãúÏû• Ìè¨ÏßÄÏÖîÎãù**: ÌòÑÏû¨ Ï†êÏàò Í∏∞Î∞ò ÏûëÍ∞ÄÏùò ÏãúÏû• ÎÇ¥ ÏúÑÏπò\n4. **Î∞úÏ†Ñ Ï†úÏñ∏**: ÏïΩÏ†ê Î≥¥ÏôÑ Î∞è Í∞ïÏ†ê Í∑πÎåÄÌôî Ï†ÑÎûµ\n\n**ÏùëÎãµ ÌòïÏãù**: \n- ÌïúÍµ≠Ïñ¥Î°ú ÏûëÏÑ±\n- 4Í∞ú ÏÑπÏÖò Íµ¨Ï°∞Ìôî \n- Í∞Å ÏÑπÏÖò 2-3Î¨∏Ïû•ÏúºÎ°ú Í∞ÑÍ≤∞ÌïòÍ≤å\n- Ï¥ù 800Ïûê Ïù¥ÎÇ¥\n- Îç∞Ïù¥ÌÑ∞ ÏàòÏπò ÌôúÏö©Ìïú Íµ¨Ï≤¥Ï†Å Í∑ºÍ±∞ Ï†úÏãú\n\nÎ∂ÑÏÑù ÏãúÏûë:`;\n  }\n\n  /**\r\n   * AI Ïã§Ìå® Ïãú Ìè¥Î∞± Ïù∏ÏÇ¨Ïù¥Ìä∏ ÏÉùÏÑ±\r\n   */\n  generateFallbackInsights(artistData) {\n    console.log('üîÑ Ìè¥Î∞± Ïù∏ÏÇ¨Ïù¥Ìä∏ ÏÉùÏÑ±:', artistData.name);\n    const radar = artistData.radar5;\n    const sunburst = artistData.sunburst_l1;\n\n    // ÌÜµÍ≥ÑÏ†Å Î∂ÑÏÑù\n    const radarValues = Object.values(radar);\n    const maxScore = Math.max(...radarValues);\n    const minScore = Math.min(...radarValues);\n    const avgScore = radarValues.reduce((a, b) => a + b, 0) / radarValues.length;\n    const variance = radarValues.reduce((acc, val) => acc + Math.pow(val - avgScore, 2), 0) / radarValues.length;\n\n    // Í∞ïÏ†ê Ï∂ï ÏãùÎ≥Ñ\n    const strengths = Object.entries(radar).filter(([_, score]) => score > avgScore + 10).map(([axis, _]) => this.getAxisName(axis));\n\n    // ÏïΩÏ†ê Ï∂ï ÏãùÎ≥Ñ  \n    const weaknesses = Object.entries(radar).filter(([_, score]) => score < avgScore - 10).map(([axis, _]) => this.getAxisName(axis));\n    const insights = `## üìä ${artistData.name} Phase 1 Î∂ÑÏÑù (Îç∞Ïù¥ÌÑ∞ Í∏∞Î∞ò)\n\n### üéØ Í∞ÄÏπò Íµ¨ÏÑ±Ïùò ÌäπÏßï\nÌòÑÏû¨ ÌèâÍ∑† Ï†êÏàò ${avgScore.toFixed(1)}Ï†êÏúºÎ°ú ${maxScore >= 90 ? 'ÏµúÏÉÅÏúÑÍ∂å' : maxScore >= 80 ? 'ÏÉÅÏúÑÍ∂å' : 'Ï§ëÏúÑÍ∂å'} ÏúÑÏπòÏûÖÎãàÎã§. ${strengths.length > 0 ? `ÌäπÌûà ${strengths.join(', ')} ÏòÅÏó≠ÏóêÏÑú Í∞ïÏÑ∏Î•º Î≥¥Ïù¥Î©∞` : 'Í∑†Îì±Ìïú Î∞úÏ†Ñ ÏñëÏÉÅÏùÑ Î≥¥Ïù¥Î©∞'}, Ïù¥Îäî ${variance > 500 ? 'Ï†ÑÎ¨∏ÌôîÎêú' : 'Í∑†ÌòïÏû°Ìûå'} ÏÑ±Ïû• Ìå®ÌÑ¥ÏùÑ ÎÇòÌÉÄÎÉÖÎãàÎã§.\n\n### ‚öñÔ∏è Í∑†ÌòïÎèÑ Î∂ÑÏÑù  \nÏµúÍ≥†Ï†ê ${maxScore}Ï†êÍ≥º ÏµúÏ†ÄÏ†ê ${minScore}Ï†êÏùò Í≤©Ï∞®Í∞Ä ${(maxScore - minScore).toFixed(1)}Ï†êÏúºÎ°ú, ${maxScore - minScore > 50 ? 'Î∂àÍ∑†ÌòïÏù¥ Îã§ÏÜå Ï°¥Ïû¨' : 'ÎπÑÍµêÏ†Å ÏïàÏ†ïÏ†ÅÏù∏ Í∑†Ìòï'}ÏùÑ Î≥¥ÏûÖÎãàÎã§. 4Ï∂ï ÏÑ†Î≤ÑÏä§Ìä∏ Îç∞Ïù¥ÌÑ∞ÏóêÏÑúÎäî ${Object.entries(sunburst).sort((a, b) => b[1] - a[1])[0][0]}(${Object.entries(sunburst).sort((a, b) => b[1] - a[1])[0][1]}Ï†ê)Ïù¥ Í∞ÄÏû• Í≤¨Í≥†Ìïú Í∏∞Î∞òÏùÑ ÌòïÏÑ±ÌïòÍ≥† ÏûàÏäµÎãàÎã§.\n\n### üé™ ÏãúÏû• Ìè¨ÏßÄÏÖîÎãù\nÏ†ÑÏ≤¥Ï†ÅÏúºÎ°ú ${avgScore >= 85 ? 'Í∏ÄÎ°úÎ≤å ÌÜ±Ìã∞Ïñ¥' : avgScore >= 70 ? 'ÏïÑÏãúÏïÑ Ï£ºÏöî ÏûëÍ∞Ä' : 'Ïã†ÏßÑ Ïú†Îßù ÏûëÍ∞Ä'} ÏàòÏ§ÄÏùò ÏÑ±Í≥ºÎ•º Îã¨ÏÑ±ÌñàÏäµÎãàÎã§. ${radar.I >= 90 ? 'Í∏∞Í¥Ä Ï†ÑÏãú' : radar.M >= 85 ? 'ÎØ∏ÎîîÏñ¥ ÎÖ∏Ï∂ú' : radar.F >= 85 ? 'ÌéòÏñ¥ Ï∞∏Ïó¨' : 'ÎÑ§Ìä∏ÏõåÌÅ¨ Íµ¨Ï∂ï'} Ï∏°Î©¥ÏóêÏÑúÏùò Îõ∞Ïñ¥ÎÇú ÏÑ±Í≥ºÍ∞Ä Ï£ºÏöî Í≤ΩÏüÅÎ†•ÏúºÎ°ú ÏûëÏö©ÌïòÍ≥† ÏûàÏäµÎãàÎã§.\n\n### üí° Î∞úÏ†Ñ Ï†úÏñ∏\n${weaknesses.length > 0 ? `${weaknesses.join(', ')} ÏòÅÏó≠ ÏßëÏ§ë Í∞úÎ∞úÏùÑ ÌÜµÌï¥` : 'ÌòÑÏû¨ Í∞ïÏ†ê ÏòÅÏó≠ Ïã¨ÌôîÎ•º ÌÜµÌï¥'} Ï∂îÍ∞ÄÏ†ÅÏù∏ ÎèÑÏïΩÏù¥ Í∞ÄÎä•Ìï©ÎãàÎã§. ÌäπÌûà ${minScore < 50 ? 'Ï∑®ÏïΩ ÏòÅÏó≠Ïùò Îã®Í≥ÑÏ†Å Î≥¥ÏôÑ' : 'Í∞ïÏ†ê ÏòÅÏó≠Ïùò Í∏ÄÎ°úÎ≤å ÌôïÏû•'}Ïóê ÏßëÏ§ëÌïòÎ©¥ ÎçîÏö± Í∑†ÌòïÏû°Ìûå Ìè¨Ìä∏Ìè¥Î¶¨Ïò§ Íµ¨Ï∂ïÏù¥ Í∏∞ÎåÄÎê©ÎãàÎã§.`;\n    return {\n      success: true,\n      insights,\n      model: 'fallback',\n      timestamp: new Date().toISOString(),\n      analysisType: 'phase1',\n      artist: artistData.name,\n      fallbackUsed: true,\n      statistics: {\n        average: avgScore.toFixed(1),\n        max: maxScore,\n        min: minScore,\n        variance: variance.toFixed(1),\n        strengths,\n        weaknesses\n      }\n    };\n  }\n\n  /**\r\n   * Ï∂ï Ïù¥Î¶Ñ ÌïúÍµ≠Ïñ¥ Î≥ÄÌôò\r\n   */\n  getAxisName(axisCode) {\n    const names = {\n      'I': 'Í∏∞Í¥ÄÏ†ÑÏãú',\n      'F': 'ÌéòÏñ¥',\n      'A': 'ÏãúÏÉÅ',\n      'M': 'ÎØ∏ÎîîÏñ¥',\n      'Sedu': 'ÍµêÏú°'\n    };\n    return names[axisCode] || axisCode;\n  }\n\n  /**\r\n   * Phase 2/3 ÌÜµÌï© Î∂ÑÏÑù (Ïã†Í∑ú - Ï¢ÖÌï© Î≥¥Í≥†ÏÑú)\r\n   */\n  async generateComprehensiveReport(phase1Data, phase2Data = null, phase3Data = null) {\n    try {\n      console.log('üìã Ï¢ÖÌï© Î≥¥Í≥†ÏÑú ÏÉùÏÑ± ÏãúÏûë:', phase1Data.name);\n      const reportData = {\n        phase1: phase1Data,\n        phase2: phase2Data,\n        phase3: phase3Data,\n        analysisDepth: phase2Data && phase3Data ? 'comprehensive' : phase2Data ? 'intermediate' : 'basic'\n      };\n      const prompt = this.buildComprehensivePrompt(reportData);\n\n      // Vertex AI Ïö∞ÏÑ† ÏãúÎèÑ\n      try {\n        const vertexResult = await this.callVertexAI(prompt, {\n          model: 'gemini-1.5-pro',\n          reportType: 'comprehensive',\n          maxTokens: 3000\n        });\n        return {\n          success: true,\n          report: vertexResult.content,\n          model: 'vertex-ai-gemini',\n          analysisType: 'comprehensive',\n          phases_analyzed: reportData.analysisDepth,\n          timestamp: new Date().toISOString()\n        };\n      } catch (vertexError) {\n        console.log('Vertex AI Ïã§Ìå®, OpenAIÎ°ú Ìè¥Î∞±');\n        const openaiResult = await this.callOpenAI(prompt);\n        return {\n          success: true,\n          report: openaiResult,\n          model: 'gpt-4-comprehensive',\n          analysisType: 'comprehensive',\n          phases_analyzed: reportData.analysisDepth,\n          timestamp: new Date().toISOString(),\n          fallback_used: true\n        };\n      }\n    } catch (error) {\n      console.error('Ï¢ÖÌï© Î≥¥Í≥†ÏÑú ÏÉùÏÑ± Ïã§Ìå®:', error);\n      return this.generateFallbackComprehensiveReport(phase1Data);\n    }\n  }\n\n  /**\r\n   * Ï¢ÖÌï© Î∂ÑÏÑù ÌîÑÎ°¨ÌîÑÌä∏ ÏÉùÏÑ±\r\n   */\n  buildComprehensivePrompt(reportData) {\n    const {\n      phase1,\n      phase2,\n      phase3,\n      analysisDepth\n    } = reportData;\n    return `CuratorOdyssey Ï¢ÖÌï© Î≥¥Í≥†ÏÑú ÏÉùÏÑ± ÏöîÏ≤≠:\n\n**ÏûëÍ∞Ä**: ${phase1.name}\n**Î∂ÑÏÑù Î≤îÏúÑ**: ${analysisDepth.toUpperCase()} (Phase 1${phase2 ? ' + 2' : ''}${phase3 ? ' + 3' : ''})\n\n**Phase 1 Îç∞Ïù¥ÌÑ∞** (ÌòÑÏû¨ Í∞ÄÏπò):\n- 5Ï∂ï Ï†êÏàò: I${phase1.radar5.I} F${phase1.radar5.F} A${phase1.radar5.A} M${phase1.radar5.M} S${phase1.radar5.Sedu}\n- 4Ï∂ï Í∏∞Î∞ò: Ï†úÎèÑ${phase1.sunburst_l1.Ï†úÎèÑ} ÌïôÏà†${phase1.sunburst_l1.ÌïôÏà†} Îã¥Î°†${phase1.sunburst_l1.Îã¥Î°†} ÎÑ§Ìä∏ÏõåÌÅ¨${phase1.sunburst_l1.ÎÑ§Ìä∏ÏõåÌÅ¨}\n\n${phase2 ? `**Phase 2 Îç∞Ïù¥ÌÑ∞** (ÏãúÍ∞ÑÏ∂ï Í∂§Ï†Å):\n- 20ÎÖÑÍ∞Ñ ÏÑ±Ïû• Ìå®ÌÑ¥ Îç∞Ïù¥ÌÑ∞\n- Ï£ºÏöî Î≥ÄÍ≥°Ï†ê Î∞è Ïù¥Î≤§Ìä∏ ÌÉÄÏûÑÎùºÏù∏\n- Ï∂ïÎ≥Ñ ÏÑ±Ïû• ÏÜçÎèÑ Î∞è Í∞ÄÏÜçÎèÑ Î∂ÑÏÑù\n\n` : ''}\n\n${phase3 ? `**Phase 3 Îç∞Ïù¥ÌÑ∞** (ÎπÑÍµê Î∂ÑÏÑù):\n- ÎèôÏãúÎåÄ ÏûëÍ∞ÄÍµ∞ ÎåÄÎπÑ Ìè¨ÏßÄÏÖîÎãù\n- Í∞ÄÍ≤© ÎåÄÎπÑ ÏÑ±Í≥º Í∂§Ï†Å ÏÉÅÍ¥ÄÍ¥ÄÍ≥Ñ\n- ÏãúÏû• ÎÇ¥ Í≤ΩÏüÅÎ†• Î∞è Ï∞®Î≥ÑÌôî ÏöîÏÜå\n\n` : ''}\n\n**Î≥¥Í≥†ÏÑú ÏöîÍµ¨ÏÇ¨Ìï≠**:\n1. **Executive Summary**: ÌïµÏã¨ Ïù∏ÏÇ¨Ïù¥Ìä∏ 3-5Ï§Ñ ÏöîÏïΩ\n2. **ÌòÑÏû¨ Í∞ÄÏπò ÏßÑÎã®**: Phase 1 Îç∞Ïù¥ÌÑ∞ Ìï¥ÏÑù\n3. **ÏÑ±Ïû• Í∂§Ï†Å Î∂ÑÏÑù**: ${phase2 ? 'Phase 2 Í∏∞Î∞ò ÏãúÍ≥ÑÏó¥ Ìå®ÌÑ¥ Î∂ÑÏÑù' : 'ÏòàÏÉÅ ÏÑ±Ïû• Í≤ΩÎ°ú Ï†úÏãú'}\n4. **ÏãúÏû• Ìè¨ÏßÄÏÖîÎãù**: ${phase3 ? 'Phase 3 Í∏∞Î∞ò Í≤ΩÏüÅ Î∂ÑÏÑù' : 'Ï∂îÏ†ï ÏãúÏû• ÎÇ¥ ÏúÑÏπò'}\n5. **Ï†ÑÎûµÏ†Å Ï†úÏñ∏**: Îã®Í∏∞(1ÎÖÑ)/Ï§ëÍ∏∞(3ÎÖÑ) Î∞úÏ†Ñ Î°úÎìúÎßµ\n6. **Î¶¨Ïä§ÌÅ¨ ÏöîÏù∏**: Ï£ºÏöî ÏúÑÌóò ÏöîÏÜå Î∞è ÎåÄÏùë Ï†ÑÎûµ\n\n**ÌòïÏãù**: Íµ¨Ï°∞ÌôîÎêú ÎßàÌÅ¨Îã§Ïö¥, Ï¥ù 1500-2000Ïûê, Îç∞Ïù¥ÌÑ∞ Í∏∞Î∞ò Íµ¨Ï≤¥Ï†Å Í∑ºÍ±∞ ÌïÑÏàò\n\nÎ∂ÑÏÑù ÏãúÏûë:`;\n  }\n\n  /**\r\n   * Ï¢ÖÌï© Î∂ÑÏÑù Ìè¥Î∞± Î≥¥Í≥†ÏÑú\r\n   */\n  generateFallbackComprehensiveReport(phase1Data) {\n    const radar = phase1Data.radar5;\n    const avgScore = Object.values(radar).reduce((a, b) => a + b, 0) / 5;\n    const report = `# üìã ${phase1Data.name} Ï¢ÖÌï© Î∂ÑÏÑù Î≥¥Í≥†ÏÑú (ÌÜµÍ≥Ñ Í∏∞Î∞ò)\n\n## Executive Summary\nÌòÑÏû¨ ÌèâÍ∑† Ï†êÏàò ${avgScore.toFixed(1)}Ï†êÏúºÎ°ú ${avgScore >= 85 ? 'Í∏ÄÎ°úÎ≤å ÌÜ±Ìã∞Ïñ¥' : avgScore >= 70 ? 'ÏïÑÏãúÏïÑ Ï£ºÏöî ÏûëÍ∞Ä' : 'Ïã†ÏßÑ Ïú†Îßù ÏûëÍ∞Ä'} ÏàòÏ§ÄÏûÖÎãàÎã§. ${Object.entries(radar).sort((a, b) => b[1] - a[1])[0][0] === 'I' ? 'Í∏∞Í¥ÄÏ†ÑÏãú' : 'ÌäπÏ†ï ÏòÅÏó≠'}ÏóêÏÑúÏùò Í∞ïÏ†êÏùÑ Î∞îÌÉïÏúºÎ°ú Í∑†ÌòïÏû°Ìûå ÏÑ±Ïû•Ïù¥ Í∏∞ÎåÄÎê©ÎãàÎã§.\n\n## ÌòÑÏû¨ Í∞ÄÏπò ÏßÑÎã®\n**Í∞ïÏ†ê ÏòÅÏó≠**: ${Object.entries(radar).filter(([_, v]) => v > avgScore + 10).map(([k, _]) => this.getAxisName(k)).join(', ')}\n**Í∞úÏÑ† ÏòÅÏó≠**: ${Object.entries(radar).filter(([_, v]) => v < avgScore - 10).map(([k, _]) => this.getAxisName(k)).join(', ')}\n\n5Ï∂ï Ï§ë ÏµúÍ≥† ${Math.max(...Object.values(radar))}Ï†êÍ≥º ÏµúÏ†Ä ${Math.min(...Object.values(radar))}Ï†êÏùò Í≤©Ï∞®Í∞Ä ${(Math.max(...Object.values(radar)) - Math.min(...Object.values(radar))).toFixed(1)}Ï†êÏúºÎ°ú ${Math.max(...Object.values(radar)) - Math.min(...Object.values(radar)) > 50 ? 'Ï†ÑÎ¨∏ÌôîÎêú' : 'Í∑†ÌòïÏû°Ìûå'} ÌîÑÎ°úÌïÑÏùÑ Î≥¥ÏûÖÎãàÎã§.\n\n## ÏÑ±Ïû• Í∂§Ï†Å Î∂ÑÏÑù\nÌòÑÏû¨ ÏàòÏ§ÄÏóêÏÑú ÏòàÏÉÅÎêòÎäî ÏÑ±Ïû• Í≤ΩÎ°úÎäî Ïó∞ÌèâÍ∑† 5-8% ÏÉÅÏäπÏúºÎ°ú, ÏïΩ 3-5ÎÖÑ ÎÇ¥ Ï†ÑÏ≤¥Ï†ÅÏù∏ Ï†êÏàò Ìñ•ÏÉÅÏù¥ Í∏∞ÎåÄÎê©ÎãàÎã§. ÌäπÌûà ÏïΩÏ†ê ÏòÅÏó≠Ïùò ÏßëÏ§ëÏ†Å Í∞úÎ∞ú Ïãú ÎçîÏö± Í∞ÄÌååÎ•∏ ÏÑ±Ïû• Í≥°ÏÑ†Ïù¥ Í∞ÄÎä•Ìï† Í≤ÉÏúºÎ°ú Î∂ÑÏÑùÎê©ÎãàÎã§.\n\n## ÏãúÏû• Ìè¨ÏßÄÏÖîÎãù\nÎèôÏùº ÏÑ∏ÎåÄ ÏûëÍ∞ÄÍµ∞ ÎåÄÎπÑ ${avgScore >= 80 ? 'ÏÉÅÏúÑ 20%' : avgScore >= 65 ? 'ÏÉÅÏúÑ 40%' : 'ÏÑ±Ïû• Ïû†Ïû¨Î†• Í∑∏Î£π'} ÏúÑÏπòÎ°ú Ï∂îÏ†ïÎê©ÎãàÎã§. ÌòÑÏû¨ Í∞ïÏ†ê ÏòÅÏó≠ÏùÑ Ï§ëÏã¨ÏúºÎ°ú Ìïú Ï∞®Î≥ÑÌôî Ï†ÑÎûµÏù¥ Ìö®Í≥ºÏ†ÅÏùº Í≤ÉÏúºÎ°ú ÌåêÎã®Îê©ÎãàÎã§.\n\n## Ï†ÑÎûµÏ†Å Ï†úÏñ∏\n**Îã®Í∏∞(1ÎÖÑ)**: ${Object.values(radar).some(v => v < 50) ? 'Ï∑®ÏïΩ ÏòÅÏó≠ Í∏∞Ï¥à Ï≤¥Î†• Í∞ïÌôî' : 'Í∞ïÏ†ê ÏòÅÏó≠ Ïã¨Ìôî Î∞úÏ†Ñ'}\n**Ï§ëÍ∏∞(3ÎÖÑ)**: Íµ≠Ï†úÏ†Å Ïù∏ÏßÄÎèÑ ÌôïÏÇ∞ Î∞è Îã§Í∞ÅÌôîÎêú Ìè¨Ìä∏Ìè¥Î¶¨Ïò§ Íµ¨Ï∂ï\n\n## Î¶¨Ïä§ÌÅ¨ ÏöîÏù∏\n- ÏãúÏû• Î≥ÄÎèôÏÑ±Ïóê Îî∞Î•∏ ÏòÅÌñ•ÎèÑ: ${avgScore > 80 ? 'LOW' : avgScore > 60 ? 'MEDIUM' : 'HIGH'}\n- Í≤ΩÏüÅ ÌôòÍ≤Ω Î≥ÄÌôî ÎåÄÏùëÎ†•: ÏßÄÏÜçÏ†Å Î™®ÎãàÌÑ∞ÎßÅ ÌïÑÏöî\n\n---\n*Î∂ÑÏÑù Í∏∞Ï§Ä: AHP v1.0 | ÏÉùÏÑ± ÏãúÍ∞Å: ${new Date().toLocaleString('ko-KR')}*`;\n    return {\n      success: true,\n      report,\n      model: 'statistical-comprehensive',\n      analysisType: 'comprehensive',\n      phases_analyzed: 'basic',\n      timestamp: new Date().toISOString(),\n      fallback_used: true\n    };\n  }\n\n  /**\r\n   * API Ïó∞Í≤∞ ÏÉÅÌÉú ÌôïÏù∏ (ÌôïÏû•)\r\n   */\n  async checkConnection() {\n    const results = {\n      openai: {\n        connected: false,\n        reason: ''\n      },\n      vertex: {\n        connected: false,\n        reason: ''\n      },\n      overall: {\n        connected: false,\n        primary: null\n      }\n    };\n\n    // OpenAI Ïó∞Í≤∞ ÌôïÏù∏\n    try {\n      if (this.openai) {\n        await this.openai.chat.completions.create({\n          model: 'gpt-3.5-turbo',\n          messages: [{\n            role: 'user',\n            content: 'ÌÖåÏä§Ìä∏'\n          }],\n          max_tokens: 5\n        });\n        results.openai = {\n          connected: true,\n          model: 'gpt-4'\n        };\n      } else {\n        results.openai = {\n          connected: false,\n          reason: 'API ÌÇ§ ÎØ∏ÏÑ§Ï†ï'\n        };\n      }\n    } catch (error) {\n      results.openai = {\n        connected: false,\n        reason: error.message\n      };\n    }\n\n    // Vertex AI Ïó∞Í≤∞ ÌôïÏù∏\n    try {\n      const testResponse = await fetch('/api/ai/vertex-health', {\n        method: 'GET',\n        headers: {\n          'Authorization': `Bearer ${process.env.REACT_APP_VERTEX_AI_TOKEN || ''}`\n        }\n      });\n      if (testResponse.ok) {\n        results.vertex = {\n          connected: true,\n          model: 'gemini-1.5-pro'\n        };\n      } else {\n        results.vertex = {\n          connected: false,\n          reason: `Î∞±ÏóîÎìú Ïó∞Í≤∞ Ïã§Ìå®: ${testResponse.status}`\n        };\n      }\n    } catch (error) {\n      results.vertex = {\n        connected: false,\n        reason: 'Î∞±ÏóîÎìú ÏÑúÎ≤Ñ ÎØ∏ÏùëÎãµ'\n      };\n    }\n\n    // Ï†ÑÏ≤¥ ÏÉÅÌÉú Í≤∞Ï†ï\n    if (results.vertex.connected) {\n      results.overall = {\n        connected: true,\n        primary: 'vertex-ai'\n      };\n    } else if (results.openai.connected) {\n      results.overall = {\n        connected: true,\n        primary: 'openai'\n      };\n    } else {\n      results.overall = {\n        connected: false,\n        primary: 'fallback'\n      };\n    }\n    return results;\n  }\n}\n\n// Ïã±Í∏ÄÌÜ§ Ìå®ÌÑ¥ÏúºÎ°ú ÎÇ¥Î≥¥ÎÇ¥Í∏∞\nconst aiService = new AIService();\nexport default aiService;","map":{"version":3,"names":["OpenAI","AIService","constructor","openai","anthropicKey","process","env","REACT_APP_ANTHROPIC_API_KEY","vertexConfig","projectId","REACT_APP_VERTEX_AI_PROJECT_ID","location","REACT_APP_VERTEX_AI_LOCATION","maxRetries","parseInt","REACT_APP_AI_MAX_RETRIES","timeout","REACT_APP_AI_TIMEOUT","initializeOpenAI","apiKey","REACT_APP_OPENAI_API_KEY","dangerouslyAllowBrowser","generatePhase1Insights","artistData","console","log","name","generateFallbackInsights","prompt","buildPhase1Prompt","completion","callOpenAI","success","insights","model","timestamp","Date","toISOString","analysisType","artist","error","claudeResult","callAnthropic","fallbackUsed","claudeError","retries","response","Promise","race","chat","completions","create","REACT_APP_OPENAI_MODEL","messages","role","content","max_tokens","temperature","_","reject","setTimeout","Error","choices","message","resolve","callVertexAI","options","_result$usage","fetch","method","headers","REACT_APP_VERTEX_AI_TOKEN","body","JSON","stringify","reportType","maxTokens","ok","status","result","json","tokens_used","usage","total_tokens","radar5","I","F","A","M","Sedu","sunburst_l1","Ï†úÎèÑ","ÌïôÏà†","Îã¥Î°†","ÎÑ§Ìä∏ÏõåÌÅ¨","radar","sunburst","radarValues","Object","values","maxScore","Math","max","minScore","min","avgScore","reduce","a","b","length","variance","acc","val","pow","strengths","entries","filter","score","map","axis","getAxisName","weaknesses","toFixed","join","sort","statistics","average","axisCode","names","generateComprehensiveReport","phase1Data","phase2Data","phase3Data","reportData","phase1","phase2","phase3","analysisDepth","buildComprehensivePrompt","vertexResult","report","phases_analyzed","vertexError","openaiResult","fallback_used","generateFallbackComprehensiveReport","toUpperCase","v","k","some","toLocaleString","checkConnection","results","connected","reason","vertex","overall","primary","testResponse","aiService"],"sources":["C:/CuratorOdyssey/src/services/aiService.js"],"sourcesContent":["// CuratorOdyssey AI Analysis Service\r\n// OpenAI GPT-4 + Anthropic Claude Î∞±ÏóÖ ÏãúÏä§ÌÖú\r\n\r\nimport OpenAI from 'openai';\r\n\r\nclass AIService {\r\n  constructor() {\r\n    // OpenAI Ï¥àÍ∏∞Ìôî (Î©îÏù∏ AI ÏóîÏßÑ)\r\n    this.openai = null;\r\n    this.anthropicKey = process.env.REACT_APP_ANTHROPIC_API_KEY;\r\n    this.vertexConfig = {\r\n      projectId: process.env.REACT_APP_VERTEX_AI_PROJECT_ID,\r\n      location: process.env.REACT_APP_VERTEX_AI_LOCATION\r\n    };\r\n    \r\n    // ÏÑ§Ï†ïÍ∞í\r\n    this.maxRetries = parseInt(process.env.REACT_APP_AI_MAX_RETRIES) || 3;\r\n    this.timeout = parseInt(process.env.REACT_APP_AI_TIMEOUT) || 30000;\r\n    \r\n    this.initializeOpenAI();\r\n  }\r\n\r\n  initializeOpenAI() {\r\n    const apiKey = process.env.REACT_APP_OPENAI_API_KEY;\r\n    if (apiKey && apiKey !== 'your_openai_api_key_here') {\r\n      this.openai = new OpenAI({\r\n        apiKey: apiKey,\r\n        dangerouslyAllowBrowser: true // ‚ö†Ô∏è ÌîÑÎ°úÎçïÏÖòÏóêÏÑúÎäî Î∞±ÏóîÎìúÎ°ú Ïù¥Ï†Ñ ÌïÑÏöî\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Phase 1 ÏïÑÌã∞Ïä§Ìä∏ Îç∞Ïù¥ÌÑ∞ Î∂ÑÏÑù (ÌïµÏã¨ Î©îÏÑúÎìú)\r\n   * @param {Object} artistData - ÏïÑÌã∞Ïä§Ìä∏ Î†àÏù¥Îçî/ÏÑ†Î≤ÑÏä§Ìä∏ Îç∞Ïù¥ÌÑ∞\r\n   * @returns {Promise<Object>} AI Î∂ÑÏÑù Í≤∞Í≥º\r\n   */\r\n  async generatePhase1Insights(artistData) {\r\n    try {\r\n      console.log('ü§ñ AI Phase 1 Î∂ÑÏÑù ÏãúÏûë:', artistData.name);\r\n      \r\n      if (!this.openai) {\r\n        return this.generateFallbackInsights(artistData);\r\n      }\r\n\r\n      const prompt = this.buildPhase1Prompt(artistData);\r\n      \r\n      const completion = await this.callOpenAI(prompt);\r\n      \r\n      return {\r\n        success: true,\r\n        insights: completion,\r\n        model: 'gpt-4',\r\n        timestamp: new Date().toISOString(),\r\n        analysisType: 'phase1',\r\n        artist: artistData.name\r\n      };\r\n\r\n    } catch (error) {\r\n      console.error('AI Î∂ÑÏÑù Ïò§Î•ò:', error);\r\n      \r\n      // Anthropic Î∞±ÏóÖ ÏãúÎèÑ\r\n      try {\r\n        if (this.anthropicKey) {\r\n          const claudeResult = await this.callAnthropic(\r\n            this.buildPhase1Prompt(artistData)\r\n          );\r\n          return {\r\n            success: true,\r\n            insights: claudeResult,\r\n            model: 'claude-3',\r\n            timestamp: new Date().toISOString(),\r\n            analysisType: 'phase1',\r\n            artist: artistData.name,\r\n            fallbackUsed: true\r\n          };\r\n        }\r\n      } catch (claudeError) {\r\n        console.error('Claude Î∞±ÏóÖÎèÑ Ïã§Ìå®:', claudeError);\r\n      }\r\n      \r\n      // ÏµúÏ¢Ö Ìè¥Î∞±\r\n      return this.generateFallbackInsights(artistData);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * OpenAI API Ìò∏Ï∂ú\r\n   */\r\n  async callOpenAI(prompt, retries = 0) {\r\n    try {\r\n      const response = await Promise.race([\r\n        this.openai.chat.completions.create({\r\n          model: process.env.REACT_APP_OPENAI_MODEL || 'gpt-4',\r\n          messages: [\r\n            {\r\n              role: 'system',\r\n              content: 'CuratorOdysseyÏùò Ï†ÑÎ¨∏ ÏïÑÌä∏ÎßàÏºì Î∂ÑÏÑùÍ∞ÄÎ°úÏÑú, Îç∞Ïù¥ÌÑ∞ Í∏∞Î∞òÏùò Í∞ùÍ¥ÄÏ†ÅÏù¥Í≥† ÌÜµÏ∞∞Î†• ÏûàÎäî Î∂ÑÏÑùÏùÑ Ï†úÍ≥µÌï©ÎãàÎã§.'\r\n            },\r\n            {\r\n              role: 'user', \r\n              content: prompt\r\n            }\r\n          ],\r\n          max_tokens: 1000,\r\n          temperature: 0.7\r\n        }),\r\n        new Promise((_, reject) => \r\n          setTimeout(() => reject(new Error('AI ÏùëÎãµ ÏãúÍ∞Ñ Ï¥àÍ≥º')), this.timeout)\r\n        )\r\n      ]);\r\n\r\n      return response.choices[0].message.content;\r\n\r\n    } catch (error) {\r\n      if (retries < this.maxRetries) {\r\n        console.log(`AI Ïû¨ÏãúÎèÑ ${retries + 1}/${this.maxRetries}`);\r\n        await new Promise(resolve => setTimeout(resolve, 1000 * (retries + 1)));\r\n        return this.callOpenAI(prompt, retries + 1);\r\n      }\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Anthropic Claude API Ìò∏Ï∂ú (Î∞±ÏóÖÏö©)\r\n   */\r\n  async callAnthropic(prompt) {\r\n    // Ïã§Ï†ú Íµ¨ÌòÑÏùÄ Anthropic SDK ÏÇ¨Ïö©\r\n    // ÌòÑÏû¨Îäî Íµ¨Ï°∞Îßå Ï†ïÏùò\r\n    throw new Error('Anthropic Ïó∞ÎèôÏùÄ Ìñ•ÌõÑ Íµ¨ÌòÑ ÏòàÏ†ï');\r\n  }\r\n\r\n  /**\r\n   * Vertex AI Ìò∏Ï∂ú (Î∞±ÏóîÎìú Cloud Function Ïó∞Îèô)\r\n   */\r\n  async callVertexAI(prompt, options = {}) {\r\n    try {\r\n      console.log('üîÆ Vertex AI Î∞±ÏóîÎìú Ìò∏Ï∂ú ÏãúÏûë');\r\n      \r\n      const response = await fetch('/api/ai/vertex-generate', {\r\n        method: 'POST',\r\n        headers: { \r\n          'Content-Type': 'application/json',\r\n          'Authorization': `Bearer ${process.env.REACT_APP_VERTEX_AI_TOKEN || ''}`\r\n        },\r\n        body: JSON.stringify({ \r\n          prompt, \r\n          model: options.model || 'gemini-1.5-pro',\r\n          reportType: options.reportType || 'comprehensive',\r\n          temperature: options.temperature || 0.7,\r\n          maxTokens: options.maxTokens || 2000\r\n        })\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error(`Vertex API Error: ${response.status}`);\r\n      }\r\n\r\n      const result = await response.json();\r\n      \r\n      return {\r\n        success: true,\r\n        content: result.content,\r\n        model: 'vertex-ai-gemini',\r\n        tokens_used: result.usage?.total_tokens || 0,\r\n        timestamp: new Date().toISOString()\r\n      };\r\n\r\n    } catch (error) {\r\n      console.error('Vertex AI Ìò∏Ï∂ú Ïã§Ìå®:', error);\r\n      \r\n      // OpenAIÎ°ú Ìè¥Î∞±\r\n      if (this.openai) {\r\n        console.log('üîÑ OpenAIÎ°ú Ìè¥Î∞± ÏãúÎèÑ');\r\n        return await this.callOpenAI(prompt);\r\n      }\r\n      \r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Phase 1 ÌîÑÎ°¨ÌîÑÌä∏ ÏÉùÏÑ±\r\n   */\r\n  buildPhase1Prompt(artistData) {\r\n    return `CuratorOdyssey Phase 1 Î∂ÑÏÑùÍ∞ÄÎ°úÏÑú, Îã§Ïùå ÏûëÍ∞ÄÏùò Îç∞Ïù¥ÌÑ∞Î•º Ï¢ÖÌï© Î∂ÑÏÑùÌï¥Ï£ºÏÑ∏Ïöî:\r\n\r\n**ÏûëÍ∞Ä**: ${artistData.name}\r\n\r\n**5Ï∂ï Î†àÏù¥Îçî Ï†êÏàò** (0-100):\r\n- Í∏∞Í¥ÄÏ†ÑÏãú(I): ${artistData.radar5.I}Ï†ê\r\n- ÌéòÏñ¥(F): ${artistData.radar5.F}Ï†ê  \r\n- ÏãúÏÉÅ(A): ${artistData.radar5.A}Ï†ê\r\n- ÎØ∏ÎîîÏñ¥(M): ${artistData.radar5.M}Ï†ê\r\n- ÍµêÏú°(Sedu): ${artistData.radar5.Sedu}Ï†ê\r\n\r\n**4Ï∂ï ÏÑ†Î≤ÑÏä§Ìä∏ Í∑ºÍ±∞ Îç∞Ïù¥ÌÑ∞**:\r\n- Ï†úÎèÑ: ${artistData.sunburst_l1.Ï†úÎèÑ}Ï†ê\r\n- ÌïôÏà†: ${artistData.sunburst_l1.ÌïôÏà†}Ï†ê\r\n- Îã¥Î°†: ${artistData.sunburst_l1.Îã¥Î°†}Ï†ê\r\n- ÎÑ§Ìä∏ÏõåÌÅ¨: ${artistData.sunburst_l1.ÎÑ§Ìä∏ÏõåÌÅ¨}Ï†ê\r\n\r\n**Î∂ÑÏÑù ÏöîÏ≤≠**:\r\n1. **Í∞ÄÏπò Íµ¨ÏÑ±Ïùò ÌäπÏßï**: 5Ï∂ï Ï†êÏàò Ìå®ÌÑ¥ÏóêÏÑú ÎÇòÌÉÄÎÇòÎäî ÏûëÍ∞ÄÏùò Í∞ïÏ†êÍ≥º ÌäπÏÑ±\r\n2. **Í∑†ÌòïÎèÑ Î∂ÑÏÑù**: Ï∂ïÍ∞Ñ Ìé∏Ï∞®ÏôÄ Ìè¨Ìä∏Ìè¥Î¶¨Ïò§ Îã§Í∞ÅÌôî ÏàòÏ§Ä\r\n3. **ÏãúÏû• Ìè¨ÏßÄÏÖîÎãù**: ÌòÑÏû¨ Ï†êÏàò Í∏∞Î∞ò ÏûëÍ∞ÄÏùò ÏãúÏû• ÎÇ¥ ÏúÑÏπò\r\n4. **Î∞úÏ†Ñ Ï†úÏñ∏**: ÏïΩÏ†ê Î≥¥ÏôÑ Î∞è Í∞ïÏ†ê Í∑πÎåÄÌôî Ï†ÑÎûµ\r\n\r\n**ÏùëÎãµ ÌòïÏãù**: \r\n- ÌïúÍµ≠Ïñ¥Î°ú ÏûëÏÑ±\r\n- 4Í∞ú ÏÑπÏÖò Íµ¨Ï°∞Ìôî \r\n- Í∞Å ÏÑπÏÖò 2-3Î¨∏Ïû•ÏúºÎ°ú Í∞ÑÍ≤∞ÌïòÍ≤å\r\n- Ï¥ù 800Ïûê Ïù¥ÎÇ¥\r\n- Îç∞Ïù¥ÌÑ∞ ÏàòÏπò ÌôúÏö©Ìïú Íµ¨Ï≤¥Ï†Å Í∑ºÍ±∞ Ï†úÏãú\r\n\r\nÎ∂ÑÏÑù ÏãúÏûë:`;\r\n  }\r\n\r\n  /**\r\n   * AI Ïã§Ìå® Ïãú Ìè¥Î∞± Ïù∏ÏÇ¨Ïù¥Ìä∏ ÏÉùÏÑ±\r\n   */\r\n  generateFallbackInsights(artistData) {\r\n    console.log('üîÑ Ìè¥Î∞± Ïù∏ÏÇ¨Ïù¥Ìä∏ ÏÉùÏÑ±:', artistData.name);\r\n    \r\n    const radar = artistData.radar5;\r\n    const sunburst = artistData.sunburst_l1;\r\n    \r\n    // ÌÜµÍ≥ÑÏ†Å Î∂ÑÏÑù\r\n    const radarValues = Object.values(radar);\r\n    const maxScore = Math.max(...radarValues);\r\n    const minScore = Math.min(...radarValues);\r\n    const avgScore = radarValues.reduce((a, b) => a + b, 0) / radarValues.length;\r\n    const variance = radarValues.reduce((acc, val) => acc + Math.pow(val - avgScore, 2), 0) / radarValues.length;\r\n    \r\n    // Í∞ïÏ†ê Ï∂ï ÏãùÎ≥Ñ\r\n    const strengths = Object.entries(radar)\r\n      .filter(([_, score]) => score > avgScore + 10)\r\n      .map(([axis, _]) => this.getAxisName(axis));\r\n    \r\n    // ÏïΩÏ†ê Ï∂ï ÏãùÎ≥Ñ  \r\n    const weaknesses = Object.entries(radar)\r\n      .filter(([_, score]) => score < avgScore - 10)\r\n      .map(([axis, _]) => this.getAxisName(axis));\r\n\r\n    const insights = `## üìä ${artistData.name} Phase 1 Î∂ÑÏÑù (Îç∞Ïù¥ÌÑ∞ Í∏∞Î∞ò)\r\n\r\n### üéØ Í∞ÄÏπò Íµ¨ÏÑ±Ïùò ÌäπÏßï\r\nÌòÑÏû¨ ÌèâÍ∑† Ï†êÏàò ${avgScore.toFixed(1)}Ï†êÏúºÎ°ú ${maxScore >= 90 ? 'ÏµúÏÉÅÏúÑÍ∂å' : maxScore >= 80 ? 'ÏÉÅÏúÑÍ∂å' : 'Ï§ëÏúÑÍ∂å'} ÏúÑÏπòÏûÖÎãàÎã§. ${strengths.length > 0 ? `ÌäπÌûà ${strengths.join(', ')} ÏòÅÏó≠ÏóêÏÑú Í∞ïÏÑ∏Î•º Î≥¥Ïù¥Î©∞` : 'Í∑†Îì±Ìïú Î∞úÏ†Ñ ÏñëÏÉÅÏùÑ Î≥¥Ïù¥Î©∞'}, Ïù¥Îäî ${variance > 500 ? 'Ï†ÑÎ¨∏ÌôîÎêú' : 'Í∑†ÌòïÏû°Ìûå'} ÏÑ±Ïû• Ìå®ÌÑ¥ÏùÑ ÎÇòÌÉÄÎÉÖÎãàÎã§.\r\n\r\n### ‚öñÔ∏è Í∑†ÌòïÎèÑ Î∂ÑÏÑù  \r\nÏµúÍ≥†Ï†ê ${maxScore}Ï†êÍ≥º ÏµúÏ†ÄÏ†ê ${minScore}Ï†êÏùò Í≤©Ï∞®Í∞Ä ${(maxScore - minScore).toFixed(1)}Ï†êÏúºÎ°ú, ${maxScore - minScore > 50 ? 'Î∂àÍ∑†ÌòïÏù¥ Îã§ÏÜå Ï°¥Ïû¨' : 'ÎπÑÍµêÏ†Å ÏïàÏ†ïÏ†ÅÏù∏ Í∑†Ìòï'}ÏùÑ Î≥¥ÏûÖÎãàÎã§. 4Ï∂ï ÏÑ†Î≤ÑÏä§Ìä∏ Îç∞Ïù¥ÌÑ∞ÏóêÏÑúÎäî ${Object.entries(sunburst).sort((a, b) => b[1] - a[1])[0][0]}(${Object.entries(sunburst).sort((a, b) => b[1] - a[1])[0][1]}Ï†ê)Ïù¥ Í∞ÄÏû• Í≤¨Í≥†Ìïú Í∏∞Î∞òÏùÑ ÌòïÏÑ±ÌïòÍ≥† ÏûàÏäµÎãàÎã§.\r\n\r\n### üé™ ÏãúÏû• Ìè¨ÏßÄÏÖîÎãù\r\nÏ†ÑÏ≤¥Ï†ÅÏúºÎ°ú ${avgScore >= 85 ? 'Í∏ÄÎ°úÎ≤å ÌÜ±Ìã∞Ïñ¥' : avgScore >= 70 ? 'ÏïÑÏãúÏïÑ Ï£ºÏöî ÏûëÍ∞Ä' : 'Ïã†ÏßÑ Ïú†Îßù ÏûëÍ∞Ä'} ÏàòÏ§ÄÏùò ÏÑ±Í≥ºÎ•º Îã¨ÏÑ±ÌñàÏäµÎãàÎã§. ${radar.I >= 90 ? 'Í∏∞Í¥Ä Ï†ÑÏãú' : radar.M >= 85 ? 'ÎØ∏ÎîîÏñ¥ ÎÖ∏Ï∂ú' : radar.F >= 85 ? 'ÌéòÏñ¥ Ï∞∏Ïó¨' : 'ÎÑ§Ìä∏ÏõåÌÅ¨ Íµ¨Ï∂ï'} Ï∏°Î©¥ÏóêÏÑúÏùò Îõ∞Ïñ¥ÎÇú ÏÑ±Í≥ºÍ∞Ä Ï£ºÏöî Í≤ΩÏüÅÎ†•ÏúºÎ°ú ÏûëÏö©ÌïòÍ≥† ÏûàÏäµÎãàÎã§.\r\n\r\n### üí° Î∞úÏ†Ñ Ï†úÏñ∏\r\n${weaknesses.length > 0 ? `${weaknesses.join(', ')} ÏòÅÏó≠ ÏßëÏ§ë Í∞úÎ∞úÏùÑ ÌÜµÌï¥` : 'ÌòÑÏû¨ Í∞ïÏ†ê ÏòÅÏó≠ Ïã¨ÌôîÎ•º ÌÜµÌï¥'} Ï∂îÍ∞ÄÏ†ÅÏù∏ ÎèÑÏïΩÏù¥ Í∞ÄÎä•Ìï©ÎãàÎã§. ÌäπÌûà ${minScore < 50 ? 'Ï∑®ÏïΩ ÏòÅÏó≠Ïùò Îã®Í≥ÑÏ†Å Î≥¥ÏôÑ' : 'Í∞ïÏ†ê ÏòÅÏó≠Ïùò Í∏ÄÎ°úÎ≤å ÌôïÏû•'}Ïóê ÏßëÏ§ëÌïòÎ©¥ ÎçîÏö± Í∑†ÌòïÏû°Ìûå Ìè¨Ìä∏Ìè¥Î¶¨Ïò§ Íµ¨Ï∂ïÏù¥ Í∏∞ÎåÄÎê©ÎãàÎã§.`;\r\n\r\n    return {\r\n      success: true,\r\n      insights,\r\n      model: 'fallback',\r\n      timestamp: new Date().toISOString(),\r\n      analysisType: 'phase1',\r\n      artist: artistData.name,\r\n      fallbackUsed: true,\r\n      statistics: {\r\n        average: avgScore.toFixed(1),\r\n        max: maxScore,\r\n        min: minScore,\r\n        variance: variance.toFixed(1),\r\n        strengths,\r\n        weaknesses\r\n      }\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Ï∂ï Ïù¥Î¶Ñ ÌïúÍµ≠Ïñ¥ Î≥ÄÌôò\r\n   */\r\n  getAxisName(axisCode) {\r\n    const names = {\r\n      'I': 'Í∏∞Í¥ÄÏ†ÑÏãú',\r\n      'F': 'ÌéòÏñ¥',\r\n      'A': 'ÏãúÏÉÅ', \r\n      'M': 'ÎØ∏ÎîîÏñ¥',\r\n      'Sedu': 'ÍµêÏú°'\r\n    };\r\n    return names[axisCode] || axisCode;\r\n  }\r\n\r\n  /**\r\n   * Phase 2/3 ÌÜµÌï© Î∂ÑÏÑù (Ïã†Í∑ú - Ï¢ÖÌï© Î≥¥Í≥†ÏÑú)\r\n   */\r\n  async generateComprehensiveReport(phase1Data, phase2Data = null, phase3Data = null) {\r\n    try {\r\n      console.log('üìã Ï¢ÖÌï© Î≥¥Í≥†ÏÑú ÏÉùÏÑ± ÏãúÏûë:', phase1Data.name);\r\n      \r\n      const reportData = {\r\n        phase1: phase1Data,\r\n        phase2: phase2Data,\r\n        phase3: phase3Data,\r\n        analysisDepth: phase2Data && phase3Data ? 'comprehensive' : \r\n                       phase2Data ? 'intermediate' : 'basic'\r\n      };\r\n\r\n      const prompt = this.buildComprehensivePrompt(reportData);\r\n      \r\n      // Vertex AI Ïö∞ÏÑ† ÏãúÎèÑ\r\n      try {\r\n        const vertexResult = await this.callVertexAI(prompt, {\r\n          model: 'gemini-1.5-pro',\r\n          reportType: 'comprehensive',\r\n          maxTokens: 3000\r\n        });\r\n        \r\n        return {\r\n          success: true,\r\n          report: vertexResult.content,\r\n          model: 'vertex-ai-gemini',\r\n          analysisType: 'comprehensive',\r\n          phases_analyzed: reportData.analysisDepth,\r\n          timestamp: new Date().toISOString()\r\n        };\r\n      } catch (vertexError) {\r\n        console.log('Vertex AI Ïã§Ìå®, OpenAIÎ°ú Ìè¥Î∞±');\r\n        \r\n        const openaiResult = await this.callOpenAI(prompt);\r\n        \r\n        return {\r\n          success: true,\r\n          report: openaiResult,\r\n          model: 'gpt-4-comprehensive',\r\n          analysisType: 'comprehensive', \r\n          phases_analyzed: reportData.analysisDepth,\r\n          timestamp: new Date().toISOString(),\r\n          fallback_used: true\r\n        };\r\n      }\r\n\r\n    } catch (error) {\r\n      console.error('Ï¢ÖÌï© Î≥¥Í≥†ÏÑú ÏÉùÏÑ± Ïã§Ìå®:', error);\r\n      return this.generateFallbackComprehensiveReport(phase1Data);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Ï¢ÖÌï© Î∂ÑÏÑù ÌîÑÎ°¨ÌîÑÌä∏ ÏÉùÏÑ±\r\n   */\r\n  buildComprehensivePrompt(reportData) {\r\n    const { phase1, phase2, phase3, analysisDepth } = reportData;\r\n    \r\n    return `CuratorOdyssey Ï¢ÖÌï© Î≥¥Í≥†ÏÑú ÏÉùÏÑ± ÏöîÏ≤≠:\r\n\r\n**ÏûëÍ∞Ä**: ${phase1.name}\r\n**Î∂ÑÏÑù Î≤îÏúÑ**: ${analysisDepth.toUpperCase()} (Phase 1${phase2 ? ' + 2' : ''}${phase3 ? ' + 3' : ''})\r\n\r\n**Phase 1 Îç∞Ïù¥ÌÑ∞** (ÌòÑÏû¨ Í∞ÄÏπò):\r\n- 5Ï∂ï Ï†êÏàò: I${phase1.radar5.I} F${phase1.radar5.F} A${phase1.radar5.A} M${phase1.radar5.M} S${phase1.radar5.Sedu}\r\n- 4Ï∂ï Í∏∞Î∞ò: Ï†úÎèÑ${phase1.sunburst_l1.Ï†úÎèÑ} ÌïôÏà†${phase1.sunburst_l1.ÌïôÏà†} Îã¥Î°†${phase1.sunburst_l1.Îã¥Î°†} ÎÑ§Ìä∏ÏõåÌÅ¨${phase1.sunburst_l1.ÎÑ§Ìä∏ÏõåÌÅ¨}\r\n\r\n${phase2 ? `**Phase 2 Îç∞Ïù¥ÌÑ∞** (ÏãúÍ∞ÑÏ∂ï Í∂§Ï†Å):\r\n- 20ÎÖÑÍ∞Ñ ÏÑ±Ïû• Ìå®ÌÑ¥ Îç∞Ïù¥ÌÑ∞\r\n- Ï£ºÏöî Î≥ÄÍ≥°Ï†ê Î∞è Ïù¥Î≤§Ìä∏ ÌÉÄÏûÑÎùºÏù∏\r\n- Ï∂ïÎ≥Ñ ÏÑ±Ïû• ÏÜçÎèÑ Î∞è Í∞ÄÏÜçÎèÑ Î∂ÑÏÑù\r\n\r\n` : ''}\r\n\r\n${phase3 ? `**Phase 3 Îç∞Ïù¥ÌÑ∞** (ÎπÑÍµê Î∂ÑÏÑù):\r\n- ÎèôÏãúÎåÄ ÏûëÍ∞ÄÍµ∞ ÎåÄÎπÑ Ìè¨ÏßÄÏÖîÎãù\r\n- Í∞ÄÍ≤© ÎåÄÎπÑ ÏÑ±Í≥º Í∂§Ï†Å ÏÉÅÍ¥ÄÍ¥ÄÍ≥Ñ\r\n- ÏãúÏû• ÎÇ¥ Í≤ΩÏüÅÎ†• Î∞è Ï∞®Î≥ÑÌôî ÏöîÏÜå\r\n\r\n` : ''}\r\n\r\n**Î≥¥Í≥†ÏÑú ÏöîÍµ¨ÏÇ¨Ìï≠**:\r\n1. **Executive Summary**: ÌïµÏã¨ Ïù∏ÏÇ¨Ïù¥Ìä∏ 3-5Ï§Ñ ÏöîÏïΩ\r\n2. **ÌòÑÏû¨ Í∞ÄÏπò ÏßÑÎã®**: Phase 1 Îç∞Ïù¥ÌÑ∞ Ìï¥ÏÑù\r\n3. **ÏÑ±Ïû• Í∂§Ï†Å Î∂ÑÏÑù**: ${phase2 ? 'Phase 2 Í∏∞Î∞ò ÏãúÍ≥ÑÏó¥ Ìå®ÌÑ¥ Î∂ÑÏÑù' : 'ÏòàÏÉÅ ÏÑ±Ïû• Í≤ΩÎ°ú Ï†úÏãú'}\r\n4. **ÏãúÏû• Ìè¨ÏßÄÏÖîÎãù**: ${phase3 ? 'Phase 3 Í∏∞Î∞ò Í≤ΩÏüÅ Î∂ÑÏÑù' : 'Ï∂îÏ†ï ÏãúÏû• ÎÇ¥ ÏúÑÏπò'}\r\n5. **Ï†ÑÎûµÏ†Å Ï†úÏñ∏**: Îã®Í∏∞(1ÎÖÑ)/Ï§ëÍ∏∞(3ÎÖÑ) Î∞úÏ†Ñ Î°úÎìúÎßµ\r\n6. **Î¶¨Ïä§ÌÅ¨ ÏöîÏù∏**: Ï£ºÏöî ÏúÑÌóò ÏöîÏÜå Î∞è ÎåÄÏùë Ï†ÑÎûµ\r\n\r\n**ÌòïÏãù**: Íµ¨Ï°∞ÌôîÎêú ÎßàÌÅ¨Îã§Ïö¥, Ï¥ù 1500-2000Ïûê, Îç∞Ïù¥ÌÑ∞ Í∏∞Î∞ò Íµ¨Ï≤¥Ï†Å Í∑ºÍ±∞ ÌïÑÏàò\r\n\r\nÎ∂ÑÏÑù ÏãúÏûë:`;\r\n  }\r\n\r\n  /**\r\n   * Ï¢ÖÌï© Î∂ÑÏÑù Ìè¥Î∞± Î≥¥Í≥†ÏÑú\r\n   */\r\n  generateFallbackComprehensiveReport(phase1Data) {\r\n    const radar = phase1Data.radar5;\r\n    const avgScore = Object.values(radar).reduce((a, b) => a + b, 0) / 5;\r\n    \r\n    const report = `# üìã ${phase1Data.name} Ï¢ÖÌï© Î∂ÑÏÑù Î≥¥Í≥†ÏÑú (ÌÜµÍ≥Ñ Í∏∞Î∞ò)\r\n\r\n## Executive Summary\r\nÌòÑÏû¨ ÌèâÍ∑† Ï†êÏàò ${avgScore.toFixed(1)}Ï†êÏúºÎ°ú ${avgScore >= 85 ? 'Í∏ÄÎ°úÎ≤å ÌÜ±Ìã∞Ïñ¥' : avgScore >= 70 ? 'ÏïÑÏãúÏïÑ Ï£ºÏöî ÏûëÍ∞Ä' : 'Ïã†ÏßÑ Ïú†Îßù ÏûëÍ∞Ä'} ÏàòÏ§ÄÏûÖÎãàÎã§. ${Object.entries(radar).sort((a,b) => b[1]-a[1])[0][0] === 'I' ? 'Í∏∞Í¥ÄÏ†ÑÏãú' : 'ÌäπÏ†ï ÏòÅÏó≠'}ÏóêÏÑúÏùò Í∞ïÏ†êÏùÑ Î∞îÌÉïÏúºÎ°ú Í∑†ÌòïÏû°Ìûå ÏÑ±Ïû•Ïù¥ Í∏∞ÎåÄÎê©ÎãàÎã§.\r\n\r\n## ÌòÑÏû¨ Í∞ÄÏπò ÏßÑÎã®\r\n**Í∞ïÏ†ê ÏòÅÏó≠**: ${Object.entries(radar).filter(([_,v]) => v > avgScore + 10).map(([k,_]) => this.getAxisName(k)).join(', ')}\r\n**Í∞úÏÑ† ÏòÅÏó≠**: ${Object.entries(radar).filter(([_,v]) => v < avgScore - 10).map(([k,_]) => this.getAxisName(k)).join(', ')}\r\n\r\n5Ï∂ï Ï§ë ÏµúÍ≥† ${Math.max(...Object.values(radar))}Ï†êÍ≥º ÏµúÏ†Ä ${Math.min(...Object.values(radar))}Ï†êÏùò Í≤©Ï∞®Í∞Ä ${(Math.max(...Object.values(radar)) - Math.min(...Object.values(radar))).toFixed(1)}Ï†êÏúºÎ°ú ${Math.max(...Object.values(radar)) - Math.min(...Object.values(radar)) > 50 ? 'Ï†ÑÎ¨∏ÌôîÎêú' : 'Í∑†ÌòïÏû°Ìûå'} ÌîÑÎ°úÌïÑÏùÑ Î≥¥ÏûÖÎãàÎã§.\r\n\r\n## ÏÑ±Ïû• Í∂§Ï†Å Î∂ÑÏÑù\r\nÌòÑÏû¨ ÏàòÏ§ÄÏóêÏÑú ÏòàÏÉÅÎêòÎäî ÏÑ±Ïû• Í≤ΩÎ°úÎäî Ïó∞ÌèâÍ∑† 5-8% ÏÉÅÏäπÏúºÎ°ú, ÏïΩ 3-5ÎÖÑ ÎÇ¥ Ï†ÑÏ≤¥Ï†ÅÏù∏ Ï†êÏàò Ìñ•ÏÉÅÏù¥ Í∏∞ÎåÄÎê©ÎãàÎã§. ÌäπÌûà ÏïΩÏ†ê ÏòÅÏó≠Ïùò ÏßëÏ§ëÏ†Å Í∞úÎ∞ú Ïãú ÎçîÏö± Í∞ÄÌååÎ•∏ ÏÑ±Ïû• Í≥°ÏÑ†Ïù¥ Í∞ÄÎä•Ìï† Í≤ÉÏúºÎ°ú Î∂ÑÏÑùÎê©ÎãàÎã§.\r\n\r\n## ÏãúÏû• Ìè¨ÏßÄÏÖîÎãù\r\nÎèôÏùº ÏÑ∏ÎåÄ ÏûëÍ∞ÄÍµ∞ ÎåÄÎπÑ ${avgScore >= 80 ? 'ÏÉÅÏúÑ 20%' : avgScore >= 65 ? 'ÏÉÅÏúÑ 40%' : 'ÏÑ±Ïû• Ïû†Ïû¨Î†• Í∑∏Î£π'} ÏúÑÏπòÎ°ú Ï∂îÏ†ïÎê©ÎãàÎã§. ÌòÑÏû¨ Í∞ïÏ†ê ÏòÅÏó≠ÏùÑ Ï§ëÏã¨ÏúºÎ°ú Ìïú Ï∞®Î≥ÑÌôî Ï†ÑÎûµÏù¥ Ìö®Í≥ºÏ†ÅÏùº Í≤ÉÏúºÎ°ú ÌåêÎã®Îê©ÎãàÎã§.\r\n\r\n## Ï†ÑÎûµÏ†Å Ï†úÏñ∏\r\n**Îã®Í∏∞(1ÎÖÑ)**: ${Object.values(radar).some(v => v < 50) ? 'Ï∑®ÏïΩ ÏòÅÏó≠ Í∏∞Ï¥à Ï≤¥Î†• Í∞ïÌôî' : 'Í∞ïÏ†ê ÏòÅÏó≠ Ïã¨Ìôî Î∞úÏ†Ñ'}\r\n**Ï§ëÍ∏∞(3ÎÖÑ)**: Íµ≠Ï†úÏ†Å Ïù∏ÏßÄÎèÑ ÌôïÏÇ∞ Î∞è Îã§Í∞ÅÌôîÎêú Ìè¨Ìä∏Ìè¥Î¶¨Ïò§ Íµ¨Ï∂ï\r\n\r\n## Î¶¨Ïä§ÌÅ¨ ÏöîÏù∏\r\n- ÏãúÏû• Î≥ÄÎèôÏÑ±Ïóê Îî∞Î•∏ ÏòÅÌñ•ÎèÑ: ${avgScore > 80 ? 'LOW' : avgScore > 60 ? 'MEDIUM' : 'HIGH'}\r\n- Í≤ΩÏüÅ ÌôòÍ≤Ω Î≥ÄÌôî ÎåÄÏùëÎ†•: ÏßÄÏÜçÏ†Å Î™®ÎãàÌÑ∞ÎßÅ ÌïÑÏöî\r\n\r\n---\r\n*Î∂ÑÏÑù Í∏∞Ï§Ä: AHP v1.0 | ÏÉùÏÑ± ÏãúÍ∞Å: ${new Date().toLocaleString('ko-KR')}*`;\r\n\r\n    return {\r\n      success: true,\r\n      report,\r\n      model: 'statistical-comprehensive',\r\n      analysisType: 'comprehensive',\r\n      phases_analyzed: 'basic',\r\n      timestamp: new Date().toISOString(),\r\n      fallback_used: true\r\n    };\r\n  }\r\n\r\n  /**\r\n   * API Ïó∞Í≤∞ ÏÉÅÌÉú ÌôïÏù∏ (ÌôïÏû•)\r\n   */\r\n  async checkConnection() {\r\n    const results = {\r\n      openai: { connected: false, reason: '' },\r\n      vertex: { connected: false, reason: '' },\r\n      overall: { connected: false, primary: null }\r\n    };\r\n\r\n    // OpenAI Ïó∞Í≤∞ ÌôïÏù∏\r\n    try {\r\n      if (this.openai) {\r\n        await this.openai.chat.completions.create({\r\n          model: 'gpt-3.5-turbo',\r\n          messages: [{ role: 'user', content: 'ÌÖåÏä§Ìä∏' }],\r\n          max_tokens: 5\r\n        });\r\n        results.openai = { connected: true, model: 'gpt-4' };\r\n      } else {\r\n        results.openai = { connected: false, reason: 'API ÌÇ§ ÎØ∏ÏÑ§Ï†ï' };\r\n      }\r\n    } catch (error) {\r\n      results.openai = { connected: false, reason: error.message };\r\n    }\r\n\r\n    // Vertex AI Ïó∞Í≤∞ ÌôïÏù∏\r\n    try {\r\n      const testResponse = await fetch('/api/ai/vertex-health', {\r\n        method: 'GET',\r\n        headers: { 'Authorization': `Bearer ${process.env.REACT_APP_VERTEX_AI_TOKEN || ''}` }\r\n      });\r\n      \r\n      if (testResponse.ok) {\r\n        results.vertex = { connected: true, model: 'gemini-1.5-pro' };\r\n      } else {\r\n        results.vertex = { connected: false, reason: `Î∞±ÏóîÎìú Ïó∞Í≤∞ Ïã§Ìå®: ${testResponse.status}` };\r\n      }\r\n    } catch (error) {\r\n      results.vertex = { connected: false, reason: 'Î∞±ÏóîÎìú ÏÑúÎ≤Ñ ÎØ∏ÏùëÎãµ' };\r\n    }\r\n\r\n    // Ï†ÑÏ≤¥ ÏÉÅÌÉú Í≤∞Ï†ï\r\n    if (results.vertex.connected) {\r\n      results.overall = { connected: true, primary: 'vertex-ai' };\r\n    } else if (results.openai.connected) {\r\n      results.overall = { connected: true, primary: 'openai' };\r\n    } else {\r\n      results.overall = { connected: false, primary: 'fallback' };\r\n    }\r\n\r\n    return results;\r\n  }\r\n}\r\n\r\n// Ïã±Í∏ÄÌÜ§ Ìå®ÌÑ¥ÏúºÎ°ú ÎÇ¥Î≥¥ÎÇ¥Í∏∞\r\nconst aiService = new AIService();\r\nexport default aiService;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}