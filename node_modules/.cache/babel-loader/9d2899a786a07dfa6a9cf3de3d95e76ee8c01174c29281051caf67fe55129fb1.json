{"ast":null,"code":"// CuratorOdyssey AI Analysis Service\n// OpenAI GPT-4 + Anthropic Claude Î∞±ÏóÖ ÏãúÏä§ÌÖú\nimport OpenAI from'openai';class AIService{constructor(){// OpenAI Ï¥àÍ∏∞Ìôî (Î©îÏù∏ AI ÏóîÏßÑ)\nthis.openai=null;this.anthropicKey=process.env.REACT_APP_ANTHROPIC_API_KEY;this.vertexConfig={projectId:process.env.REACT_APP_VERTEX_AI_PROJECT_ID,location:process.env.REACT_APP_VERTEX_AI_LOCATION};// ÏÑ§Ï†ïÍ∞í\nthis.maxRetries=parseInt(process.env.REACT_APP_AI_MAX_RETRIES)||3;this.timeout=parseInt(process.env.REACT_APP_AI_TIMEOUT)||30000;this.initializeOpenAI();}initializeOpenAI(){const apiKey=process.env.REACT_APP_OPENAI_API_KEY;if(apiKey&&apiKey!=='your_openai_api_key_here'){this.openai=new OpenAI({apiKey:apiKey,dangerouslyAllowBrowser:true// ‚ö†Ô∏è ÌîÑÎ°úÎçïÏÖòÏóêÏÑúÎäî Î∞±ÏóîÎìúÎ°ú Ïù¥Ï†Ñ ÌïÑÏöî\n});}}/**\r\n   * Phase 1 ÏïÑÌã∞Ïä§Ìä∏ Îç∞Ïù¥ÌÑ∞ Î∂ÑÏÑù (ÌïµÏã¨ Î©îÏÑúÎìú)\r\n   * @param {Object} artistData - ÏïÑÌã∞Ïä§Ìä∏ Î†àÏù¥Îçî/ÏÑ†Î≤ÑÏä§Ìä∏ Îç∞Ïù¥ÌÑ∞\r\n   * @returns {Promise<Object>} AI Î∂ÑÏÑù Í≤∞Í≥º\r\n   */async generatePhase1Insights(artistData){try{console.log('ü§ñ AI Phase 1 Î∂ÑÏÑù ÏãúÏûë:',artistData.name);if(!this.openai){return this.generateFallbackInsights(artistData);}const prompt=this.buildPhase1Prompt(artistData);const completion=await this.callOpenAI(prompt);return{success:true,insights:completion,model:'gpt-4',timestamp:new Date().toISOString(),analysisType:'phase1',artist:artistData.name};}catch(error){console.error('AI Î∂ÑÏÑù Ïò§Î•ò:',error);// Anthropic Î∞±ÏóÖ ÏãúÎèÑ\ntry{if(this.anthropicKey){const claudeResult=await this.callAnthropic(this.buildPhase1Prompt(artistData));return{success:true,insights:claudeResult,model:'claude-3',timestamp:new Date().toISOString(),analysisType:'phase1',artist:artistData.name,fallbackUsed:true};}}catch(claudeError){console.error('Claude Î∞±ÏóÖÎèÑ Ïã§Ìå®:',claudeError);}// ÏµúÏ¢Ö Ìè¥Î∞±\nreturn this.generateFallbackInsights(artistData);}}/**\r\n   * OpenAI API Ìò∏Ï∂ú\r\n   */async callOpenAI(prompt){let retries=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;try{const response=await Promise.race([this.openai.chat.completions.create({model:process.env.REACT_APP_OPENAI_MODEL||'gpt-4',messages:[{role:'system',content:'CuratorOdysseyÏùò Ï†ÑÎ¨∏ ÏïÑÌä∏ÎßàÏºì Î∂ÑÏÑùÍ∞ÄÎ°úÏÑú, Îç∞Ïù¥ÌÑ∞ Í∏∞Î∞òÏùò Í∞ùÍ¥ÄÏ†ÅÏù¥Í≥† ÌÜµÏ∞∞Î†• ÏûàÎäî Î∂ÑÏÑùÏùÑ Ï†úÍ≥µÌï©ÎãàÎã§.'},{role:'user',content:prompt}],max_tokens:1000,temperature:0.7}),new Promise((_,reject)=>setTimeout(()=>reject(new Error('AI ÏùëÎãµ ÏãúÍ∞Ñ Ï¥àÍ≥º')),this.timeout))]);return response.choices[0].message.content;}catch(error){if(retries<this.maxRetries){console.log(\"AI \\uC7AC\\uC2DC\\uB3C4 \".concat(retries+1,\"/\").concat(this.maxRetries));await new Promise(resolve=>setTimeout(resolve,1000*(retries+1)));return this.callOpenAI(prompt,retries+1);}throw error;}}/**\r\n   * Anthropic Claude API Ìò∏Ï∂ú (Î∞±ÏóÖÏö©)\r\n   */async callAnthropic(prompt){// Ïã§Ï†ú Íµ¨ÌòÑÏùÄ Anthropic SDK ÏÇ¨Ïö©\n// ÌòÑÏû¨Îäî Íµ¨Ï°∞Îßå Ï†ïÏùò\nthrow new Error('Anthropic Ïó∞ÎèôÏùÄ Ìñ•ÌõÑ Íµ¨ÌòÑ ÏòàÏ†ï');}/**\r\n   * Vertex AI Ìò∏Ï∂ú (Î∞±ÏóîÎìú Cloud Function Ïó∞Îèô)\r\n   */async callVertexAI(prompt){let options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};try{var _result$usage;console.log('üîÆ Vertex AI Î∞±ÏóîÎìú Ìò∏Ï∂ú ÏãúÏûë');const response=await fetch('/api/ai/vertex-generate',{method:'POST',headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(process.env.REACT_APP_VERTEX_AI_TOKEN||'')},body:JSON.stringify({prompt,model:options.model||'gemini-1.5-pro',reportType:options.reportType||'comprehensive',temperature:options.temperature||0.7,maxTokens:options.maxTokens||2000})});if(!response.ok){throw new Error(\"Vertex API Error: \".concat(response.status));}const result=await response.json();return{success:true,content:result.content,model:'vertex-ai-gemini',tokens_used:((_result$usage=result.usage)===null||_result$usage===void 0?void 0:_result$usage.total_tokens)||0,timestamp:new Date().toISOString()};}catch(error){console.error('Vertex AI Ìò∏Ï∂ú Ïã§Ìå®:',error);// OpenAIÎ°ú Ìè¥Î∞±\nif(this.openai){console.log('üîÑ OpenAIÎ°ú Ìè¥Î∞± ÏãúÎèÑ');return await this.callOpenAI(prompt);}throw error;}}/**\r\n   * Phase 1 ÌîÑÎ°¨ÌîÑÌä∏ ÏÉùÏÑ±\r\n   */buildPhase1Prompt(artistData){return\"CuratorOdyssey Phase 1 \\uBD84\\uC11D\\uAC00\\uB85C\\uC11C, \\uB2E4\\uC74C \\uC791\\uAC00\\uC758 \\uB370\\uC774\\uD130\\uB97C \\uC885\\uD569 \\uBD84\\uC11D\\uD574\\uC8FC\\uC138\\uC694:\\n\\n**\\uC791\\uAC00**: \".concat(artistData.name,\"\\n\\n**5\\uCD95 \\uB808\\uC774\\uB354 \\uC810\\uC218** (0-100):\\n- \\uAE30\\uAD00\\uC804\\uC2DC(I): \").concat(artistData.radar5.I,\"\\uC810\\n- \\uD398\\uC5B4(F): \").concat(artistData.radar5.F,\"\\uC810  \\n- \\uC2DC\\uC0C1(A): \").concat(artistData.radar5.A,\"\\uC810\\n- \\uBBF8\\uB514\\uC5B4(M): \").concat(artistData.radar5.M,\"\\uC810\\n- \\uAD50\\uC721(Sedu): \").concat(artistData.radar5.Sedu,\"\\uC810\\n\\n**4\\uCD95 \\uC120\\uBC84\\uC2A4\\uD2B8 \\uADFC\\uAC70 \\uB370\\uC774\\uD130**:\\n- \\uC81C\\uB3C4: \").concat(artistData.sunburst_l1.Ï†úÎèÑ,\"\\uC810\\n- \\uD559\\uC220: \").concat(artistData.sunburst_l1.ÌïôÏà†,\"\\uC810\\n- \\uB2F4\\uB860: \").concat(artistData.sunburst_l1.Îã¥Î°†,\"\\uC810\\n- \\uB124\\uD2B8\\uC6CC\\uD06C: \").concat(artistData.sunburst_l1.ÎÑ§Ìä∏ÏõåÌÅ¨,\"\\uC810\\n\\n**\\uBD84\\uC11D \\uC694\\uCCAD**:\\n1. **\\uAC00\\uCE58 \\uAD6C\\uC131\\uC758 \\uD2B9\\uC9D5**: 5\\uCD95 \\uC810\\uC218 \\uD328\\uD134\\uC5D0\\uC11C \\uB098\\uD0C0\\uB098\\uB294 \\uC791\\uAC00\\uC758 \\uAC15\\uC810\\uACFC \\uD2B9\\uC131\\n2. **\\uADE0\\uD615\\uB3C4 \\uBD84\\uC11D**: \\uCD95\\uAC04 \\uD3B8\\uCC28\\uC640 \\uD3EC\\uD2B8\\uD3F4\\uB9AC\\uC624 \\uB2E4\\uAC01\\uD654 \\uC218\\uC900\\n3. **\\uC2DC\\uC7A5 \\uD3EC\\uC9C0\\uC154\\uB2DD**: \\uD604\\uC7AC \\uC810\\uC218 \\uAE30\\uBC18 \\uC791\\uAC00\\uC758 \\uC2DC\\uC7A5 \\uB0B4 \\uC704\\uCE58\\n4. **\\uBC1C\\uC804 \\uC81C\\uC5B8**: \\uC57D\\uC810 \\uBCF4\\uC644 \\uBC0F \\uAC15\\uC810 \\uADF9\\uB300\\uD654 \\uC804\\uB7B5\\n\\n**\\uC751\\uB2F5 \\uD615\\uC2DD**: \\n- \\uD55C\\uAD6D\\uC5B4\\uB85C \\uC791\\uC131\\n- 4\\uAC1C \\uC139\\uC158 \\uAD6C\\uC870\\uD654 \\n- \\uAC01 \\uC139\\uC158 2-3\\uBB38\\uC7A5\\uC73C\\uB85C \\uAC04\\uACB0\\uD558\\uAC8C\\n- \\uCD1D 800\\uC790 \\uC774\\uB0B4\\n- \\uB370\\uC774\\uD130 \\uC218\\uCE58 \\uD65C\\uC6A9\\uD55C \\uAD6C\\uCCB4\\uC801 \\uADFC\\uAC70 \\uC81C\\uC2DC\\n\\n\\uBD84\\uC11D \\uC2DC\\uC791:\");}/**\r\n   * AI Ïã§Ìå® Ïãú Ìè¥Î∞± Ïù∏ÏÇ¨Ïù¥Ìä∏ ÏÉùÏÑ±\r\n   */generateFallbackInsights(artistData){console.log('üîÑ Ìè¥Î∞± Ïù∏ÏÇ¨Ïù¥Ìä∏ ÏÉùÏÑ±:',artistData.name);const radar=artistData.radar5;const sunburst=artistData.sunburst_l1;// ÌÜµÍ≥ÑÏ†Å Î∂ÑÏÑù\nconst radarValues=Object.values(radar);const maxScore=Math.max(...radarValues);const minScore=Math.min(...radarValues);const avgScore=radarValues.reduce((a,b)=>a+b,0)/radarValues.length;const variance=radarValues.reduce((acc,val)=>acc+Math.pow(val-avgScore,2),0)/radarValues.length;// Í∞ïÏ†ê Ï∂ï ÏãùÎ≥Ñ\nconst strengths=Object.entries(radar).filter(_ref=>{let[_,score]=_ref;return score>avgScore+10;}).map(_ref2=>{let[axis,_]=_ref2;return this.getAxisName(axis);});// ÏïΩÏ†ê Ï∂ï ÏãùÎ≥Ñ  \nconst weaknesses=Object.entries(radar).filter(_ref3=>{let[_,score]=_ref3;return score<avgScore-10;}).map(_ref4=>{let[axis,_]=_ref4;return this.getAxisName(axis);});const insights=\"## \\uD83D\\uDCCA \".concat(artistData.name,\" Phase 1 \\uBD84\\uC11D (\\uB370\\uC774\\uD130 \\uAE30\\uBC18)\\n\\n### \\uD83C\\uDFAF \\uAC00\\uCE58 \\uAD6C\\uC131\\uC758 \\uD2B9\\uC9D5\\n\\uD604\\uC7AC \\uD3C9\\uADE0 \\uC810\\uC218 \").concat(avgScore.toFixed(1),\"\\uC810\\uC73C\\uB85C \").concat(maxScore>=90?'ÏµúÏÉÅÏúÑÍ∂å':maxScore>=80?'ÏÉÅÏúÑÍ∂å':'Ï§ëÏúÑÍ∂å',\" \\uC704\\uCE58\\uC785\\uB2C8\\uB2E4. \").concat(strengths.length>0?\"\\uD2B9\\uD788 \".concat(strengths.join(', '),\" \\uC601\\uC5ED\\uC5D0\\uC11C \\uAC15\\uC138\\uB97C \\uBCF4\\uC774\\uBA70\"):'Í∑†Îì±Ìïú Î∞úÏ†Ñ ÏñëÏÉÅÏùÑ Î≥¥Ïù¥Î©∞',\", \\uC774\\uB294 \").concat(variance>500?'Ï†ÑÎ¨∏ÌôîÎêú':'Í∑†ÌòïÏû°Ìûå',\" \\uC131\\uC7A5 \\uD328\\uD134\\uC744 \\uB098\\uD0C0\\uB0C5\\uB2C8\\uB2E4.\\n\\n### \\u2696\\uFE0F \\uADE0\\uD615\\uB3C4 \\uBD84\\uC11D  \\n\\uCD5C\\uACE0\\uC810 \").concat(maxScore,\"\\uC810\\uACFC \\uCD5C\\uC800\\uC810 \").concat(minScore,\"\\uC810\\uC758 \\uACA9\\uCC28\\uAC00 \").concat((maxScore-minScore).toFixed(1),\"\\uC810\\uC73C\\uB85C, \").concat(maxScore-minScore>50?'Î∂àÍ∑†ÌòïÏù¥ Îã§ÏÜå Ï°¥Ïû¨':'ÎπÑÍµêÏ†Å ÏïàÏ†ïÏ†ÅÏù∏ Í∑†Ìòï',\"\\uC744 \\uBCF4\\uC785\\uB2C8\\uB2E4. 4\\uCD95 \\uC120\\uBC84\\uC2A4\\uD2B8 \\uB370\\uC774\\uD130\\uC5D0\\uC11C\\uB294 \").concat(Object.entries(sunburst).sort((a,b)=>b[1]-a[1])[0][0],\"(\").concat(Object.entries(sunburst).sort((a,b)=>b[1]-a[1])[0][1],\"\\uC810)\\uC774 \\uAC00\\uC7A5 \\uACAC\\uACE0\\uD55C \\uAE30\\uBC18\\uC744 \\uD615\\uC131\\uD558\\uACE0 \\uC788\\uC2B5\\uB2C8\\uB2E4.\\n\\n### \\uD83C\\uDFAA \\uC2DC\\uC7A5 \\uD3EC\\uC9C0\\uC154\\uB2DD\\n\\uC804\\uCCB4\\uC801\\uC73C\\uB85C \").concat(avgScore>=85?'Í∏ÄÎ°úÎ≤å ÌÜ±Ìã∞Ïñ¥':avgScore>=70?'ÏïÑÏãúÏïÑ Ï£ºÏöî ÏûëÍ∞Ä':'Ïã†ÏßÑ Ïú†Îßù ÏûëÍ∞Ä',\" \\uC218\\uC900\\uC758 \\uC131\\uACFC\\uB97C \\uB2EC\\uC131\\uD588\\uC2B5\\uB2C8\\uB2E4. \").concat(radar.I>=90?'Í∏∞Í¥Ä Ï†ÑÏãú':radar.M>=85?'ÎØ∏ÎîîÏñ¥ ÎÖ∏Ï∂ú':radar.F>=85?'ÌéòÏñ¥ Ï∞∏Ïó¨':'ÎÑ§Ìä∏ÏõåÌÅ¨ Íµ¨Ï∂ï',\" \\uCE21\\uBA74\\uC5D0\\uC11C\\uC758 \\uB6F0\\uC5B4\\uB09C \\uC131\\uACFC\\uAC00 \\uC8FC\\uC694 \\uACBD\\uC7C1\\uB825\\uC73C\\uB85C \\uC791\\uC6A9\\uD558\\uACE0 \\uC788\\uC2B5\\uB2C8\\uB2E4.\\n\\n### \\uD83D\\uDCA1 \\uBC1C\\uC804 \\uC81C\\uC5B8\\n\").concat(weaknesses.length>0?\"\".concat(weaknesses.join(', '),\" \\uC601\\uC5ED \\uC9D1\\uC911 \\uAC1C\\uBC1C\\uC744 \\uD1B5\\uD574\"):'ÌòÑÏû¨ Í∞ïÏ†ê ÏòÅÏó≠ Ïã¨ÌôîÎ•º ÌÜµÌï¥',\" \\uCD94\\uAC00\\uC801\\uC778 \\uB3C4\\uC57D\\uC774 \\uAC00\\uB2A5\\uD569\\uB2C8\\uB2E4. \\uD2B9\\uD788 \").concat(minScore<50?'Ï∑®ÏïΩ ÏòÅÏó≠Ïùò Îã®Í≥ÑÏ†Å Î≥¥ÏôÑ':'Í∞ïÏ†ê ÏòÅÏó≠Ïùò Í∏ÄÎ°úÎ≤å ÌôïÏû•',\"\\uC5D0 \\uC9D1\\uC911\\uD558\\uBA74 \\uB354\\uC6B1 \\uADE0\\uD615\\uC7A1\\uD78C \\uD3EC\\uD2B8\\uD3F4\\uB9AC\\uC624 \\uAD6C\\uCD95\\uC774 \\uAE30\\uB300\\uB429\\uB2C8\\uB2E4.\");return{success:true,insights,model:'fallback',timestamp:new Date().toISOString(),analysisType:'phase1',artist:artistData.name,fallbackUsed:true,statistics:{average:avgScore.toFixed(1),max:maxScore,min:minScore,variance:variance.toFixed(1),strengths,weaknesses}};}/**\r\n   * Ï∂ï Ïù¥Î¶Ñ ÌïúÍµ≠Ïñ¥ Î≥ÄÌôò\r\n   */getAxisName(axisCode){const names={'I':'Í∏∞Í¥ÄÏ†ÑÏãú','F':'ÌéòÏñ¥','A':'ÏãúÏÉÅ','M':'ÎØ∏ÎîîÏñ¥','Sedu':'ÍµêÏú°'};return names[axisCode]||axisCode;}/**\r\n   * Phase 2/3 ÌÜµÌï© Î∂ÑÏÑù (Ïã†Í∑ú - Ï¢ÖÌï© Î≥¥Í≥†ÏÑú)\r\n   */async generateComprehensiveReport(phase1Data){let phase2Data=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;let phase3Data=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;try{console.log('üìã Ï¢ÖÌï© Î≥¥Í≥†ÏÑú ÏÉùÏÑ± ÏãúÏûë:',phase1Data.name);const reportData={phase1:phase1Data,phase2:phase2Data,phase3:phase3Data,analysisDepth:phase2Data&&phase3Data?'comprehensive':phase2Data?'intermediate':'basic'};const prompt=this.buildComprehensivePrompt(reportData);// Vertex AI Ïö∞ÏÑ† ÏãúÎèÑ\ntry{const vertexResult=await this.callVertexAI(prompt,{model:'gemini-1.5-pro',reportType:'comprehensive',maxTokens:3000});return{success:true,report:vertexResult.content,model:'vertex-ai-gemini',analysisType:'comprehensive',phases_analyzed:reportData.analysisDepth,timestamp:new Date().toISOString()};}catch(vertexError){console.log('Vertex AI Ïã§Ìå®, OpenAIÎ°ú Ìè¥Î∞±');const openaiResult=await this.callOpenAI(prompt);return{success:true,report:openaiResult,model:'gpt-4-comprehensive',analysisType:'comprehensive',phases_analyzed:reportData.analysisDepth,timestamp:new Date().toISOString(),fallback_used:true};}}catch(error){console.error('Ï¢ÖÌï© Î≥¥Í≥†ÏÑú ÏÉùÏÑ± Ïã§Ìå®:',error);return this.generateFallbackComprehensiveReport(phase1Data);}}/**\r\n   * Ï¢ÖÌï© Î∂ÑÏÑù ÌîÑÎ°¨ÌîÑÌä∏ ÏÉùÏÑ±\r\n   */buildComprehensivePrompt(reportData){const{phase1,phase2,phase3,analysisDepth}=reportData;return\"CuratorOdyssey \\uC885\\uD569 \\uBCF4\\uACE0\\uC11C \\uC0DD\\uC131 \\uC694\\uCCAD:\\n\\n**\\uC791\\uAC00**: \".concat(phase1.name,\"\\n**\\uBD84\\uC11D \\uBC94\\uC704**: \").concat(analysisDepth.toUpperCase(),\" (Phase 1\").concat(phase2?' + 2':'').concat(phase3?' + 3':'',\")\\n\\n**Phase 1 \\uB370\\uC774\\uD130** (\\uD604\\uC7AC \\uAC00\\uCE58):\\n- 5\\uCD95 \\uC810\\uC218: I\").concat(phase1.radar5.I,\" F\").concat(phase1.radar5.F,\" A\").concat(phase1.radar5.A,\" M\").concat(phase1.radar5.M,\" S\").concat(phase1.radar5.Sedu,\"\\n- 4\\uCD95 \\uAE30\\uBC18: \\uC81C\\uB3C4\").concat(phase1.sunburst_l1.Ï†úÎèÑ,\" \\uD559\\uC220\").concat(phase1.sunburst_l1.ÌïôÏà†,\" \\uB2F4\\uB860\").concat(phase1.sunburst_l1.Îã¥Î°†,\" \\uB124\\uD2B8\\uC6CC\\uD06C\").concat(phase1.sunburst_l1.ÎÑ§Ìä∏ÏõåÌÅ¨,\"\\n\\n\").concat(phase2?\"**Phase 2 \\uB370\\uC774\\uD130** (\\uC2DC\\uAC04\\uCD95 \\uADA4\\uC801):\\n- 20\\uB144\\uAC04 \\uC131\\uC7A5 \\uD328\\uD134 \\uB370\\uC774\\uD130\\n- \\uC8FC\\uC694 \\uBCC0\\uACE1\\uC810 \\uBC0F \\uC774\\uBCA4\\uD2B8 \\uD0C0\\uC784\\uB77C\\uC778\\n- \\uCD95\\uBCC4 \\uC131\\uC7A5 \\uC18D\\uB3C4 \\uBC0F \\uAC00\\uC18D\\uB3C4 \\uBD84\\uC11D\\n\\n\":'',\"\\n\\n\").concat(phase3?\"**Phase 3 \\uB370\\uC774\\uD130** (\\uBE44\\uAD50 \\uBD84\\uC11D):\\n- \\uB3D9\\uC2DC\\uB300 \\uC791\\uAC00\\uAD70 \\uB300\\uBE44 \\uD3EC\\uC9C0\\uC154\\uB2DD\\n- \\uAC00\\uACA9 \\uB300\\uBE44 \\uC131\\uACFC \\uADA4\\uC801 \\uC0C1\\uAD00\\uAD00\\uACC4\\n- \\uC2DC\\uC7A5 \\uB0B4 \\uACBD\\uC7C1\\uB825 \\uBC0F \\uCC28\\uBCC4\\uD654 \\uC694\\uC18C\\n\\n\":'',\"\\n\\n**\\uBCF4\\uACE0\\uC11C \\uC694\\uAD6C\\uC0AC\\uD56D**:\\n1. **Executive Summary**: \\uD575\\uC2EC \\uC778\\uC0AC\\uC774\\uD2B8 3-5\\uC904 \\uC694\\uC57D\\n2. **\\uD604\\uC7AC \\uAC00\\uCE58 \\uC9C4\\uB2E8**: Phase 1 \\uB370\\uC774\\uD130 \\uD574\\uC11D\\n3. **\\uC131\\uC7A5 \\uADA4\\uC801 \\uBD84\\uC11D**: \").concat(phase2?'Phase 2 Í∏∞Î∞ò ÏãúÍ≥ÑÏó¥ Ìå®ÌÑ¥ Î∂ÑÏÑù':'ÏòàÏÉÅ ÏÑ±Ïû• Í≤ΩÎ°ú Ï†úÏãú',\"\\n4. **\\uC2DC\\uC7A5 \\uD3EC\\uC9C0\\uC154\\uB2DD**: \").concat(phase3?'Phase 3 Í∏∞Î∞ò Í≤ΩÏüÅ Î∂ÑÏÑù':'Ï∂îÏ†ï ÏãúÏû• ÎÇ¥ ÏúÑÏπò',\"\\n5. **\\uC804\\uB7B5\\uC801 \\uC81C\\uC5B8**: \\uB2E8\\uAE30(1\\uB144)/\\uC911\\uAE30(3\\uB144) \\uBC1C\\uC804 \\uB85C\\uB4DC\\uB9F5\\n6. **\\uB9AC\\uC2A4\\uD06C \\uC694\\uC778**: \\uC8FC\\uC694 \\uC704\\uD5D8 \\uC694\\uC18C \\uBC0F \\uB300\\uC751 \\uC804\\uB7B5\\n\\n**\\uD615\\uC2DD**: \\uAD6C\\uC870\\uD654\\uB41C \\uB9C8\\uD06C\\uB2E4\\uC6B4, \\uCD1D 1500-2000\\uC790, \\uB370\\uC774\\uD130 \\uAE30\\uBC18 \\uAD6C\\uCCB4\\uC801 \\uADFC\\uAC70 \\uD544\\uC218\\n\\n\\uBD84\\uC11D \\uC2DC\\uC791:\");}/**\r\n   * Ï¢ÖÌï© Î∂ÑÏÑù Ìè¥Î∞± Î≥¥Í≥†ÏÑú\r\n   */generateFallbackComprehensiveReport(phase1Data){const radar=phase1Data.radar5;const avgScore=Object.values(radar).reduce((a,b)=>a+b,0)/5;const report=\"# \\uD83D\\uDCCB \".concat(phase1Data.name,\" \\uC885\\uD569 \\uBD84\\uC11D \\uBCF4\\uACE0\\uC11C (\\uD1B5\\uACC4 \\uAE30\\uBC18)\\n\\n## Executive Summary\\n\\uD604\\uC7AC \\uD3C9\\uADE0 \\uC810\\uC218 \").concat(avgScore.toFixed(1),\"\\uC810\\uC73C\\uB85C \").concat(avgScore>=85?'Í∏ÄÎ°úÎ≤å ÌÜ±Ìã∞Ïñ¥':avgScore>=70?'ÏïÑÏãúÏïÑ Ï£ºÏöî ÏûëÍ∞Ä':'Ïã†ÏßÑ Ïú†Îßù ÏûëÍ∞Ä',\" \\uC218\\uC900\\uC785\\uB2C8\\uB2E4. \").concat(Object.entries(radar).sort((a,b)=>b[1]-a[1])[0][0]==='I'?'Í∏∞Í¥ÄÏ†ÑÏãú':'ÌäπÏ†ï ÏòÅÏó≠',\"\\uC5D0\\uC11C\\uC758 \\uAC15\\uC810\\uC744 \\uBC14\\uD0D5\\uC73C\\uB85C \\uADE0\\uD615\\uC7A1\\uD78C \\uC131\\uC7A5\\uC774 \\uAE30\\uB300\\uB429\\uB2C8\\uB2E4.\\n\\n## \\uD604\\uC7AC \\uAC00\\uCE58 \\uC9C4\\uB2E8\\n**\\uAC15\\uC810 \\uC601\\uC5ED**: \").concat(Object.entries(radar).filter(_ref5=>{let[_,v]=_ref5;return v>avgScore+10;}).map(_ref6=>{let[k,_]=_ref6;return this.getAxisName(k);}).join(', '),\"\\n**\\uAC1C\\uC120 \\uC601\\uC5ED**: \").concat(Object.entries(radar).filter(_ref7=>{let[_,v]=_ref7;return v<avgScore-10;}).map(_ref8=>{let[k,_]=_ref8;return this.getAxisName(k);}).join(', '),\"\\n\\n5\\uCD95 \\uC911 \\uCD5C\\uACE0 \").concat(Math.max(...Object.values(radar)),\"\\uC810\\uACFC \\uCD5C\\uC800 \").concat(Math.min(...Object.values(radar)),\"\\uC810\\uC758 \\uACA9\\uCC28\\uAC00 \").concat((Math.max(...Object.values(radar))-Math.min(...Object.values(radar))).toFixed(1),\"\\uC810\\uC73C\\uB85C \").concat(Math.max(...Object.values(radar))-Math.min(...Object.values(radar))>50?'Ï†ÑÎ¨∏ÌôîÎêú':'Í∑†ÌòïÏû°Ìûå',\" \\uD504\\uB85C\\uD544\\uC744 \\uBCF4\\uC785\\uB2C8\\uB2E4.\\n\\n## \\uC131\\uC7A5 \\uADA4\\uC801 \\uBD84\\uC11D\\n\\uD604\\uC7AC \\uC218\\uC900\\uC5D0\\uC11C \\uC608\\uC0C1\\uB418\\uB294 \\uC131\\uC7A5 \\uACBD\\uB85C\\uB294 \\uC5F0\\uD3C9\\uADE0 5-8% \\uC0C1\\uC2B9\\uC73C\\uB85C, \\uC57D 3-5\\uB144 \\uB0B4 \\uC804\\uCCB4\\uC801\\uC778 \\uC810\\uC218 \\uD5A5\\uC0C1\\uC774 \\uAE30\\uB300\\uB429\\uB2C8\\uB2E4. \\uD2B9\\uD788 \\uC57D\\uC810 \\uC601\\uC5ED\\uC758 \\uC9D1\\uC911\\uC801 \\uAC1C\\uBC1C \\uC2DC \\uB354\\uC6B1 \\uAC00\\uD30C\\uB978 \\uC131\\uC7A5 \\uACE1\\uC120\\uC774 \\uAC00\\uB2A5\\uD560 \\uAC83\\uC73C\\uB85C \\uBD84\\uC11D\\uB429\\uB2C8\\uB2E4.\\n\\n## \\uC2DC\\uC7A5 \\uD3EC\\uC9C0\\uC154\\uB2DD\\n\\uB3D9\\uC77C \\uC138\\uB300 \\uC791\\uAC00\\uAD70 \\uB300\\uBE44 \").concat(avgScore>=80?'ÏÉÅÏúÑ 20%':avgScore>=65?'ÏÉÅÏúÑ 40%':'ÏÑ±Ïû• Ïû†Ïû¨Î†• Í∑∏Î£π',\" \\uC704\\uCE58\\uB85C \\uCD94\\uC815\\uB429\\uB2C8\\uB2E4. \\uD604\\uC7AC \\uAC15\\uC810 \\uC601\\uC5ED\\uC744 \\uC911\\uC2EC\\uC73C\\uB85C \\uD55C \\uCC28\\uBCC4\\uD654 \\uC804\\uB7B5\\uC774 \\uD6A8\\uACFC\\uC801\\uC77C \\uAC83\\uC73C\\uB85C \\uD310\\uB2E8\\uB429\\uB2C8\\uB2E4.\\n\\n## \\uC804\\uB7B5\\uC801 \\uC81C\\uC5B8\\n**\\uB2E8\\uAE30(1\\uB144)**: \").concat(Object.values(radar).some(v=>v<50)?'Ï∑®ÏïΩ ÏòÅÏó≠ Í∏∞Ï¥à Ï≤¥Î†• Í∞ïÌôî':'Í∞ïÏ†ê ÏòÅÏó≠ Ïã¨Ìôî Î∞úÏ†Ñ',\"\\n**\\uC911\\uAE30(3\\uB144)**: \\uAD6D\\uC81C\\uC801 \\uC778\\uC9C0\\uB3C4 \\uD655\\uC0B0 \\uBC0F \\uB2E4\\uAC01\\uD654\\uB41C \\uD3EC\\uD2B8\\uD3F4\\uB9AC\\uC624 \\uAD6C\\uCD95\\n\\n## \\uB9AC\\uC2A4\\uD06C \\uC694\\uC778\\n- \\uC2DC\\uC7A5 \\uBCC0\\uB3D9\\uC131\\uC5D0 \\uB530\\uB978 \\uC601\\uD5A5\\uB3C4: \").concat(avgScore>80?'LOW':avgScore>60?'MEDIUM':'HIGH',\"\\n- \\uACBD\\uC7C1 \\uD658\\uACBD \\uBCC0\\uD654 \\uB300\\uC751\\uB825: \\uC9C0\\uC18D\\uC801 \\uBAA8\\uB2C8\\uD130\\uB9C1 \\uD544\\uC694\\n\\n---\\n*\\uBD84\\uC11D \\uAE30\\uC900: AHP v1.0 | \\uC0DD\\uC131 \\uC2DC\\uAC01: \").concat(new Date().toLocaleString('ko-KR'),\"*\");return{success:true,report,model:'statistical-comprehensive',analysisType:'comprehensive',phases_analyzed:'basic',timestamp:new Date().toISOString(),fallback_used:true};}/**\r\n   * API Ïó∞Í≤∞ ÏÉÅÌÉú ÌôïÏù∏ (ÌôïÏû•)\r\n   */async checkConnection(){const results={openai:{connected:false,reason:''},vertex:{connected:false,reason:''},overall:{connected:false,primary:null}};// OpenAI Ïó∞Í≤∞ ÌôïÏù∏\ntry{if(this.openai){await this.openai.chat.completions.create({model:'gpt-3.5-turbo',messages:[{role:'user',content:'ÌÖåÏä§Ìä∏'}],max_tokens:5});results.openai={connected:true,model:'gpt-4'};}else{results.openai={connected:false,reason:'API ÌÇ§ ÎØ∏ÏÑ§Ï†ï'};}}catch(error){results.openai={connected:false,reason:error.message};}// Vertex AI Ïó∞Í≤∞ ÌôïÏù∏\ntry{const testResponse=await fetch('/api/ai/vertex-health',{method:'GET',headers:{'Authorization':\"Bearer \".concat(process.env.REACT_APP_VERTEX_AI_TOKEN||'')}});if(testResponse.ok){results.vertex={connected:true,model:'gemini-1.5-pro'};}else{results.vertex={connected:false,reason:\"\\uBC31\\uC5D4\\uB4DC \\uC5F0\\uACB0 \\uC2E4\\uD328: \".concat(testResponse.status)};}}catch(error){results.vertex={connected:false,reason:'Î∞±ÏóîÎìú ÏÑúÎ≤Ñ ÎØ∏ÏùëÎãµ'};}// Ï†ÑÏ≤¥ ÏÉÅÌÉú Í≤∞Ï†ï\nif(results.vertex.connected){results.overall={connected:true,primary:'vertex-ai'};}else if(results.openai.connected){results.overall={connected:true,primary:'openai'};}else{results.overall={connected:false,primary:'fallback'};}return results;}}// Ïã±Í∏ÄÌÜ§ Ìå®ÌÑ¥ÏúºÎ°ú ÎÇ¥Î≥¥ÎÇ¥Í∏∞\nconst aiService=new AIService();export default aiService;","map":{"version":3,"names":["OpenAI","AIService","constructor","openai","anthropicKey","process","env","REACT_APP_ANTHROPIC_API_KEY","vertexConfig","projectId","REACT_APP_VERTEX_AI_PROJECT_ID","location","REACT_APP_VERTEX_AI_LOCATION","maxRetries","parseInt","REACT_APP_AI_MAX_RETRIES","timeout","REACT_APP_AI_TIMEOUT","initializeOpenAI","apiKey","REACT_APP_OPENAI_API_KEY","dangerouslyAllowBrowser","generatePhase1Insights","artistData","console","log","name","generateFallbackInsights","prompt","buildPhase1Prompt","completion","callOpenAI","success","insights","model","timestamp","Date","toISOString","analysisType","artist","error","claudeResult","callAnthropic","fallbackUsed","claudeError","retries","arguments","length","undefined","response","Promise","race","chat","completions","create","REACT_APP_OPENAI_MODEL","messages","role","content","max_tokens","temperature","_","reject","setTimeout","Error","choices","message","concat","resolve","callVertexAI","options","_result$usage","fetch","method","headers","REACT_APP_VERTEX_AI_TOKEN","body","JSON","stringify","reportType","maxTokens","ok","status","result","json","tokens_used","usage","total_tokens","radar5","I","F","A","M","Sedu","sunburst_l1","Ï†úÎèÑ","ÌïôÏà†","Îã¥Î°†","ÎÑ§Ìä∏ÏõåÌÅ¨","radar","sunburst","radarValues","Object","values","maxScore","Math","max","minScore","min","avgScore","reduce","a","b","variance","acc","val","pow","strengths","entries","filter","_ref","score","map","_ref2","axis","getAxisName","weaknesses","_ref3","_ref4","toFixed","join","sort","statistics","average","axisCode","names","generateComprehensiveReport","phase1Data","phase2Data","phase3Data","reportData","phase1","phase2","phase3","analysisDepth","buildComprehensivePrompt","vertexResult","report","phases_analyzed","vertexError","openaiResult","fallback_used","generateFallbackComprehensiveReport","toUpperCase","_ref5","v","_ref6","k","_ref7","_ref8","some","toLocaleString","checkConnection","results","connected","reason","vertex","overall","primary","testResponse","aiService"],"sources":["C:/co-1016/src/services/aiService.js"],"sourcesContent":["// CuratorOdyssey AI Analysis Service\r\n// OpenAI GPT-4 + Anthropic Claude Î∞±ÏóÖ ÏãúÏä§ÌÖú\r\n\r\nimport OpenAI from 'openai';\r\n\r\nclass AIService {\r\n  constructor() {\r\n    // OpenAI Ï¥àÍ∏∞Ìôî (Î©îÏù∏ AI ÏóîÏßÑ)\r\n    this.openai = null;\r\n    this.anthropicKey = process.env.REACT_APP_ANTHROPIC_API_KEY;\r\n    this.vertexConfig = {\r\n      projectId: process.env.REACT_APP_VERTEX_AI_PROJECT_ID,\r\n      location: process.env.REACT_APP_VERTEX_AI_LOCATION\r\n    };\r\n    \r\n    // ÏÑ§Ï†ïÍ∞í\r\n    this.maxRetries = parseInt(process.env.REACT_APP_AI_MAX_RETRIES) || 3;\r\n    this.timeout = parseInt(process.env.REACT_APP_AI_TIMEOUT) || 30000;\r\n    \r\n    this.initializeOpenAI();\r\n  }\r\n\r\n  initializeOpenAI() {\r\n    const apiKey = process.env.REACT_APP_OPENAI_API_KEY;\r\n    if (apiKey && apiKey !== 'your_openai_api_key_here') {\r\n      this.openai = new OpenAI({\r\n        apiKey: apiKey,\r\n        dangerouslyAllowBrowser: true // ‚ö†Ô∏è ÌîÑÎ°úÎçïÏÖòÏóêÏÑúÎäî Î∞±ÏóîÎìúÎ°ú Ïù¥Ï†Ñ ÌïÑÏöî\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Phase 1 ÏïÑÌã∞Ïä§Ìä∏ Îç∞Ïù¥ÌÑ∞ Î∂ÑÏÑù (ÌïµÏã¨ Î©îÏÑúÎìú)\r\n   * @param {Object} artistData - ÏïÑÌã∞Ïä§Ìä∏ Î†àÏù¥Îçî/ÏÑ†Î≤ÑÏä§Ìä∏ Îç∞Ïù¥ÌÑ∞\r\n   * @returns {Promise<Object>} AI Î∂ÑÏÑù Í≤∞Í≥º\r\n   */\r\n  async generatePhase1Insights(artistData) {\r\n    try {\r\n      console.log('ü§ñ AI Phase 1 Î∂ÑÏÑù ÏãúÏûë:', artistData.name);\r\n      \r\n      if (!this.openai) {\r\n        return this.generateFallbackInsights(artistData);\r\n      }\r\n\r\n      const prompt = this.buildPhase1Prompt(artistData);\r\n      \r\n      const completion = await this.callOpenAI(prompt);\r\n      \r\n      return {\r\n        success: true,\r\n        insights: completion,\r\n        model: 'gpt-4',\r\n        timestamp: new Date().toISOString(),\r\n        analysisType: 'phase1',\r\n        artist: artistData.name\r\n      };\r\n\r\n    } catch (error) {\r\n      console.error('AI Î∂ÑÏÑù Ïò§Î•ò:', error);\r\n      \r\n      // Anthropic Î∞±ÏóÖ ÏãúÎèÑ\r\n      try {\r\n        if (this.anthropicKey) {\r\n          const claudeResult = await this.callAnthropic(\r\n            this.buildPhase1Prompt(artistData)\r\n          );\r\n          return {\r\n            success: true,\r\n            insights: claudeResult,\r\n            model: 'claude-3',\r\n            timestamp: new Date().toISOString(),\r\n            analysisType: 'phase1',\r\n            artist: artistData.name,\r\n            fallbackUsed: true\r\n          };\r\n        }\r\n      } catch (claudeError) {\r\n        console.error('Claude Î∞±ÏóÖÎèÑ Ïã§Ìå®:', claudeError);\r\n      }\r\n      \r\n      // ÏµúÏ¢Ö Ìè¥Î∞±\r\n      return this.generateFallbackInsights(artistData);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * OpenAI API Ìò∏Ï∂ú\r\n   */\r\n  async callOpenAI(prompt, retries = 0) {\r\n    try {\r\n      const response = await Promise.race([\r\n        this.openai.chat.completions.create({\r\n          model: process.env.REACT_APP_OPENAI_MODEL || 'gpt-4',\r\n          messages: [\r\n            {\r\n              role: 'system',\r\n              content: 'CuratorOdysseyÏùò Ï†ÑÎ¨∏ ÏïÑÌä∏ÎßàÏºì Î∂ÑÏÑùÍ∞ÄÎ°úÏÑú, Îç∞Ïù¥ÌÑ∞ Í∏∞Î∞òÏùò Í∞ùÍ¥ÄÏ†ÅÏù¥Í≥† ÌÜµÏ∞∞Î†• ÏûàÎäî Î∂ÑÏÑùÏùÑ Ï†úÍ≥µÌï©ÎãàÎã§.'\r\n            },\r\n            {\r\n              role: 'user', \r\n              content: prompt\r\n            }\r\n          ],\r\n          max_tokens: 1000,\r\n          temperature: 0.7\r\n        }),\r\n        new Promise((_, reject) => \r\n          setTimeout(() => reject(new Error('AI ÏùëÎãµ ÏãúÍ∞Ñ Ï¥àÍ≥º')), this.timeout)\r\n        )\r\n      ]);\r\n\r\n      return response.choices[0].message.content;\r\n\r\n    } catch (error) {\r\n      if (retries < this.maxRetries) {\r\n        console.log(`AI Ïû¨ÏãúÎèÑ ${retries + 1}/${this.maxRetries}`);\r\n        await new Promise(resolve => setTimeout(resolve, 1000 * (retries + 1)));\r\n        return this.callOpenAI(prompt, retries + 1);\r\n      }\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Anthropic Claude API Ìò∏Ï∂ú (Î∞±ÏóÖÏö©)\r\n   */\r\n  async callAnthropic(prompt) {\r\n    // Ïã§Ï†ú Íµ¨ÌòÑÏùÄ Anthropic SDK ÏÇ¨Ïö©\r\n    // ÌòÑÏû¨Îäî Íµ¨Ï°∞Îßå Ï†ïÏùò\r\n    throw new Error('Anthropic Ïó∞ÎèôÏùÄ Ìñ•ÌõÑ Íµ¨ÌòÑ ÏòàÏ†ï');\r\n  }\r\n\r\n  /**\r\n   * Vertex AI Ìò∏Ï∂ú (Î∞±ÏóîÎìú Cloud Function Ïó∞Îèô)\r\n   */\r\n  async callVertexAI(prompt, options = {}) {\r\n    try {\r\n      console.log('üîÆ Vertex AI Î∞±ÏóîÎìú Ìò∏Ï∂ú ÏãúÏûë');\r\n      \r\n      const response = await fetch('/api/ai/vertex-generate', {\r\n        method: 'POST',\r\n        headers: { \r\n          'Content-Type': 'application/json',\r\n          'Authorization': `Bearer ${process.env.REACT_APP_VERTEX_AI_TOKEN || ''}`\r\n        },\r\n        body: JSON.stringify({ \r\n          prompt, \r\n          model: options.model || 'gemini-1.5-pro',\r\n          reportType: options.reportType || 'comprehensive',\r\n          temperature: options.temperature || 0.7,\r\n          maxTokens: options.maxTokens || 2000\r\n        })\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error(`Vertex API Error: ${response.status}`);\r\n      }\r\n\r\n      const result = await response.json();\r\n      \r\n      return {\r\n        success: true,\r\n        content: result.content,\r\n        model: 'vertex-ai-gemini',\r\n        tokens_used: result.usage?.total_tokens || 0,\r\n        timestamp: new Date().toISOString()\r\n      };\r\n\r\n    } catch (error) {\r\n      console.error('Vertex AI Ìò∏Ï∂ú Ïã§Ìå®:', error);\r\n      \r\n      // OpenAIÎ°ú Ìè¥Î∞±\r\n      if (this.openai) {\r\n        console.log('üîÑ OpenAIÎ°ú Ìè¥Î∞± ÏãúÎèÑ');\r\n        return await this.callOpenAI(prompt);\r\n      }\r\n      \r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Phase 1 ÌîÑÎ°¨ÌîÑÌä∏ ÏÉùÏÑ±\r\n   */\r\n  buildPhase1Prompt(artistData) {\r\n    return `CuratorOdyssey Phase 1 Î∂ÑÏÑùÍ∞ÄÎ°úÏÑú, Îã§Ïùå ÏûëÍ∞ÄÏùò Îç∞Ïù¥ÌÑ∞Î•º Ï¢ÖÌï© Î∂ÑÏÑùÌï¥Ï£ºÏÑ∏Ïöî:\r\n\r\n**ÏûëÍ∞Ä**: ${artistData.name}\r\n\r\n**5Ï∂ï Î†àÏù¥Îçî Ï†êÏàò** (0-100):\r\n- Í∏∞Í¥ÄÏ†ÑÏãú(I): ${artistData.radar5.I}Ï†ê\r\n- ÌéòÏñ¥(F): ${artistData.radar5.F}Ï†ê  \r\n- ÏãúÏÉÅ(A): ${artistData.radar5.A}Ï†ê\r\n- ÎØ∏ÎîîÏñ¥(M): ${artistData.radar5.M}Ï†ê\r\n- ÍµêÏú°(Sedu): ${artistData.radar5.Sedu}Ï†ê\r\n\r\n**4Ï∂ï ÏÑ†Î≤ÑÏä§Ìä∏ Í∑ºÍ±∞ Îç∞Ïù¥ÌÑ∞**:\r\n- Ï†úÎèÑ: ${artistData.sunburst_l1.Ï†úÎèÑ}Ï†ê\r\n- ÌïôÏà†: ${artistData.sunburst_l1.ÌïôÏà†}Ï†ê\r\n- Îã¥Î°†: ${artistData.sunburst_l1.Îã¥Î°†}Ï†ê\r\n- ÎÑ§Ìä∏ÏõåÌÅ¨: ${artistData.sunburst_l1.ÎÑ§Ìä∏ÏõåÌÅ¨}Ï†ê\r\n\r\n**Î∂ÑÏÑù ÏöîÏ≤≠**:\r\n1. **Í∞ÄÏπò Íµ¨ÏÑ±Ïùò ÌäπÏßï**: 5Ï∂ï Ï†êÏàò Ìå®ÌÑ¥ÏóêÏÑú ÎÇòÌÉÄÎÇòÎäî ÏûëÍ∞ÄÏùò Í∞ïÏ†êÍ≥º ÌäπÏÑ±\r\n2. **Í∑†ÌòïÎèÑ Î∂ÑÏÑù**: Ï∂ïÍ∞Ñ Ìé∏Ï∞®ÏôÄ Ìè¨Ìä∏Ìè¥Î¶¨Ïò§ Îã§Í∞ÅÌôî ÏàòÏ§Ä\r\n3. **ÏãúÏû• Ìè¨ÏßÄÏÖîÎãù**: ÌòÑÏû¨ Ï†êÏàò Í∏∞Î∞ò ÏûëÍ∞ÄÏùò ÏãúÏû• ÎÇ¥ ÏúÑÏπò\r\n4. **Î∞úÏ†Ñ Ï†úÏñ∏**: ÏïΩÏ†ê Î≥¥ÏôÑ Î∞è Í∞ïÏ†ê Í∑πÎåÄÌôî Ï†ÑÎûµ\r\n\r\n**ÏùëÎãµ ÌòïÏãù**: \r\n- ÌïúÍµ≠Ïñ¥Î°ú ÏûëÏÑ±\r\n- 4Í∞ú ÏÑπÏÖò Íµ¨Ï°∞Ìôî \r\n- Í∞Å ÏÑπÏÖò 2-3Î¨∏Ïû•ÏúºÎ°ú Í∞ÑÍ≤∞ÌïòÍ≤å\r\n- Ï¥ù 800Ïûê Ïù¥ÎÇ¥\r\n- Îç∞Ïù¥ÌÑ∞ ÏàòÏπò ÌôúÏö©Ìïú Íµ¨Ï≤¥Ï†Å Í∑ºÍ±∞ Ï†úÏãú\r\n\r\nÎ∂ÑÏÑù ÏãúÏûë:`;\r\n  }\r\n\r\n  /**\r\n   * AI Ïã§Ìå® Ïãú Ìè¥Î∞± Ïù∏ÏÇ¨Ïù¥Ìä∏ ÏÉùÏÑ±\r\n   */\r\n  generateFallbackInsights(artistData) {\r\n    console.log('üîÑ Ìè¥Î∞± Ïù∏ÏÇ¨Ïù¥Ìä∏ ÏÉùÏÑ±:', artistData.name);\r\n    \r\n    const radar = artistData.radar5;\r\n    const sunburst = artistData.sunburst_l1;\r\n    \r\n    // ÌÜµÍ≥ÑÏ†Å Î∂ÑÏÑù\r\n    const radarValues = Object.values(radar);\r\n    const maxScore = Math.max(...radarValues);\r\n    const minScore = Math.min(...radarValues);\r\n    const avgScore = radarValues.reduce((a, b) => a + b, 0) / radarValues.length;\r\n    const variance = radarValues.reduce((acc, val) => acc + Math.pow(val - avgScore, 2), 0) / radarValues.length;\r\n    \r\n    // Í∞ïÏ†ê Ï∂ï ÏãùÎ≥Ñ\r\n    const strengths = Object.entries(radar)\r\n      .filter(([_, score]) => score > avgScore + 10)\r\n      .map(([axis, _]) => this.getAxisName(axis));\r\n    \r\n    // ÏïΩÏ†ê Ï∂ï ÏãùÎ≥Ñ  \r\n    const weaknesses = Object.entries(radar)\r\n      .filter(([_, score]) => score < avgScore - 10)\r\n      .map(([axis, _]) => this.getAxisName(axis));\r\n\r\n    const insights = `## üìä ${artistData.name} Phase 1 Î∂ÑÏÑù (Îç∞Ïù¥ÌÑ∞ Í∏∞Î∞ò)\r\n\r\n### üéØ Í∞ÄÏπò Íµ¨ÏÑ±Ïùò ÌäπÏßï\r\nÌòÑÏû¨ ÌèâÍ∑† Ï†êÏàò ${avgScore.toFixed(1)}Ï†êÏúºÎ°ú ${maxScore >= 90 ? 'ÏµúÏÉÅÏúÑÍ∂å' : maxScore >= 80 ? 'ÏÉÅÏúÑÍ∂å' : 'Ï§ëÏúÑÍ∂å'} ÏúÑÏπòÏûÖÎãàÎã§. ${strengths.length > 0 ? `ÌäπÌûà ${strengths.join(', ')} ÏòÅÏó≠ÏóêÏÑú Í∞ïÏÑ∏Î•º Î≥¥Ïù¥Î©∞` : 'Í∑†Îì±Ìïú Î∞úÏ†Ñ ÏñëÏÉÅÏùÑ Î≥¥Ïù¥Î©∞'}, Ïù¥Îäî ${variance > 500 ? 'Ï†ÑÎ¨∏ÌôîÎêú' : 'Í∑†ÌòïÏû°Ìûå'} ÏÑ±Ïû• Ìå®ÌÑ¥ÏùÑ ÎÇòÌÉÄÎÉÖÎãàÎã§.\r\n\r\n### ‚öñÔ∏è Í∑†ÌòïÎèÑ Î∂ÑÏÑù  \r\nÏµúÍ≥†Ï†ê ${maxScore}Ï†êÍ≥º ÏµúÏ†ÄÏ†ê ${minScore}Ï†êÏùò Í≤©Ï∞®Í∞Ä ${(maxScore - minScore).toFixed(1)}Ï†êÏúºÎ°ú, ${maxScore - minScore > 50 ? 'Î∂àÍ∑†ÌòïÏù¥ Îã§ÏÜå Ï°¥Ïû¨' : 'ÎπÑÍµêÏ†Å ÏïàÏ†ïÏ†ÅÏù∏ Í∑†Ìòï'}ÏùÑ Î≥¥ÏûÖÎãàÎã§. 4Ï∂ï ÏÑ†Î≤ÑÏä§Ìä∏ Îç∞Ïù¥ÌÑ∞ÏóêÏÑúÎäî ${Object.entries(sunburst).sort((a, b) => b[1] - a[1])[0][0]}(${Object.entries(sunburst).sort((a, b) => b[1] - a[1])[0][1]}Ï†ê)Ïù¥ Í∞ÄÏû• Í≤¨Í≥†Ìïú Í∏∞Î∞òÏùÑ ÌòïÏÑ±ÌïòÍ≥† ÏûàÏäµÎãàÎã§.\r\n\r\n### üé™ ÏãúÏû• Ìè¨ÏßÄÏÖîÎãù\r\nÏ†ÑÏ≤¥Ï†ÅÏúºÎ°ú ${avgScore >= 85 ? 'Í∏ÄÎ°úÎ≤å ÌÜ±Ìã∞Ïñ¥' : avgScore >= 70 ? 'ÏïÑÏãúÏïÑ Ï£ºÏöî ÏûëÍ∞Ä' : 'Ïã†ÏßÑ Ïú†Îßù ÏûëÍ∞Ä'} ÏàòÏ§ÄÏùò ÏÑ±Í≥ºÎ•º Îã¨ÏÑ±ÌñàÏäµÎãàÎã§. ${radar.I >= 90 ? 'Í∏∞Í¥Ä Ï†ÑÏãú' : radar.M >= 85 ? 'ÎØ∏ÎîîÏñ¥ ÎÖ∏Ï∂ú' : radar.F >= 85 ? 'ÌéòÏñ¥ Ï∞∏Ïó¨' : 'ÎÑ§Ìä∏ÏõåÌÅ¨ Íµ¨Ï∂ï'} Ï∏°Î©¥ÏóêÏÑúÏùò Îõ∞Ïñ¥ÎÇú ÏÑ±Í≥ºÍ∞Ä Ï£ºÏöî Í≤ΩÏüÅÎ†•ÏúºÎ°ú ÏûëÏö©ÌïòÍ≥† ÏûàÏäµÎãàÎã§.\r\n\r\n### üí° Î∞úÏ†Ñ Ï†úÏñ∏\r\n${weaknesses.length > 0 ? `${weaknesses.join(', ')} ÏòÅÏó≠ ÏßëÏ§ë Í∞úÎ∞úÏùÑ ÌÜµÌï¥` : 'ÌòÑÏû¨ Í∞ïÏ†ê ÏòÅÏó≠ Ïã¨ÌôîÎ•º ÌÜµÌï¥'} Ï∂îÍ∞ÄÏ†ÅÏù∏ ÎèÑÏïΩÏù¥ Í∞ÄÎä•Ìï©ÎãàÎã§. ÌäπÌûà ${minScore < 50 ? 'Ï∑®ÏïΩ ÏòÅÏó≠Ïùò Îã®Í≥ÑÏ†Å Î≥¥ÏôÑ' : 'Í∞ïÏ†ê ÏòÅÏó≠Ïùò Í∏ÄÎ°úÎ≤å ÌôïÏû•'}Ïóê ÏßëÏ§ëÌïòÎ©¥ ÎçîÏö± Í∑†ÌòïÏû°Ìûå Ìè¨Ìä∏Ìè¥Î¶¨Ïò§ Íµ¨Ï∂ïÏù¥ Í∏∞ÎåÄÎê©ÎãàÎã§.`;\r\n\r\n    return {\r\n      success: true,\r\n      insights,\r\n      model: 'fallback',\r\n      timestamp: new Date().toISOString(),\r\n      analysisType: 'phase1',\r\n      artist: artistData.name,\r\n      fallbackUsed: true,\r\n      statistics: {\r\n        average: avgScore.toFixed(1),\r\n        max: maxScore,\r\n        min: minScore,\r\n        variance: variance.toFixed(1),\r\n        strengths,\r\n        weaknesses\r\n      }\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Ï∂ï Ïù¥Î¶Ñ ÌïúÍµ≠Ïñ¥ Î≥ÄÌôò\r\n   */\r\n  getAxisName(axisCode) {\r\n    const names = {\r\n      'I': 'Í∏∞Í¥ÄÏ†ÑÏãú',\r\n      'F': 'ÌéòÏñ¥',\r\n      'A': 'ÏãúÏÉÅ', \r\n      'M': 'ÎØ∏ÎîîÏñ¥',\r\n      'Sedu': 'ÍµêÏú°'\r\n    };\r\n    return names[axisCode] || axisCode;\r\n  }\r\n\r\n  /**\r\n   * Phase 2/3 ÌÜµÌï© Î∂ÑÏÑù (Ïã†Í∑ú - Ï¢ÖÌï© Î≥¥Í≥†ÏÑú)\r\n   */\r\n  async generateComprehensiveReport(phase1Data, phase2Data = null, phase3Data = null) {\r\n    try {\r\n      console.log('üìã Ï¢ÖÌï© Î≥¥Í≥†ÏÑú ÏÉùÏÑ± ÏãúÏûë:', phase1Data.name);\r\n      \r\n      const reportData = {\r\n        phase1: phase1Data,\r\n        phase2: phase2Data,\r\n        phase3: phase3Data,\r\n        analysisDepth: phase2Data && phase3Data ? 'comprehensive' : \r\n                       phase2Data ? 'intermediate' : 'basic'\r\n      };\r\n\r\n      const prompt = this.buildComprehensivePrompt(reportData);\r\n      \r\n      // Vertex AI Ïö∞ÏÑ† ÏãúÎèÑ\r\n      try {\r\n        const vertexResult = await this.callVertexAI(prompt, {\r\n          model: 'gemini-1.5-pro',\r\n          reportType: 'comprehensive',\r\n          maxTokens: 3000\r\n        });\r\n        \r\n        return {\r\n          success: true,\r\n          report: vertexResult.content,\r\n          model: 'vertex-ai-gemini',\r\n          analysisType: 'comprehensive',\r\n          phases_analyzed: reportData.analysisDepth,\r\n          timestamp: new Date().toISOString()\r\n        };\r\n      } catch (vertexError) {\r\n        console.log('Vertex AI Ïã§Ìå®, OpenAIÎ°ú Ìè¥Î∞±');\r\n        \r\n        const openaiResult = await this.callOpenAI(prompt);\r\n        \r\n        return {\r\n          success: true,\r\n          report: openaiResult,\r\n          model: 'gpt-4-comprehensive',\r\n          analysisType: 'comprehensive', \r\n          phases_analyzed: reportData.analysisDepth,\r\n          timestamp: new Date().toISOString(),\r\n          fallback_used: true\r\n        };\r\n      }\r\n\r\n    } catch (error) {\r\n      console.error('Ï¢ÖÌï© Î≥¥Í≥†ÏÑú ÏÉùÏÑ± Ïã§Ìå®:', error);\r\n      return this.generateFallbackComprehensiveReport(phase1Data);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Ï¢ÖÌï© Î∂ÑÏÑù ÌîÑÎ°¨ÌîÑÌä∏ ÏÉùÏÑ±\r\n   */\r\n  buildComprehensivePrompt(reportData) {\r\n    const { phase1, phase2, phase3, analysisDepth } = reportData;\r\n    \r\n    return `CuratorOdyssey Ï¢ÖÌï© Î≥¥Í≥†ÏÑú ÏÉùÏÑ± ÏöîÏ≤≠:\r\n\r\n**ÏûëÍ∞Ä**: ${phase1.name}\r\n**Î∂ÑÏÑù Î≤îÏúÑ**: ${analysisDepth.toUpperCase()} (Phase 1${phase2 ? ' + 2' : ''}${phase3 ? ' + 3' : ''})\r\n\r\n**Phase 1 Îç∞Ïù¥ÌÑ∞** (ÌòÑÏû¨ Í∞ÄÏπò):\r\n- 5Ï∂ï Ï†êÏàò: I${phase1.radar5.I} F${phase1.radar5.F} A${phase1.radar5.A} M${phase1.radar5.M} S${phase1.radar5.Sedu}\r\n- 4Ï∂ï Í∏∞Î∞ò: Ï†úÎèÑ${phase1.sunburst_l1.Ï†úÎèÑ} ÌïôÏà†${phase1.sunburst_l1.ÌïôÏà†} Îã¥Î°†${phase1.sunburst_l1.Îã¥Î°†} ÎÑ§Ìä∏ÏõåÌÅ¨${phase1.sunburst_l1.ÎÑ§Ìä∏ÏõåÌÅ¨}\r\n\r\n${phase2 ? `**Phase 2 Îç∞Ïù¥ÌÑ∞** (ÏãúÍ∞ÑÏ∂ï Í∂§Ï†Å):\r\n- 20ÎÖÑÍ∞Ñ ÏÑ±Ïû• Ìå®ÌÑ¥ Îç∞Ïù¥ÌÑ∞\r\n- Ï£ºÏöî Î≥ÄÍ≥°Ï†ê Î∞è Ïù¥Î≤§Ìä∏ ÌÉÄÏûÑÎùºÏù∏\r\n- Ï∂ïÎ≥Ñ ÏÑ±Ïû• ÏÜçÎèÑ Î∞è Í∞ÄÏÜçÎèÑ Î∂ÑÏÑù\r\n\r\n` : ''}\r\n\r\n${phase3 ? `**Phase 3 Îç∞Ïù¥ÌÑ∞** (ÎπÑÍµê Î∂ÑÏÑù):\r\n- ÎèôÏãúÎåÄ ÏûëÍ∞ÄÍµ∞ ÎåÄÎπÑ Ìè¨ÏßÄÏÖîÎãù\r\n- Í∞ÄÍ≤© ÎåÄÎπÑ ÏÑ±Í≥º Í∂§Ï†Å ÏÉÅÍ¥ÄÍ¥ÄÍ≥Ñ\r\n- ÏãúÏû• ÎÇ¥ Í≤ΩÏüÅÎ†• Î∞è Ï∞®Î≥ÑÌôî ÏöîÏÜå\r\n\r\n` : ''}\r\n\r\n**Î≥¥Í≥†ÏÑú ÏöîÍµ¨ÏÇ¨Ìï≠**:\r\n1. **Executive Summary**: ÌïµÏã¨ Ïù∏ÏÇ¨Ïù¥Ìä∏ 3-5Ï§Ñ ÏöîÏïΩ\r\n2. **ÌòÑÏû¨ Í∞ÄÏπò ÏßÑÎã®**: Phase 1 Îç∞Ïù¥ÌÑ∞ Ìï¥ÏÑù\r\n3. **ÏÑ±Ïû• Í∂§Ï†Å Î∂ÑÏÑù**: ${phase2 ? 'Phase 2 Í∏∞Î∞ò ÏãúÍ≥ÑÏó¥ Ìå®ÌÑ¥ Î∂ÑÏÑù' : 'ÏòàÏÉÅ ÏÑ±Ïû• Í≤ΩÎ°ú Ï†úÏãú'}\r\n4. **ÏãúÏû• Ìè¨ÏßÄÏÖîÎãù**: ${phase3 ? 'Phase 3 Í∏∞Î∞ò Í≤ΩÏüÅ Î∂ÑÏÑù' : 'Ï∂îÏ†ï ÏãúÏû• ÎÇ¥ ÏúÑÏπò'}\r\n5. **Ï†ÑÎûµÏ†Å Ï†úÏñ∏**: Îã®Í∏∞(1ÎÖÑ)/Ï§ëÍ∏∞(3ÎÖÑ) Î∞úÏ†Ñ Î°úÎìúÎßµ\r\n6. **Î¶¨Ïä§ÌÅ¨ ÏöîÏù∏**: Ï£ºÏöî ÏúÑÌóò ÏöîÏÜå Î∞è ÎåÄÏùë Ï†ÑÎûµ\r\n\r\n**ÌòïÏãù**: Íµ¨Ï°∞ÌôîÎêú ÎßàÌÅ¨Îã§Ïö¥, Ï¥ù 1500-2000Ïûê, Îç∞Ïù¥ÌÑ∞ Í∏∞Î∞ò Íµ¨Ï≤¥Ï†Å Í∑ºÍ±∞ ÌïÑÏàò\r\n\r\nÎ∂ÑÏÑù ÏãúÏûë:`;\r\n  }\r\n\r\n  /**\r\n   * Ï¢ÖÌï© Î∂ÑÏÑù Ìè¥Î∞± Î≥¥Í≥†ÏÑú\r\n   */\r\n  generateFallbackComprehensiveReport(phase1Data) {\r\n    const radar = phase1Data.radar5;\r\n    const avgScore = Object.values(radar).reduce((a, b) => a + b, 0) / 5;\r\n    \r\n    const report = `# üìã ${phase1Data.name} Ï¢ÖÌï© Î∂ÑÏÑù Î≥¥Í≥†ÏÑú (ÌÜµÍ≥Ñ Í∏∞Î∞ò)\r\n\r\n## Executive Summary\r\nÌòÑÏû¨ ÌèâÍ∑† Ï†êÏàò ${avgScore.toFixed(1)}Ï†êÏúºÎ°ú ${avgScore >= 85 ? 'Í∏ÄÎ°úÎ≤å ÌÜ±Ìã∞Ïñ¥' : avgScore >= 70 ? 'ÏïÑÏãúÏïÑ Ï£ºÏöî ÏûëÍ∞Ä' : 'Ïã†ÏßÑ Ïú†Îßù ÏûëÍ∞Ä'} ÏàòÏ§ÄÏûÖÎãàÎã§. ${Object.entries(radar).sort((a,b) => b[1]-a[1])[0][0] === 'I' ? 'Í∏∞Í¥ÄÏ†ÑÏãú' : 'ÌäπÏ†ï ÏòÅÏó≠'}ÏóêÏÑúÏùò Í∞ïÏ†êÏùÑ Î∞îÌÉïÏúºÎ°ú Í∑†ÌòïÏû°Ìûå ÏÑ±Ïû•Ïù¥ Í∏∞ÎåÄÎê©ÎãàÎã§.\r\n\r\n## ÌòÑÏû¨ Í∞ÄÏπò ÏßÑÎã®\r\n**Í∞ïÏ†ê ÏòÅÏó≠**: ${Object.entries(radar).filter(([_,v]) => v > avgScore + 10).map(([k,_]) => this.getAxisName(k)).join(', ')}\r\n**Í∞úÏÑ† ÏòÅÏó≠**: ${Object.entries(radar).filter(([_,v]) => v < avgScore - 10).map(([k,_]) => this.getAxisName(k)).join(', ')}\r\n\r\n5Ï∂ï Ï§ë ÏµúÍ≥† ${Math.max(...Object.values(radar))}Ï†êÍ≥º ÏµúÏ†Ä ${Math.min(...Object.values(radar))}Ï†êÏùò Í≤©Ï∞®Í∞Ä ${(Math.max(...Object.values(radar)) - Math.min(...Object.values(radar))).toFixed(1)}Ï†êÏúºÎ°ú ${Math.max(...Object.values(radar)) - Math.min(...Object.values(radar)) > 50 ? 'Ï†ÑÎ¨∏ÌôîÎêú' : 'Í∑†ÌòïÏû°Ìûå'} ÌîÑÎ°úÌïÑÏùÑ Î≥¥ÏûÖÎãàÎã§.\r\n\r\n## ÏÑ±Ïû• Í∂§Ï†Å Î∂ÑÏÑù\r\nÌòÑÏû¨ ÏàòÏ§ÄÏóêÏÑú ÏòàÏÉÅÎêòÎäî ÏÑ±Ïû• Í≤ΩÎ°úÎäî Ïó∞ÌèâÍ∑† 5-8% ÏÉÅÏäπÏúºÎ°ú, ÏïΩ 3-5ÎÖÑ ÎÇ¥ Ï†ÑÏ≤¥Ï†ÅÏù∏ Ï†êÏàò Ìñ•ÏÉÅÏù¥ Í∏∞ÎåÄÎê©ÎãàÎã§. ÌäπÌûà ÏïΩÏ†ê ÏòÅÏó≠Ïùò ÏßëÏ§ëÏ†Å Í∞úÎ∞ú Ïãú ÎçîÏö± Í∞ÄÌååÎ•∏ ÏÑ±Ïû• Í≥°ÏÑ†Ïù¥ Í∞ÄÎä•Ìï† Í≤ÉÏúºÎ°ú Î∂ÑÏÑùÎê©ÎãàÎã§.\r\n\r\n## ÏãúÏû• Ìè¨ÏßÄÏÖîÎãù\r\nÎèôÏùº ÏÑ∏ÎåÄ ÏûëÍ∞ÄÍµ∞ ÎåÄÎπÑ ${avgScore >= 80 ? 'ÏÉÅÏúÑ 20%' : avgScore >= 65 ? 'ÏÉÅÏúÑ 40%' : 'ÏÑ±Ïû• Ïû†Ïû¨Î†• Í∑∏Î£π'} ÏúÑÏπòÎ°ú Ï∂îÏ†ïÎê©ÎãàÎã§. ÌòÑÏû¨ Í∞ïÏ†ê ÏòÅÏó≠ÏùÑ Ï§ëÏã¨ÏúºÎ°ú Ìïú Ï∞®Î≥ÑÌôî Ï†ÑÎûµÏù¥ Ìö®Í≥ºÏ†ÅÏùº Í≤ÉÏúºÎ°ú ÌåêÎã®Îê©ÎãàÎã§.\r\n\r\n## Ï†ÑÎûµÏ†Å Ï†úÏñ∏\r\n**Îã®Í∏∞(1ÎÖÑ)**: ${Object.values(radar).some(v => v < 50) ? 'Ï∑®ÏïΩ ÏòÅÏó≠ Í∏∞Ï¥à Ï≤¥Î†• Í∞ïÌôî' : 'Í∞ïÏ†ê ÏòÅÏó≠ Ïã¨Ìôî Î∞úÏ†Ñ'}\r\n**Ï§ëÍ∏∞(3ÎÖÑ)**: Íµ≠Ï†úÏ†Å Ïù∏ÏßÄÎèÑ ÌôïÏÇ∞ Î∞è Îã§Í∞ÅÌôîÎêú Ìè¨Ìä∏Ìè¥Î¶¨Ïò§ Íµ¨Ï∂ï\r\n\r\n## Î¶¨Ïä§ÌÅ¨ ÏöîÏù∏\r\n- ÏãúÏû• Î≥ÄÎèôÏÑ±Ïóê Îî∞Î•∏ ÏòÅÌñ•ÎèÑ: ${avgScore > 80 ? 'LOW' : avgScore > 60 ? 'MEDIUM' : 'HIGH'}\r\n- Í≤ΩÏüÅ ÌôòÍ≤Ω Î≥ÄÌôî ÎåÄÏùëÎ†•: ÏßÄÏÜçÏ†Å Î™®ÎãàÌÑ∞ÎßÅ ÌïÑÏöî\r\n\r\n---\r\n*Î∂ÑÏÑù Í∏∞Ï§Ä: AHP v1.0 | ÏÉùÏÑ± ÏãúÍ∞Å: ${new Date().toLocaleString('ko-KR')}*`;\r\n\r\n    return {\r\n      success: true,\r\n      report,\r\n      model: 'statistical-comprehensive',\r\n      analysisType: 'comprehensive',\r\n      phases_analyzed: 'basic',\r\n      timestamp: new Date().toISOString(),\r\n      fallback_used: true\r\n    };\r\n  }\r\n\r\n  /**\r\n   * API Ïó∞Í≤∞ ÏÉÅÌÉú ÌôïÏù∏ (ÌôïÏû•)\r\n   */\r\n  async checkConnection() {\r\n    const results = {\r\n      openai: { connected: false, reason: '' },\r\n      vertex: { connected: false, reason: '' },\r\n      overall: { connected: false, primary: null }\r\n    };\r\n\r\n    // OpenAI Ïó∞Í≤∞ ÌôïÏù∏\r\n    try {\r\n      if (this.openai) {\r\n        await this.openai.chat.completions.create({\r\n          model: 'gpt-3.5-turbo',\r\n          messages: [{ role: 'user', content: 'ÌÖåÏä§Ìä∏' }],\r\n          max_tokens: 5\r\n        });\r\n        results.openai = { connected: true, model: 'gpt-4' };\r\n      } else {\r\n        results.openai = { connected: false, reason: 'API ÌÇ§ ÎØ∏ÏÑ§Ï†ï' };\r\n      }\r\n    } catch (error) {\r\n      results.openai = { connected: false, reason: error.message };\r\n    }\r\n\r\n    // Vertex AI Ïó∞Í≤∞ ÌôïÏù∏\r\n    try {\r\n      const testResponse = await fetch('/api/ai/vertex-health', {\r\n        method: 'GET',\r\n        headers: { 'Authorization': `Bearer ${process.env.REACT_APP_VERTEX_AI_TOKEN || ''}` }\r\n      });\r\n      \r\n      if (testResponse.ok) {\r\n        results.vertex = { connected: true, model: 'gemini-1.5-pro' };\r\n      } else {\r\n        results.vertex = { connected: false, reason: `Î∞±ÏóîÎìú Ïó∞Í≤∞ Ïã§Ìå®: ${testResponse.status}` };\r\n      }\r\n    } catch (error) {\r\n      results.vertex = { connected: false, reason: 'Î∞±ÏóîÎìú ÏÑúÎ≤Ñ ÎØ∏ÏùëÎãµ' };\r\n    }\r\n\r\n    // Ï†ÑÏ≤¥ ÏÉÅÌÉú Í≤∞Ï†ï\r\n    if (results.vertex.connected) {\r\n      results.overall = { connected: true, primary: 'vertex-ai' };\r\n    } else if (results.openai.connected) {\r\n      results.overall = { connected: true, primary: 'openai' };\r\n    } else {\r\n      results.overall = { connected: false, primary: 'fallback' };\r\n    }\r\n\r\n    return results;\r\n  }\r\n}\r\n\r\n// Ïã±Í∏ÄÌÜ§ Ìå®ÌÑ¥ÏúºÎ°ú ÎÇ¥Î≥¥ÎÇ¥Í∏∞\r\nconst aiService = new AIService();\r\nexport default aiService;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}